

(function(){"use strict";var matched,browser;var uaMatch=function(ua){ua=ua.toLowerCase();var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"};};matched=uaMatch(navigator.userAgent);browser={};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version;}
if(browser.chrome){browser.webkit=true;}else if(browser.webkit){browser.safari=true;}
Cog.registerStatic({name:"utils.browser",sharedApi:browser,api:{}});})();Cog.utils=Cog.utils||{};(function(){"use strict";function namespace(namespaceString){var parts=namespaceString.split("."),parent=window,currentPart="";for(var i=0,length=parts.length;i<length;i++){currentPart=parts[i];parent[currentPart]=parent[currentPart]||{};parent=parent[currentPart];}
return parent;}
Cog.registerStatic({name:"utils.namespace",sharedApi:namespace,api:{}});})();(function($){'use strict';var api={},overlayContainer,overlayContent,overlayContentInner,overlayBackground,overlayLoading,overlayClose,mobileChecked=false,mobile=false,scrollPosition,startingPositionTop=100;function Overlay(elem,url){this.obj=elem;this.url=url;this.properties={'href':$(elem).attr('href'),'width':$(elem).data('overlaywidth')};}
Overlay.prototype.attachEvents=function(){var self=this,url=self.properties.href;if(url){if(!mobile){if(url.indexOf('.html')>-1){url=this.url.setSelector(url,'lightbox');}else if(url.substring(url.length-1)==='/'){url=url.substring(0,url.lastIndexOf('/'))+'.lightbox/';}else{url=url+'.lightbox/';}}
    $(self.obj).on('click',function(event){event.preventDefault();event.stopPropagation();if(!mobile){self.initOverlayContainer();self.showLoadingContainer();}
        self.visible=true;$.ajax({type:'GET',url:url,dataType:'html',success:function(response){self.overlayBuilder(response);Cog.init({$element:overlayContentInner});}});});$(document).on('click touchstart','.overlay-content',function(event){event.stopPropagation();}).on('click touchstart','.overlay-background, .overlay-container, .overlay-close',function(){if(self.visible){self.hideOverlay();}}).on('keydown',function(event){if(event.keyCode===27){self.hideOverlay();}});}};Overlay.prototype.initOverlayContainer=function(){var body=$('body'),overlayBackgroundHtml="<div class='overlay-background'></div>",overlayContainerHtml="<div class='overlay-container'>"+
    "<div class='overlay-content'>"+
    "<div tabindex='0' class='overlay-close'></div>"+
    "<div class='overlay-loading'></div>"+
    "<div class='overlay-content-inner'></div>"+
    '</div>'+
    '</div>';if(!overlayContainer){body.append(overlayBackgroundHtml,overlayContainerHtml);overlayBackground=$('.overlay-background');overlayContainer=$('.overlay-container');overlayContent=$('.overlay-content');overlayContentInner=$('.overlay-content-inner');overlayLoading=$('.overlay-loading');overlayClose=$('.overlay-close');}else{overlayContentInner.empty();}};Overlay.prototype.showLoadingContainer=function(){overlayClose.hide();overlayBackground.show();overlayContainer.css({'top':'50px'});overlayContainer.show();overlayLoading.show();};Overlay.prototype.overlayBuilder=function(response){var self=this;if(mobile){window.open(self.properties.href,'_blank');}else{self.showOverlay(response);}};Overlay.prototype.showOverlay=function(response){var overlayWidth=this.properties.width;overlayLoading.hide();overlayClose.show();scrollPosition=$(window).scrollTop();$('body').addClass('overlayVisible');overlayContent.removeClass('lightbox--full-content-size lightbox--default-size');overlayContent.css('max-width','none');if(!overlayWidth){overlayContent.addClass('lightbox--full-content-size');}else{overlayContent.addClass('lightbox--default-size');}
    overlayContentInner.append(response);if(overlayContentInner.find('.video').length){overlayContent.css({'width':overlayWidth});}else{overlayContent.css({'max-width':overlayWidth});}
    $('.container-fluid').on('scroll',function(e){e.preventDefault();e.stopPropagation();return false;});};Overlay.prototype.hideOverlay=function(){overlayContainer.fadeOut();overlayBackground.fadeOut();if(this.visible){this.visible=false;Cog.fireEvent('overlay','close');$('body').removeClass('overlayVisible');}
    $('.container-fluid').off('scroll');$(window).scrollTop(scrollPosition);};function checkMobile(){var device=Cog.Cookie.read('device-group');return(device==='mobile');}
api.onRegister=function(elements){var self=this;if(!mobileChecked){mobile=checkMobile();mobileChecked=true;}
    elements.$scope.each(function(){var overlay=new Overlay(this,self.external.url);overlay.attachEvents();});};Cog.registerComponent({name:'overlay',api:api,selector:'a.lightbox:not(.eligibility-overlay-trigger)',requires:[{name:'utils.url',apiId:'url'}]});})(Cog.jQuery());(function($){"use strict";var api={},href,blank,hiddenClass="is-hidden";function openDialog(event){var $target=$(event.target);event.preventDefault();if($target.prop("tagName").toUpperCase()!=="A"){$target=$target.closest(".external");}
href=$target.attr("href");blank=$target.attr("target");api.scope.removeClass(hiddenClass);return false;}
function acceptButton(){if(blank==="_blank"){window.open(href,"_blank");api.scope.addClass(hiddenClass);}else{window.location.href=href;}}
function denyButton(){api.scope.addClass(hiddenClass);}
api.init=function(scope){api.scope=scope;api.scope.find(".exit-notification-accept").click(acceptButton);api.scope.find(".exit-notification-deny").click(denyButton);$("body").on("click","a.external",openDialog);};Cog.register({name:"exitNotification",api:api,selector:"#exit-notification"});})(Cog.jQuery());(function($){"use strict";var api={};var sharedApi={};sharedApi.isMobile=function(){return!!window.matchMedia('screen and (max-width: 767px)').matches;};sharedApi.isMobileOrTablet=function(){return!window.matchMedia('screen and (min-width: 992px)').matches;};sharedApi.isTablet=function(){return!!window.matchMedia('screen and (min-width: 768px) and (max-width: 1023px)').matches;};sharedApi.isTabletOrDesktopSmall=function(){return!!window.matchMedia('screen and (min-width: 768px) and (max-width: 1200px)').matches;};sharedApi.isTabletOrDesktop=function(){return!!window.matchMedia('screen and (min-width: 768px)').matches;};sharedApi.isTabletHorizontalOrDesktop=function(){return!!window.matchMedia('screen and (min-width: 992px)').matches;};sharedApi.isDesktop=function(){return!!window.matchMedia('screen and (min-width: 1024px)').matches;};sharedApi.isDesktopLarge=function(){return!!window.matchMedia('screen and (min-width: 1201px)').matches;};Cog.registerStatic({name:'utils.media',api:api,sharedApi:sharedApi,});})(Cog.jQuery());(function($){"use strict";var api={},sharedApi={};api.init=function(){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g,evaluate:/\{\%(.+?)\%\}/g};$.extend(sharedApi,$("body").data());};Cog.registerStatic({name:"utils.settings",api:api,sharedApi:sharedApi});})(Cog.jQuery());(function($){"use strict";var api={};api.init=function(){$(document).on("click","a[href*=#]:not([href^=#])",function(e){var target=this.hash;var $target=$("[id="+target.substring(1)+"]").size()?$("[id="+target.substring(1)+"]"):$("[name="+target.substring(1)+"]");if($target.size()&&window.location.origin+window.location.pathname+this.hash===this.href){$("html, body").stop().animate({"scrollTop":$target.offset().top},800,function(){window.location.hash=target;});e.preventDefault();}});};Cog.registerStatic({name:"utils.scroll",api:api});})(Cog.jQuery());(function(){"use strict";var api={},sharedApi={};sharedApi.setSelector=function(url,selector,index){var post="";var pIndex=url.indexOf("?");if(pIndex===-1){pIndex=url.indexOf("#");}
if(pIndex!==-1){post=url.substring(pIndex);url=url.substring(0,pIndex);}
index=index?index:0;var selectors=sharedApi.getSelectors(url);var ext=url.substring(url.lastIndexOf("."));url=url.substring(0,url.lastIndexOf("."));var fragment=(selectors.length>0)?url.replace("."+selectors.join("."),""):url;if(selectors.length>0){for(var i=0;i<selectors.length;i++){if(index===i){fragment+="."+selector;}else{fragment+="."+selectors[i];}}}else{fragment+="."+selector;}
return fragment+ext+post;};sharedApi.getSelectors=function(url){var selectors=[];url=url||window.location.href;url=sharedApi.removeParameters(url);url=sharedApi.removeAnchor(url);var fragment=url.substring(url.lastIndexOf("/"));if(fragment){var split=fragment.split(".");if(split.length>2){for(var i=0;i<split.length;i++){if(i>0&&i<split.length-1){selectors.push(split[i]);}}}}
return selectors;};sharedApi.removeParameters=function(url){if(url.indexOf("?")!==-1){return url.substring(0,url.indexOf("?"));}
return url;};sharedApi.removeAnchor=function(url){if(url.indexOf("#")!==-1){return url.substring(0,url.indexOf("#"));}
return url;};Cog.registerStatic({name:"utils.url",api:api,sharedApi:sharedApi});})();(function($){"use strict";var api={};var cache={};var sharedApi={};var selectors={edit:'.cq-wcm-edit, .cq-wcm-edit-touch',};sharedApi.isEdit=function(){if(typeof cache.isEdit==='undefined'){cache.isEdit=$('body').is(selectors.edit);}
return cache.isEdit;};sharedApi.isAuthor=function(){if(typeof cache.isAuthor==='undefined'){cache.isAuthor=window.Granite&&window.Granite.author;}
return cache.isAuthor;};sharedApi.isPublish=function(){return!sharedApi.isAuthor();};Cog.registerStatic({name:'utils.status',api:api,sharedApi:sharedApi,});})(Cog.jQuery());(function($){"use strict";var api={};var sharedApi={};var selectors={homepage:'.homepage-top-promo-box',category:'.category-top-promo-box',categorySubcategory:'.category-subcategory-section',subcategory:'.subcategory-top-promo-box',};sharedApi.isSection=function($elem){return $elem.parents().is(selectors.homepage+', '
+selectors.category+', '
+selectors.categorySubcategory+', '
+selectors.subcategory);};sharedApi.isSectionHero=function($elem){return $elem.parents().is(selectors.homepage+', '
+selectors.category+', '
+selectors.subcategory);};Cog.registerStatic({name:'utils.promoBoxSection',api:api,sharedApi:sharedApi,});})(Cog.jQuery());(function($){'use strict';var api={},selectors={activeItemContent:'> .component-content > .accordion-container > .is-active > .accordion-content-wrapper',accordionHead:'> div > ul > li.accordion-slide > div.accordion-head',accordionSlide:'li.accordion-slide',contentWrapper:'div.accordion-content-wrapper',};api.onHeaderClick=function(event){var $this=$(event.currentTarget),$headParent=api.liParent($this),$accordionContent=$this.next(selectors.contentWrapper),$aTag=$this.find('a');Cog.fireEvent('accordion','change',{$target:$aTag,elementExtraInfo:$this.next().is(':visible')?'close':'open',manual:event.originalEvent!==undefined,});Cog.fireEventAsync('table','check-overflow',{scope:this});$headParent.toggleClass('is-active');$accordionContent.stop(true,true).slideToggle(300);Cog.fireEventAsync('table','check-swipe-icon-position',{scope:this});event.preventDefault();};api.previous=function(event){api.focus(api.liParent($(event.currentTarget)).prev());event.preventDefault();};api.next=function(event){api.focus(api.liParent($(event.currentTarget)).next());event.preventDefault();};api.first=function(event){api.focus(api.liParent($(event.currentTarget)).parent().children('li').first());event.preventDefault();};api.last=function(event){api.focus(api.liParent($(event.currentTarget)).parent().children('li').last());event.preventDefault();};api.liParent=function($elem){return $elem.parents('li').first();};api.focus=function($liElem){$liElem.find('> .accordion-head > a, > .accordion-head > .accordion-title > a').focus();};api.findAnchorElementInAccordionRelatedToUrlHash=function($accordion){var $anchorElement=$accordion.find(window.location.hash);var $closestAccordion=$anchorElement.closest('.accordion.component');return($closestAccordion.length===1&&$accordion[0]===$closestAccordion[0])?$anchorElement:null;};api.scrollTo=function($anchorElement){setTimeout(function(){$('html, body').stop().animate({scrollTop:$anchorElement.offset().top},300);},310);};api.onHeaderKeydown=function(event){var keyCode=event.which||event.keyCode;switch(keyCode){case 32:api.onHeaderClick(event);break;case 35:api.last(event);break;case 36:api.first(event);break;case 37:case 38:api.previous(event);break;case 39:case 40:api.next(event);break;default:break;}};api.bindAnchorClicks=function($accordion){$accordion.find('[id]').each(function(){var $anchorElement=$(this);var $accordionSlide=null;var $current=$anchorElement.parent();while($current.length!==0&&$current[0]!==$accordion[0]){if($current.hasClass('accordion-slide')){$accordionSlide=$current;}
$current=$current.parent();}
if($anchorElement[0]&&$accordionSlide){$('a[href="#'+$anchorElement[0].id+'"]').on('click',function(e){var isAccordionHeadClick=!!$(e.target).closest('.accordion-head').length;if(!isAccordionHeadClick){api.openPanel($accordionSlide,$anchorElement);}});}});};api.openPanel=function($accordionSlide,$anchorElement){var wrapperStyle=api.findContentWrapper($accordionSlide).attr('style');if(!wrapperStyle||wrapperStyle==='display: none;'){$accordionSlide.find('> div.accordion-head').click();api.scrollTo($anchorElement);}};api.findContentWrapper=function($accordionSlide){return $accordionSlide.find('> '+selectors.contentWrapper);};api.findParentSlide=function($anchorElement){return $anchorElement?$anchorElement.closest(selectors.accordionSlide).parents(selectors.accordionSlide):null;};api.onRegister=function(element){if(this.external.status.isEdit()){return;}
var $this=element.$scope;$this.on('click',selectors.accordionHead,api.onHeaderClick);$this.on('keydown',selectors.accordionHead,api.onHeaderKeydown);api.bindAnchorClicks($this);var $anchorElementToDisplay=api.findAnchorElementInAccordionRelatedToUrlHash($this);var $parentSlide=api.findParentSlide($anchorElementToDisplay);if($parentSlide){var $contentWrapper=api.findContentWrapper($parentSlide);$contentWrapper.css('display','block');var $headParent=api.liParent($contentWrapper);$headParent.addClass('is-active');}
var $wrapper=$anchorElementToDisplay?api.findContentWrapper($anchorElementToDisplay.closest(selectors.accordionSlide)):$this.find(selectors.activeItemContent);if($wrapper.length){$wrapper.css('display','block');var $headParent=api.liParent($wrapper);$headParent.addClass('is-active');}
if($anchorElementToDisplay){api.scrollTo($anchorElementToDisplay);}};Cog.registerComponent({name:'accordion',api:api,selector:'.accordion',requires:[{name:'utils.status',apiId:'status',},],});})(Cog.jQuery());(function($){"use strict";var api={};api.delay=0;api.showSlide=function(nextIndex,context,delay,autoRotate){clearTimeout(context.timerId);var current=context.slides.filter(".is-active"),currentIndex=current.index();nextIndex=(nextIndex<0)?(context.slides.length-1):((nextIndex>=context.slides.length)?0:nextIndex);if(Number(nextIndex)!==Number(currentIndex)){context.slides.stop(true,true);current.removeClass("is-active").fadeOut(function(){$(this).removeClass("is-active");context.controls.removeClass("is-active").eq(nextIndex).addClass("is-active");});context.slides.eq(nextIndex).fadeIn(function(){$(this).addClass("is-active");});}
if(delay>0&&autoRotate!==false){context.timerId=setTimeout(function(){api.showSlide(nextIndex+1,context,delay,autoRotate);},delay*1000);}};api.onRegister=function(scope){var $carousel=scope.$scope,$slideNav=$carousel.find(".carousel-nav"),$slideControls=$slideNav.find("li:not(.carousel-nav-prev):not(.carousel-nav-next)"),$slidesList=$carousel.find(".carousel-slides"),$slides=$slidesList.find(".carousel-slide"),slidesMaxHeight=$slidesList.data("height"),delay=0,autoRotate=$slidesList.data("rotate"),context={slides:$slides,controls:$slideControls},status=this.external.status,resizeView=function(){if(status.isAuthor()){return;}
var maxHeight=0;$slides.each(function(){var height=$(this).height();maxHeight=height>maxHeight?height:maxHeight;});if(slidesMaxHeight){if(maxHeight>slidesMaxHeight){maxHeight=slidesMaxHeight;}}
$slidesList.css("height",maxHeight+"px");};$(window).resize(_.throttle(function(){resizeView();},250));resizeView();delay=$slidesList.data("delay")||0;$slides.hide().first().show();$slideNav.on("click","a",function(e){e.preventDefault();var $parent=$(this).parent(),index=$slideControls.index($parent);if($parent.is(".carousel-nav-prev,.carousel-nav-next")){index=$slides.filter(".is-active").index();index=$parent.hasClass("carousel-nav-prev")?index-1:index+1;}
api.showSlide(index,context);});if(delay>0&&autoRotate!==false){context.timerId=setTimeout(function(){api.showSlide(1,context,delay,autoRotate);},delay*1000);}};Cog.registerComponent({name:"carousel",api:api,selector:".carousel",requires:[{name:"utils.status",apiId:"status"}]});})(Cog.jQuery());(function($){"use strict";var api={},clearForm,resetForm,manualInputs;clearForm=function($form,oldbrowser){$form.find("input:text, input:password, input:file, select, textarea").val("");$form.find("input:radio").prop("checked",false);$form.find("input:checkbox").prop("checked",false);if(oldbrowser){$form.find("input:text, input:password, input:file, select, textarea").blur();}};resetForm=function($form){$form[0].reset();$form.find("input, textarea").blur();};manualInputs=(function(){function applyStyle($input,$label){if($input.is(":checked")){$label.addClass("checked");}else{$label.removeClass("checked");}}
return function($inputs){$inputs.each(function(i,input){var $input=$(input),$label=$input.parent().find("label");$label.on("click",function(ev){ev.preventDefault();input.checked=!input.checked;});applyStyle($input,$label);$input.on("change",function(){applyStyle($input,$label);});});};})();api.onRegister=function(scope){var form=scope.$scope,disabledMessage="Submit functionality is disabled"+
" in Edit mode - switch to Preview mode to use it.",browser=this.external.browser,status=this.external.status;form.find("textarea[maxlength]").bind("change keyup",function(){var maxlength=$(this).attr("maxlength"),val=$(this).val();if(val.length>maxlength){$(this).val(val.substring(0,maxlength));}});manualInputs(form.find("input[type=radio], input[type=checkbox]"));form.find("button.clearButton").bind("click",function(){clearForm($(this.form));});form.find("button.control-tooltip-button").bind("click",function(e){e.preventDefault();});if(browser.msie&&browser.version<10){form.on("click","button.clearButton",function(){clearForm($(this.form),true);});form.find("input.reset").bind("click",function(e){e.preventDefault();resetForm($(this.form));});form.find("button.editSubmit").bind("click",function(e){if(status.isAuthor()){return true;}
e.preventDefault();window.alert(disabledMessage);});}else{form.on("click","button.clearButton",function(){clearForm($(this.form));});form.find("button.editSubmit").bind("click",function(e){if(status.isAuthor()){return true;}
e.preventDefault();window.alert(disabledMessage);});}};Cog.registerComponent({name:"form",api:api,selector:".form",requires:[{name:"utils.browser",apiId:"browser"},{name:"utils.status",apiId:"status"}]});}(Cog.jQuery()));(function($){"use strict";var api={},refs={componentName:"imageGallery",thumbnailsContainerSelector:".imageGallery-thumbnails",imageViewOverlaySelector:".imageGallery-view-overlay",imageViewSelector:".imageGallery-view",thumbnailsListContainerSelector:".imageGallery-list",mainArrowsSelector:".imageGallery-view .imageGallery-arrow",thumbnailsArrowsSelector:".imageGallery-thumbnails .imageGallery-arrow",thumbnailsArrowsLeftClass:"imageGallery-arrow-left",thumbnailsArrowsRightClass:"imageGallery-arrow-right",descriptionSelector:".imageGallery-description",thumbnailsListInner:".imageGallery-list-inner",thumbnailsList:".imageGallery-list"},Direction={PREV:-1,NEXT:1},settings={loop:true,playTimeout:4000};api.onRegister=function(scope){function showNext($context){var currentItem=$context.filter(".is-active"),$nextItem=currentItem.next();if($nextItem.length){$nextItem.trigger("click");}else if(settings.loop){$context.eq(0).trigger("click");}}
function showPrev($context){var currentItem=$context.filter(".is-active"),$prevItem=currentItem.prev();if($prevItem.length){$prevItem.trigger("click");}else if(settings.loop){$context.last().trigger("click");}}
function centerActiveThumbnail($context){var activeItem=$context.filter(".is-active"),currentItemPosition=activeItem.position();scrollThumbnails($context,currentItemPosition.left*-1);}
function scrollThumbnails($context,to){to+=$thumbnailsList.parent().width()/2-$context.filter(".is-active").width()/2;to=Math.max(to,-1*$thumbnailsList.width()+$thumbnailsList.parent().width());to=Math.min(0,to);$thumbnailsList.animate({left:to});}
var $this=scope.$scope,$mainImage=$this.find(refs.imageViewSelector+" img"),$mainImageContainer=$this.find(refs.imageViewSelector),$thumbnailsContainer=$this.find(refs.thumbnailsContainerSelector),$thumbnailsListContainer=$thumbnailsContainer.find(refs.thumbnailsListContainerSelector),$thumbnailsList=$thumbnailsListContainer.find(refs.thumbnailsListInner),$thumbnailsItems=$thumbnailsList.find("li"),$arrowsMain=$this.find(refs.mainArrowsSelector),$arrowsThumbs=$this.find(refs.thumbnailsArrowsSelector),$descriptionContainer=$this.find(refs.descriptionSelector),$firstItem=$thumbnailsItems.eq(0),playingTimer,maxImageHeight=$mainImageContainer.data("height");function setListWidth(){var thumbnailWidth=$firstItem.outerWidth(true),listOuterWidth=$thumbnailsItems.length*thumbnailWidth;$thumbnailsList.css("width",listOuterWidth);}
$mainImageContainer.on("click",function(){clearInterval(playingTimer);if($this.hasClass("is-playing")){$this.removeClass("is-playing");}else{playingTimer=setInterval(function(){var $activeItem=$thumbnailsItems.filter(".is-active"),$nextItem=$activeItem.next();if($nextItem.length){$nextItem.trigger("click");}else{$thumbnailsItems.eq(0).trigger("click");}},settings.playTimeout);$this.addClass("is-playing");}});$thumbnailsItems.on("click",function(ev){ev.preventDefault();ev.stopPropagation();var $this=$(this),$link=$this.find("a"),$linkImg=$link.find("img");if(!$this.hasClass("is-active")){$thumbnailsItems.removeClass("is-active");$this.addClass("is-active");$mainImage.on("load",function(){$mainImage.fadeIn(200);$descriptionContainer.text($link.data("description"));});if($linkImg.attr("src")!==$mainImage.attr("src")){var thumbnailsListLeft=$thumbnailsList.parent().offset().left,thumbnailsListRight=thumbnailsListLeft+
    $thumbnailsList.parent().width(),thumbnailLeft=$this.offset().left,thumbnailRight=thumbnailLeft+$this.outerWidth(false);if(thumbnailsListLeft>thumbnailLeft){$thumbnailsList.animate({left:"+="+(thumbnailsListLeft-thumbnailLeft)});}else if(thumbnailsListRight<thumbnailRight){$thumbnailsList.animate({left:"-="+(thumbnailRight-thumbnailsListRight)});}
    $mainImage.fadeTo(200,0,function(){var originalHeight=$linkImg.data("height"),correctHeight=!maxImageHeight||originalHeight<=maxImageHeight?originalHeight:maxImageHeight,originalWidth=$linkImg.data("width"),correctWidth=(correctHeight*originalWidth)/originalHeight;$mainImage.attr("width",parseInt(correctWidth,10));$mainImage.attr("height",parseInt(correctHeight,10));$mainImage.attr("src",$link.attr("href"));$mainImage.fadeTo(200,1);});}}});$arrowsThumbs.on("click",function(e){e.preventDefault();e.stopPropagation();var vector=$(this).hasClass(refs.thumbnailsArrowsLeftClass)?Direction.PREV:Direction.NEXT,currentScroll=parseInt($thumbnailsList.css("left"),10),to=currentScroll-vector*$thumbnailsItems.eq(0).width()*2;to-=$thumbnailsList.parent().width()/2-
    $thumbnailsItems.filter(".is-active").width()/2;scrollThumbnails($thumbnailsItems,to);});$arrowsMain.on("click",function(ev){ev.preventDefault();ev.stopPropagation();$thumbnailsList.stop(false,true);var $this=$(this),vector=$this.hasClass(refs.thumbnailsArrowsLeftClass)?Direction.PREV:Direction.NEXT;if(vector===Direction.NEXT){showNext($thumbnailsItems);}else{showPrev($thumbnailsItems);}
    centerActiveThumbnail($thumbnailsItems);$arrowsMain.removeClass("is-disabled");});var originalHeight=$mainImage.attr("height"),correctHeight=!maxImageHeight||originalHeight<=maxImageHeight?originalHeight:maxImageHeight,originalWidth=$mainImage.attr("width"),correctWidth=(correctHeight*originalWidth)/originalHeight;$mainImage.attr("width",parseInt(correctWidth,10));$mainImage.attr("height",parseInt(correctHeight,10));setListWidth();};Cog.registerComponent({name:"imageGallery",api:api,selector:".imageGallery"});})(Cog.jQuery());(function($){"use strict";var api={},loaded=false,$maps=[],URL="https://maps.googleapis.com/maps/api/js",defaultOptions={height:250,zoom:14,latitude:51.500134,longitude:-0.12623,mapType:"ROADMAP",markers:[]};function loadScript(params){var scriptElement=document.createElement("script"),to=document.getElementsByTagName("script")[0];scriptElement.async=true;scriptElement.src=URL+"?"+$.param(params);to.parentNode.insertBefore(scriptElement,to);loaded=true;}
function showMarkers(scope){if(!scope.mapOptions.markers.length){return;}
    var marker,k,infoWindow,tmarker;for(k in scope.mapOptions.markers){if(scope.mapOptions.markers.hasOwnProperty(k)&&scope.mapOptions.markers[k].title.length){marker=scope.mapOptions.markers[k];tmarker=new google.maps.Marker({position:new google.maps.LatLng(marker.latitude,marker.longitude),map:scope.gmap,title:marker.title});if(marker.description.length){infoWindow=new google.maps.InfoWindow({content:_.unescape(marker.description)});google.maps.event.addListener(tmarker,"click",openInfoWindow(tmarker,infoWindow,scope.gmap));}}}}
function openInfoWindow(tmarker,infoWindow,gMap){return(function(tmarker,infoWindow){return function(){infoWindow.open(gMap,tmarker);};})(tmarker,infoWindow);}
function onRegister(scope){var map=scope,options=$.extend(defaultOptions,map.data()),centerPosition;map.height(options.height);centerPosition=new google.maps.LatLng(options.latitude,options.longitude);scope.mapOptions={zoom:options.zoom,center:centerPosition,markers:options.markers,mapTypeId:google.maps.MapTypeId[options.mapType]};scope.gmap=new google.maps.Map(map[0],scope.mapOptions);showMarkers(scope);var tabContent=map.parents(".tabs-content");if(tabContent.size()){Cog.addListener("tab","change",function(e){if(tabContent.attr("id")===e.eventData.id){google.maps.event.trigger(scope.gmap,"resize");}});}}
api.callback=function(){_.each($maps,function(el){onRegister($(el));});};api.init=function(components){var params={};$maps=components;if(!$maps.size()){return false;}
    if(loaded){api.callback();return false;}
    if($maps.first().data("key")){params.key=$maps.first().data("key");}
    params.callback="Cog.component.map.callback";loadScript(params);};api.onRegister=$.noop;Cog.registerComponent({name:"map",api:api,selector:".map-canvas"});Cog.component.map=api;})(Cog.jQuery());(function($){"use strict";function Nav($nav){this.$nav=$nav;this.bindUIEvents();}
Nav.prototype.bindUIEvents=function(){var self=this;self.$nav.on("tap click",".navigation-mobile-menu",function(e){e.preventDefault();$(this).next(".navigation-root").toggleClass("is-open");$(this).attr("aria-expanded",function(_,attr){if(attr==="false"){attr=false;}
    return!attr;});});if(!self.$nav.is(".navigation-horizontal")||$("html").hasClass("mod-touch")){self.$nav.on("tap click",".has-children > .navigation-item-title >"+
    " .navigation-item-decoration",function(event){event.preventDefault();event.stopPropagation();var $this=$(this).closest(".has-children"),$siblings=$this.siblings(".has-children");$siblings.not($this).removeClass("is-open").find(".has-children").removeClass("is-open");$this.toggleClass("is-open");}).on("keydown",".has-children > .navigation-item-title >"+
    " .navigation-item-decoration",function(event){if(event.which===13){event.stopPropagation();event.preventDefault();$(this).trigger("click");}});self.$nav.on("click",".has-children > .navigation-item-title >"+
    ".navigation-item-decoration",function(event){event.preventDefault();event.stopPropagation();});}else{self.$nav.on("mouseenter focusin",".has-children",function(){var $this=$(this);$this.addClass("is-open");}).on("mouseleave",".has-children",function(){$(this).removeClass("is-open");}).on("focusout",".has-children",function(){var $this=$(this);setTimeout(function(){if(!$this.is(":focus")&&!$this.find(":focus").size()){$this.removeClass("is-open");}},0);});}};var api={};api.navs=[];api.onRegister=function(scope){var $nav=scope.$scope;api.navs.push(new Nav($nav));};Cog.registerComponent({name:"navigation",api:api,selector:".navigation"});return api;}(Cog.jQuery()));(function($){'use strict';var api={tabs:[]};function Tab($scope){this.$scope=$scope;this.init();this.bindEvents();this.adjustPosition();}
Tab.prototype.init=function(){var $this=this.$scope;this.$contents=$this.find('> .component-content > .tabs-content');this.$contents.addClass('is-hidden');this.isVertical=$this.hasClass('tabs-vertical');this.$tabs=$this.find('> .component-content > .tabs-nav .tabs-nav-item');this.showSwipeIcon();$(window).on('resize',_.debounce(this.showSwipeIcon.bind(this),150));};Tab.prototype.bindEvents=function(){function activateTab(event){var $tab=$(event.currentTarget),newPanel,$aTag=$tab.find('a');self.$contents.addClass('is-hidden');newPanel=self.$contents.filter($aTag.attr('href'));newPanel.removeClass('is-hidden');self.$tabs.removeClass('is-active');$tab.addClass('is-active');event.preventDefault();Cog.fireEvent('tab','change',{id:newPanel.attr('id'),container:newPanel,$target:$aTag,manual:event.originalEvent!==undefined});}
    function findAnchorElement(){var anchorIdFromUrl=window.location.hash;anchorIdFromUrl=anchorIdFromUrl?anchorIdFromUrl.substr(1):undefined;return anchorIdFromUrl?$(document.getElementById(anchorIdFromUrl)):undefined;}
    function getTabIndex($anchorElement){var tabIndex=-1;var tabsContent=$anchorElement.closest('.tabs-content')[0];if(tabsContent&&tabsContent.id){tabIndex=tabsContent.id.substring(tabsContent.id.lastIndexOf('-')+1);}
        return tabIndex;}
    function isInTabs($anchorElement){return $anchorElement.closest('.tabs.component').length===1;}
    function scrollTo($anchorElement){setTimeout(function(){$('html, body').stop().animate({scrollTop:$anchorElement.offset().top},300);},0);}
    function bindAnchorClicks($tabsComponent,$tabsList){$tabsComponent.find('.tabContent > .content [id]').each(function(){var $anchorElement=$(this);var tabIndex=getTabIndex($anchorElement);var $navItemToClick=$($tabsList[tabIndex]);if($anchorElement[0]&&$navItemToClick){$('a[href="#'+$anchorElement[0].id+'"]').on('click',function(){if(!$navItemToClick.hasClass('.is-active')){$navItemToClick.click();}
        scrollTo($anchorElement);});}});}
    var self=this;this.navWidth=this.$scope.find('> .component-content > .tabs-nav').width();this.listWidth=0;this.listHeight=0;this.$tabs.each(function(){self.listWidth+=$(this).outerWidth(true);self.listHeight+=$(this).outerHeight(true);});if(!this.isVertical){if(this.navWidth<this.listWidth){this.initializeScrolling();}}else{this.setContentHeight();}
    this.$tabs.on('click',activateTab);this.$tabs.filter('.is-active').trigger('click');bindAnchorClicks(this.$scope,this.$tabs);var $anchorElement=findAnchorElement();if($anchorElement&&$anchorElement.length===1&&isInTabs($anchorElement)){var tabIndex=getTabIndex($anchorElement);var navItemToClick=self.$tabs[tabIndex];if(navItemToClick){$(navItemToClick).click();scrollTo($anchorElement);}}};Tab.prototype.initializeScrolling=function(){var $switchers=this.$scope.find('.tabs-nav-switcher'),$switcherRight=$switchers.filter('.tabs-nav-switcher-right'),$switcherLeft=$switchers.filter('.tabs-nav-switcher-left'),$list=this.$scope.find('.tabs-nav-list'),self=this;$switcherRight.removeClass('is-hidden');$switchers.on('click',function(){var $this=$(this),difference=$this.hasClass('tabs-nav-switcher-right')?-20:20,nextLeft=(parseInt($list.css('left'),10)+difference);if(nextLeft<0){$switcherLeft.removeClass('is-hidden');if(-1*nextLeft>=self.listWidth-self.navWidth){$switcherRight.addClass('is-hidden');}else{$switcherRight.removeClass('is-hidden');}}else{$switcherLeft.addClass('is-hidden');}
    $list.stop().animate({left:nextLeft+'px'});});};Tab.prototype.setContentHeight=function(){var self=this;this.$contents.each(function(){if($(this).height()<self.listHeight){$(this).css('min-height',self.listHeight+'px');}});};Tab.prototype.showSwipeIcon=function(){var $tabNav=this.$scope.find('.tabs-nav'),$navElements=$tabNav.find('>ul li'),navWidth=0;for(var i=0;i<=$navElements.length;i++){navWidth+=$($navElements[i]).outerWidth();}
    if($tabNav.width()<navWidth-2){$tabNav.addClass('tabs-nav-scroll');}else{$tabNav.removeClass('tabs-nav-scroll');}};Tab.prototype.adjustPosition=function(){$(document).ready(function(){if(window.location.href){var $target=$(document.getElementById(window.location.hash.substr(1)));if($target.length){$('html, body').stop().animate({scrollTop:$target.offset().top,},0);}}});};api.onRegister=function(scope){api.tabs.push(new Tab(scope.$scope));};Cog.registerComponent({name:'tabs',api:api,selector:'.tabs'});})(Cog.jQuery());(function($){"use strict";var api={};api.preprocess={twitter:function(tweet,settings){function parseDate(tdate){var system_date=new Date(Date.parse(tdate)),user_date=new Date();var K=function(){var a=navigator.userAgent;return{ie:a.match(/MSIE\s([^;]*)/)}};if(K.ie){system_date=Date.parse(tdate.replace(/( \+)/,' UTC$1'))}
    var diff=Math.floor((user_date-system_date)/1000);if(diff<=1){return "just now";}
    if(diff<20){return diff+" seconds ago";}
    if(diff<40){return "half a minute ago";}
    if(diff<60){return "less than a minute ago";}
    if(diff<=90){return "one minute ago";}
    if(diff<=3540){return Math.round(diff/60)+" minutes ago";}
    if(diff<=5400){return "1 hour ago";}
    if(diff<=86400){return Math.round(diff/3600)+" hours ago";}
    if(diff<=129600){return "1 day ago";}
    if(diff<604800){return Math.round(diff/86400)+" days ago";}
    if(diff<=777600){return "1 week ago";}
    return "on "+system_date;}
    var target=settings.blankLinks?" target=\"_blank\"":"";tweet.text=tweet.text.replace(/(^|\s)https:\/\/t.co\/(\w+)/,"$1<a href=\"https://t.co/$2\""+target+"><strong>http://t.co/$2</strong><\/a>").replace(/(^|\s)@(\w+)/g,"$1<a href=\"https:\/\/www.twitter.com\/$2\""+
        target+">@<strong>$2</strong><\/a>").replace(/(^|\s)#(\w+)/g,"$1<a href=\"https:\/\/twitter.com\/search?q=%23$2&src=hash\""+
        target+">#<strong>$2</strong><\/a>");var posted=parseDate(tweet.created_at);tweet.created_at=posted;tweet.target=target;tweet.retwitted=false;if(typeof tweet.retweeted_status!=="undefined"){tweet.retwitted=tweet.retweeted_status.user.name;}
    return tweet;}};api.onRegister=function(scope){var fp,provider,content,interval,getTweets,isTicker;getTweets=function(provider,settings){var self=api;$.getJSON(provider,function(data){api.processData.call(self,data,settings,scope);});};api.scope=fp=scope.$scope;content=$(fp).find(".component-content");provider=content.data("providerPath");isTicker=api.scope.hasClass('twitter-ticker');if(provider){interval=content.data("refresh-interval");getTweets.call(fp,provider,content.data());if(interval&&!isTicker){(function(fp,provider,settings){window.setInterval(function(){getTweets.call(fp,provider,settings);},interval*1000);})(fp,provider,content.data());}}};api.processData=function(data,settings,scope){if(typeof data.feedType==="undefined"){return false;}
var template=api.getTemplate(data.feedType),output="";_.forEach(data.statuses,function(feed){if(typeof api.preprocess[data.feedType]==="function"){feed=api.preprocess[data.feedType](feed,settings);}
    var $tweet=$(_.template(template,feed));var $timeTpl=$('<a class="tweet-link" href="https://twitter.com/'+
        feed.user.screen_name+
        '/status/'+feed.id_str+
        '"><time class="twitter-date-ago">'+feed.created_at+'</time></a>');$tweet.find('.twitter-actions').before($timeTpl);output+=$tweet[0].outerHTML;});if(scope.$scope.hasClass('twitter-ticker')){var MINIMUM_STATUSES_QTY=8;var additional='';var multiplier=Math.ceil(MINIMUM_STATUSES_QTY/data.statuses.length);for(var i=1;i<multiplier;i++){additional+=output;}
    output+=additional;}
$(scope.$scope).find(".feed-provider-feeds").html(output);Cog.fireEvent("twitter","feedsLoaded");return true;};api.getTemplate=function(type){return $("."+type+"-template")[0].innerHTML;};Cog.registerComponent({name:"feedProvider",api:api,selector:".twitter",requires:["utils.settings"]});})(Cog.jQuery());(function($){'use strict';var api={},features=['playpause','progress','current','duration','tracks','volume','fullscreen'];function Video($el){this.$el=$el;this.$video=$el.find('video');this.imageAlt=$el.find('.component-content').data('imagealt');this.initialize();this.bindEvents();}
Video.prototype={initialize:function(){var tabContent=this.$video.parents('.tabs-content');if(tabContent.size()){Cog.addListener('tab','change',function(e){if(tabContent.attr('id')===e.eventData.id){this.mediaElement.player.resetSize();}},{scope:this});}
        this.$video.mediaelementplayer({features:features,enableAutosize:false,plugins:['flash','youtube'],pluginPath:api.external.settings.themePath+'/assets/swf/',flashName:'flashmediaelement.swf',videoHeight:this.$video.attr('height'),success:this.onMejsSuccess.bind(this)});},bindEvents:function(){Cog.addListener('overlay','close',this.onOverlayClose,{scope:this,disposable:true});},onOverlayClose:function(){if(this.$el.parents('.overlay-container').size()){this.mediaElement.stop();this.mediaElement.remove();Cog.finalize(this.$el);}},onMejsSuccess:function(mediaElement){this.mediaElement=mediaElement;var image=this.$el.find('.mejs-poster > img')[0];if(image){image.alt=this.imageAlt;}}};api.onRegister=function(scope){if(this.external.status.isEdit()){return;};new Video(scope.$scope);};Cog.registerComponent({name:'videoplayer',api:api,selector:'.video',requires:[{name:'utils.settings',apiId:'settings'},{name:'utils.status',apiId:'status'}]});})(Cog.jQuery());(function($){"use strict";var api={},features=["playpause","progress","current","duration","tracks","volume","fullscreen"],refs={thumbnailsListContainerSelector:".videoGallery-list",thumbnailsArrowsSelector:".videoGallery-arrow",descriptionSelector:".videoGallery-description",titleSelector:".videoGallery-heading",videoWrapper:".videoGallery-video"};function provideArrayOfSources(domElement){var data=$(domElement).data(),sources=[{src:data.srcMp4,type:"video/mp4"},{src:data.srcOgg,type:"video/ogg"},{src:data.srcWebm,type:"video/webm"}];return _.filter(sources,"src");}
function VideoGallery($el){this.$el=$el;this.$video=$el.find("video");this.mediaElement=null;this.$thumbnails=this.$el.find(refs.thumbnailsListContainerSelector);this.$thumbnailsList=this.$thumbnails.find("ul");this.$thumbnailsItems=this.$thumbnails.find("li");this.$arrows=this.$el.find(refs.thumbnailsArrowsSelector);this.listContainerWidth=this.$thumbnails.width();this.thumbnailWidth=this.$thumbnailsItems.eq(0).outerWidth(true);this.autoPlayNext=this.$el.find(refs.videoWrapper).data("autoplay-next-video");this.initialize();this.bindEvents();}
VideoGallery.prototype={initialize:function(){var self=this;this.$thumbnailsList.css("width",this.thumbnailWidth*this.$thumbnailsItems.length);this.$video.mediaelementplayer({features:features,enableAutosize:true,plugins:["flash"],pluginPath:api.external.settings.themePath+"/assets/swf/",flashName:"flashmediaelement.swf",success:this.onMejsSuccess.bind(this)});function recalculateListWith(){self.listContainerWidth=self.$thumbnails.width();self.$thumbnailsList.css({left:0});self.$arrows.filter(".videoGallery-arrow-left").addClass("is-disabled");self.$arrows.filter(".videoGallery-arrow-right").removeClass("is-disabled");}
        $(window).resize(_.throttle(recalculateListWith,150));},bindEvents:function(){var self=this;Cog.addListener("overlay","close",this.onOverlayClose,{scope:this,disposable:true});this.$thumbnailsItems.on("click",function(){var $this=$(this);self.reloadVideo({src:provideArrayOfSources($this),autoplay:true,title:$this.data("title"),poster:$this.find("img").attr("src"),description:$this.data("description")});self.$thumbnailsItems.removeClass("is-active");$this.addClass("is-active");});this.$arrows.click("click",function(){self.$thumbnailsList.stop(false,true);var $this=$(this),listOuterWidth=self.thumbnailWidth*self.$thumbnailsItems.length,left=parseInt(self.$thumbnailsList.css("left"),10),vector=$this.hasClass("videoGallery-arrow-left")?1:-1,nextLeft=left+(self.thumbnailWidth*vector),maxLeft=listOuterWidth-self.listContainerWidth+
        (self.listContainerWidth%self.thumbnailWidth);self.$arrows.removeClass("is-disabled");if(nextLeft<=0&&(-1)*nextLeft<=maxLeft){self.$thumbnailsList.animate({left:nextLeft});}else{$this.addClass("is-disabled");}
        nextLeft+=self.thumbnailWidth*vector;if(!(nextLeft<=0&&(-1)*nextLeft<=maxLeft)){$this.addClass("is-disabled");}});},reloadVideo:function(data){var mediaElement=this.mediaElement,$descriptionContainer=this.$el.find(refs.descriptionSelector),$titleContainer=this.$el.find(refs.titleSelector);mediaElement.pause();mediaElement.setSrc(data.src);mediaElement.load();if(data.poster){this.$video.attr("poster",data.poster);this.$video.parents(".mejs-inner").find(".mejs-poster").css({"background-image":"url('"+data.poster+"')","display":"block"});}
        if(data.autoplay){mediaElement.play();}
        $descriptionContainer.text(data.description);$titleContainer.text(data.title);},onOverlayClose:function(){if(this.$el.parents(".overlay-container").size()){this.mediaElement.stop();this.mediaElement.remove();Cog.finalize(this.$el);}},onMejsSuccess:function(mediaElement){var self=this,$thumbnailsItems=this.$thumbnailsItems;this.mediaElement=mediaElement;mediaElement.addEventListener("ended",function(){var $nextThumbnail=$thumbnailsItems.filter(".is-active").eq(0).next();if($nextThumbnail.length){self.reloadVideo({src:provideArrayOfSources($nextThumbnail),autoplay:self.autoPlayNext,title:$nextThumbnail.data("title"),poster:$nextThumbnail.find("img").attr("src"),description:$nextThumbnail.data("description")});$thumbnailsItems.removeClass("is-active");$nextThumbnail.addClass("is-active");}});}};api.onRegister=function(scope){new VideoGallery(scope.$scope);};Cog.registerComponent({name:"videoGallery",api:api,selector:".videoGallery",requires:[{name:"utils.settings",apiId:"settings"}]});}(Cog.jQuery()));(function($){var api={emailTipBox:[]};var successMessage='You’ve successfully joined MSE’s Money Tips email list.';var errorMessage='Sorry something went wrong - you may already have joined MSE’s '+'Money Tips email list with this email address. If not, please try again.';var errorMessageEmailError='Sorry, something went wrong - please enter a valid email address.';var errorMessageSubscribed='Sorry, something went wrong - you have already joined MSE\'s '+'Money Tips email list with this email address.';var errorMessageEmptyMail='Sorry, something went wrong - please enter your email address.';var errorMessageTipBoxMain='Please enter a valid email address.';function EmailTipBox($scope){this.$scope=$scope;this.bindUIEvents();this.init();}
EmailTipBox.prototype.init=function(){this.openTipBox();this.closeTipPopUp();this.submitEmail();this.readCookie();this.hideForScreenReader();};EmailTipBox.prototype.readCookie=function(){if(Cog.Cookie.read('tip')!=='tip'){this.showTipPopupOnScroll();}};EmailTipBox.prototype.hideForScreenReader=function(){if(this.$scope.parents('.tip-email-popup').length){this.$scope.attr('aria-hidden','true');}};EmailTipBox.prototype.openTipBox=function(){var $this=this.$scope;var $toggleButton=$this.find('.email-tip-box__collapse');$toggleButton.click(function(){$this.toggleClass('email-tip-box--collapsed email-tip-box--expanded');});};EmailTipBox.prototype.removeTipBox=function(){var $tipBoxes=$('body').find('.reference-email-tip-box:not(.sidebar-section-container .reference-email-tip-box)');$tipBoxes.remove();};EmailTipBox.prototype.displayErrorMessage=function(message){Cog.fireEvent('analytics','tipbox.displayErrorMessage',{$target:this.$scope,elementExtraInfo:message});var $this=this.$scope;var $parent=$this.parent();var $visibleOldError=$parent.parent().find('.email-tip-box__error');var $error=$('<p class="email-tip-box__error" style="display: none">'+message+'</p>');var $formInputs=$this.find('.inputs');if($visibleOldError.length){$visibleOldError.remove();}
    if($parent.parent().hasClass('tip-email-popup')){$parent.after($error);$error.fadeIn('normal');}else if($this.parent().hasClass('tip-box-general')){$parent.after($error);$error.fadeIn('normal');}else if($this.parent().hasClass('tip-box-main')){var $tipBoxMainError=$error;if(message===errorMessageEmailError||message===errorMessageEmptyMail){$tipBoxMainError=$('<p class="email-tip-box__error" style="display: none">\n                    '+errorMessageTipBoxMain+'</p>');}
        $formInputs.after($tipBoxMainError);$tipBoxMainError.fadeIn('normal');}else{$this.after($error);$error.fadeIn('normal');}};EmailTipBox.prototype.displaySuccessMessage=function(message){Cog.fireEvent('analytics','tipbox.displaySuccessMessage',{$target:this.$scope,isHomeTipBox:this.$scope.is('.tip-box-general-form, .tip-box-main-form')});var $this=this.$scope;var $visibleOldError=$this.parent().parent().find('.email-tip-box__error');if($visibleOldError.length){$visibleOldError.remove();}
    $('body').prepend('<p class="email-tip-box__success">'+message+'</p>');$('body').find('.reference-email-tip-box input[type="email"]').val('');setTimeout(function(){$('body').find('.email-tip-box__success').remove();},12000);};EmailTipBox.prototype.closeTipPopUp=function(){var _this=this;var $this=this.$scope;var $tipPopUpClose=$this.find('.email-tip-box__popup-close');$tipPopUpClose.click(function(){Cog.fireEvent('analytics','tipbox.closeTipBoxPopUp',{$target:_this.$scope});$this.parent().parent().css({bottom:'-300px'});setTimeout(function(){$this.parent().parent().remove();Cog.Cookie.create('tip','tip',90);},900);});};EmailTipBox.prototype.showTipPopupOnScroll=function(){var _this2=this;var $tipPopUp=this.$scope.closest('.tip-email-popup');var documentHeight=$(document).height();var placeToShow=documentHeight/20;var $scope=this.$scope;var alreadyShown=false;if($tipPopUp.length){$(window).scroll(function(){if(!alreadyShown&&$(document).scrollTop()>placeToShow){alreadyShown=true;$tipPopUp.css({bottom:'-1px',overflow:'visible'});_this2.$scope.attr('aria-hidden','false');Cog.fireEvent('analytics','tipbox.showTipBoxPopUp',{$target:$scope});}});}};EmailTipBox.prototype.submitEmail=function(){var $this=this.$scope;var self=this;var $form=$this.find('form');$form.submit(function(e){var email=self.$scope.find('input[type=email]').val();e.preventDefault();if(!email.length){self.displayErrorMessage(errorMessageEmptyMail);}else{self.sendApiRequest('/services/email-tip-box/subscribe',email);}
    $this.addClass('sending-in-progress');});};EmailTipBox.prototype.sendApiRequest=function(url,email){var self=this;$.ajaxSetup({type:'POST',url:url,dataType:'json',data:{email:email}});$.ajax({success:function success(data){var apiSuccess=data.success;var apiExistingUser=data.existing_user;self.parseApiData(apiSuccess,apiExistingUser);},error:function error(){}});};EmailTipBox.prototype.parseApiData=function(apiSuccess,apiExistingUser){switch(apiSuccess){case 0:switch(apiExistingUser){case 0:this.displayErrorMessage(errorMessageEmailError);break;case 1:this.displayErrorMessage(errorMessage);break;}
    break;case 1:switch(apiExistingUser){case 0:this.displaySuccessMessage(successMessage);this.removeTipBox();Cog.Cookie.create('tip','tip',90);break;case 1:this.displayErrorMessage(errorMessageSubscribed);break;}
    break;}};EmailTipBox.prototype.bindUIEvents=function(){this.$scope.find('.email-tip-box__input input[type=email], '+'.tip-box-general-inputs input[type=email], '+'.tip-box-main-inputs input[type=email]').on('focus',function(ev){Cog.fireEvent('analytics','tipbox.focusEmailAddress',{$target:$(ev.currentTarget)});});this.$scope.find('.email-tip-box__input,'+'.tip-box-general-inputs form, '+'.tip-box-main-inputs form').on('submit',function(ev){Cog.fireEvent('analytics','tipbox.submitEmailAddress',{$target:$(ev.currentTarget)});});};api.onRegister=function(scope){api.emailTipBox.push(new EmailTipBox(scope.$scope));};Cog.registerComponent({name:'email-tip-box',api:api,selector:'.email-tip-box, .tip-box-general-form, .tip-box-main-form'});})(Cog.jQuery());(function($){var api={};var visibleClass='visible';var $headerBottomMenu=$('.header-bottom-menu');api.hideMenuItems=function(){$headerBottomMenu.find('.menuItem>div').removeClass(visibleClass);};api.showMenuItem=function(item){$(item).find('~ div').addClass(visibleClass);};api.onRegister=function(){$headerBottomMenu.on('keyup',function(e){var $currentButton=$(e.target);var keyCode=e.keyCode||e.which;if(!$currentButton.parent().hasClass('menuItem'))return;if(keyCode===9){api.showMenuItem(e.target);}
if(keyCode===40){e.preventDefault();$currentButton.parent().find('.linksBlock a').eq(0).get(0).focus();}});$headerBottomMenu.on('keydown',function(e){var $currentButton=$(e.target);var keyCode=e.keyCode||e.which;if(!$currentButton.parent().hasClass('menuItem'))return;if(keyCode===9){api.hideMenuItems();}
if(keyCode===40){e.preventDefault();}});$headerBottomMenu.on('mouseleave',api.hideMenuItems);$(document).on('touchstart',function(e){if(!$(e.target).closest('.header-bottom-menu').length){api.hideMenuItems();}});};Cog.registerComponent({name:'megaMenuMainNavigation',api:api,selector:'.header-bottom-menu'});})(Cog.jQuery());(function($){var api={};var swipeHintHtml='<div class="swipeHint"><span></span></div>';var $mobileMenuContainer=$('.header-bottom-menu-mobile-version');api.toggleMobileMenu=function(element,$menuToggleButton){$menuToggleButton.click(function(){if(element.hasClass('searchExpanded')){element.removeClass('searchExpanded');element.parents('#header').find('.header-top-paragraph').slideUp(200);}
element.toggleClass('menuExpanded');});};api.toggleSearchBox=function(element,$searchToggleButton){$searchToggleButton.click(function(){if(element.hasClass('menuExpanded')){element.removeClass('menuExpanded');}
element.toggleClass('searchExpanded');element.parents('#header').find('.header-top-paragraph').slideToggle(200);});};api.ShowSwipeHand=function(){if(!Cog.Cookie.read('swipeHint')){$mobileMenuContainer.append(swipeHintHtml);Cog.Cookie.create('swipeHint','true',90);setTimeout(function(){$mobileMenuContainer.find('.swipeHint').animate({opacity:0},300,'linear',function(){$(this).remove();});},5000);}};api.turnOffLinksMobile=function(){var $mobileMenuLinks=$('.menuBar-desktop > ul > li .menuItem > a:nth-child(1)');if(Modernizr.touch){if(window.matchMedia('(min-width: 992px)').matches){$mobileMenuLinks.bind('click',function(e){e.preventDefault();});}else{$mobileMenuLinks.bind('click',function(){return true;});}}};api.onRegister=function(element){var $this=element.$scope;var $menuToggleButton=$this.find('.mobile-menu-toggle');var $searchToggleButton=$this.find('.mobile-menu-search');$('.mobile-menu-homepage a:nth-child(1)').attr('href','http://www.moneysavingexpert.com');api.toggleMobileMenu($this,$menuToggleButton);api.toggleSearchBox($this,$searchToggleButton);api.ShowSwipeHand();api.turnOffLinksMobile();$(window).on('resize',_.debounce(function(){api.turnOffLinksMobile();},150));};Cog.registerComponent({name:'megaMenuMobileVersion',api:api,selector:'.header-bottom-menu-mobile-version'});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={topNavMainLinks:'.top-nav-v2__links',topNavLinksVariant:'.top-nav-v2__links .richText',topNavLinkList:'.top-nav-v2__links ul',topNavLinks:'[class*="top-nav-v2__links-"]',moreBtn:'.top-nav-v2__moreButton > a'};var TopNav=function(){function TopNav($scope,status){_classCallCheck(this,TopNav);this.$scope=$scope;this.status=status;this.checkMenuVariant();}
TopNav.prototype.checkMenuVariant=function checkMenuVariant(){if(this.status.isAuthor()){return;}
    this.$topNavLinkVariant=this.$scope.find(selectors.topNavLinksVariant);this.topNavLinks=this.$scope.find(selectors.topNavLinks);if(this.$topNavLinkVariant.is(selectors.topNavLinks)){var classList=this.topNavLinks.attr('class').split(/\s+/);var className=classList.find(function(el){return el.match(/top-nav-v2__links-/gi);});var visibleLinksNum=className.substr(className.length-1);this.createSubmenu(visibleLinksNum);}else{this.createSubmenu(4);}};TopNav.prototype.createSubmenu=function createSubmenu(linksQuantity){this.$topNavLinkList=this.$scope.find(selectors.topNavLinkList);this.$topNavMainLinks=this.$scope.find(selectors.topNavMainLinks);var topNavLinks=this.$topNavLinkList.children();topNavLinks.each(function(idx,el){if(idx>linksQuantity-1&&idx<topNavLinks.length-1){$(el).addClass('top-nav-v2__moreItem').attr('role','menuitem');}});$('.top-nav-v2__moreItem').wrapAll('<ul class="top-nav-v2__moreList" />');$('.top-nav-v2__moreList').wrap('<li class="top-nav-v2__moreButton" role="menu" aria-haspopup="true" aria-expanded="false">\n                    <a href="#">More</a>\n                </li>');this.handleMoreButton();this.$topNavMainLinks.addClass('is-visible');};TopNav.prototype.handleMoreButton=function handleMoreButton(){var _this=this;this.$moreBtn=this.$scope.find(selectors.moreBtn);this.$moreBtn.on('click',function(evt){evt.preventDefault();var $el=$(evt.target).parent();var isExpanded=$el.attr('aria-expanded')==='true';$el.toggleClass('active').attr('aria-expanded',isExpanded?'false':'true');Cog.fireEvent('analytics','mobileTopnav.moreButtonClick',{target:evt.target,currentTarget:evt.currentTarget});});$(document).on('click',function(evt){if(!_this.$moreBtn.is($(evt.target))){_this.$moreBtn.parent().removeClass('active').attr('aria-expanded',false);}});};return TopNav;}();api.onRegister=function(scope){new TopNav(scope.$scope,this.external.status);};Cog.registerComponent({name:'Nav',api:api,selector:'.top-nav-v2',requires:[{name:'utils.status',apiId:'status'}]});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var selectors={topNavMobileWrapper:'.top-nav-v2-mobile-view',topNavMobileHamburgerImage:'.top-nav-v2-mobile-menu-open-image',topNavMobileCloseImage:'.top-nav-v2-mobile-menu-close-image',topNavMobileSearchToggleLink:'.top-nav-v2__search',topNavMobileToggleMenu:'.top-nav-v2-mobile-menu-toggle',topNavMobileToggleMenuOpen:'top-nav-v2-mobile-menu-toggle--open',topNavMobileLogoAnchor:'.top-nav-v2-mobile-logo-image-left a, .top-nav-v2-mobile-logo-mse a'};var TopNavMobile=function(){function TopNavMobile($element,status){_classCallCheck(this,TopNavMobile);this.$element=$element;this.status=status;this.bindUIElements();this.bindValues();this.bindUIEvents();}
TopNavMobile.prototype.bindUIElements=function bindUIElements(){this.$topNavMobileWrapper=this.$element;this.$topNavMobileHamburgerImage=this.$topNavMobileWrapper.find(selectors.topNavMobileHamburgerImage);this.$topNavMobileHamburgerLink=this.$topNavMobileHamburgerImage.find('a');this.$topNavMobileCloseImage=this.$topNavMobileWrapper.find(selectors.topNavMobileCloseImage);this.$topNavMobileCloseLink=this.$topNavMobileCloseImage.find('a');this.$topNavMobileLogoAnchor=this.$topNavMobileWrapper.find(selectors.topNavMobileLogoAnchor);};TopNavMobile.prototype.bindValues=function bindValues(){this.mobileTopNavSnippetName=!this.status.isAuthor()?this.$topNavMobileWrapper.closest('.snippetReference').attr('class').split(' ').filter(function(elem){return elem.indexOf('mobile')!==-1;}).toString():'';};TopNavMobile.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$topNavMobileHamburgerLink.on('click',function(ev){ev.preventDefault();var isHamburgerMenuOpen=true;_this.handleHamburgerMenuTracking(isHamburgerMenuOpen);});this.$topNavMobileCloseLink.on('click',function(ev){ev.preventDefault();var isHamburgerMenuOpen=false;_this.handleHamburgerMenuTracking(isHamburgerMenuOpen);});this.$topNavMobileLogoAnchor.on('click',function(ev){_this.handleLogoTracking(ev);});$(document).ready(function(){return $(selectors.topNavMobileHamburgerImage).show();});};TopNavMobile.prototype.handleLogoTracking=function handleLogoTracking(ev){var logoAnchorClicked=$(ev.currentTarget);var logoImageAltText=logoAnchorClicked.find('img').attr('alt');var logoHref=logoAnchorClicked.attr('href');Cog.fireEvent('analytics','mobileTopnav.logoClick',{actionType:'click',clickType:'internal',siteSection:'MastHead TopNav',itemIdentifier:logoImageAltText||'',internalDestination:logoHref,elementLayer1:'snippet '+this.mobileTopNavSnippetName,elementLayer2:'image',elementLayer3:undefined});};TopNavMobile.prototype.handleHamburgerMenuTracking=function handleHamburgerMenuTracking(isHamburgerMenuOpen){Cog.fireEvent('analytics','mobileTopnav.hamburgerMenuClick',{actionType:'click',clickType:'internal',siteSection:'MastHead TopNav',itemIdentifier:'Burger '+(isHamburgerMenuOpen?'Open':'Close'),elementLayer1:'snippet '+this.mobileTopNavSnippetName,elementLayer2:'button',elementLayer3:undefined});};return TopNavMobile;}();api.onRegister=function(scope){new TopNavMobile(scope.$scope,this.external.status);};Cog.registerComponent({name:'NavMobile',api:api,selector:'.top-nav-v2-mobile-view',requires:[{name:'utils.status',apiId:'status'}]});})(Cog.jQuery());(function($){var api={};var visibleClass='visible';var $topHeaderLinks=$('.top-header-links');var $forumLinkButton=$('.forum-link-button');var $headerTopNavItem=$('.header-top-navigation ul li');api.openTopLinks=function(){$topHeaderLinks.stop(true,true).slideToggle(300);$forumLinkButton.toggleClass('open');};api.handleNavDropdowns=function(element){var $visibleDropdown=$('ul.visible');var $element=$(element);if($visibleDropdown.length&&!$element.next('ul').hasClass(visibleClass)){$visibleDropdown.removeClass(visibleClass);$element.next('ul').addClass(visibleClass);}else{$element.next('ul').toggleClass(visibleClass);}};api.onRegister=function(){if($headerTopNavItem.find('ul')){$headerTopNavItem.find('ul').parent().addClass('has-children');}
$forumLinkButton.on('click',api.openTopLinks);$forumLinkButton.on('keyup',function(ev){if(ev.keyCode===13||ev.keyCode===32){api.openTopLinks();}});$('body').click(function(e){if($(e.target).is('li.has-children > a')){e.preventDefault();api.handleNavDropdowns(e.target);}else if(!$(e.target).is('ul.visible')){$('ul.visible').removeClass(visibleClass);}});};Cog.registerComponent({name:'topNavigation',api:api,selector:'.header-top-navigation'});})(Cog.jQuery());(function(){var api={};api.viewMoreTips=function($viewMoreButton,$tipsContainer){$viewMoreButton.click(function(){$tipsContainer.addClass('view-all-tips');this.remove();});};api.onRegister=function(element){var $this=element.$scope;var $viewMoreButton=$this.find('.tip-list__view-more');var $tipsContainer=$this.find('.tips-div ul');api.viewMoreTips($viewMoreButton,$tipsContainer);};Cog.registerComponent({name:'tipList',api:api,selector:'.tip-list-component'});})();(function($){var api={};var $searchForm=$('.form.error-page-form');var $searchInput=$('.error-page-form input[name="textField"]');var $mainSiteButton=$searchForm.find('input[value="mainSite"]');var $forumsButton=$searchForm.find('input[value="forums"]');api.handleSearchQuery=function(){var searchQuery=void 0;var inputValue=$searchInput.val();if($mainSiteButton.is(':checked')){searchQuery='https://www.moneysavingexpert.com/advanced-search.php?q='+inputValue+'&searchtype=guides';}else if($forumsButton.is(':checked')){searchQuery='http://forums.moneysavingexpert.com/search.php?q='+inputValue+'&searchid=174650582';}
window.location.href=searchQuery;};api.onRegister=function(){$searchForm.submit(function(e){e.preventDefault();api.handleSearchQuery();});};Cog.registerComponent({name:'errorPageForm',api:api,selector:'.error-page-form'});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var classes={isVisible:'is-visible',isHidden:'is-hidden',isActive:'is-active',linkNext:'link-next',linkPrev:'link-prev',iconClear:'icon-clear',iconSearch:'icon-search',searchForm:'search-header-form',searchInput:'search-header-input',resultsContainer:'st-results-container',searchTipsContainer:'search-no-result-container',browseInsteadContainer:'search-browse-instead-container',spellingSuggestionContainer:'st-spelling-suggestion',spellingSuggestionLink:'st-spelling-suggestion-link',filtersAllItem:'filters-all-item',filtersItem:'filters-item',filtersContainer:'search-header-filters',forumLink:'forum-link'};var SwiftypeSearch=function(){function SwiftypeSearch($element){_classCallCheck(this,SwiftypeSearch);this.$swiftSearch=$element;this.engineKey=this.$swiftSearch.data('engine-key');this.resultsPerPage=this.$swiftSearch.data('result-per-page');this.initialQuery='';this.bindUIElements();this.bindUIEvents();this.init();}
SwiftypeSearch.prototype.init=function init(){this.initializeTexts();this.initializeTemplates();this.initSwiftypeSearch();this.updateSearchValue();this.updateFiltersValue();this.handleSearchIcons();};SwiftypeSearch.prototype.bindUIElements=function bindUIElements(){this.$searchForm=this.$swiftSearch.find('.'+classes.searchForm);this.$searchInput=this.$searchForm.find('.'+classes.searchInput);this.$iconClear=this.$searchForm.find('.'+classes.iconClear);this.$iconSearch=this.$searchForm.find('.'+classes.iconSearch);this.$resultsContainer=this.$swiftSearch.find('#'+classes.resultsContainer);this.$searchTipsContainer=$('.'+classes.searchTipsContainer);this.$browseInsteadContainer=$('.'+classes.browseInsteadContainer);this.$spellingSuggestionContainer=$('.'+classes.spellingSuggestionContainer);this.$spellingSuggestionLink=$('.'+classes.spellingSuggestionLink);this.$window=$(window);this.$filtersAllItem=$('.'+classes.filtersAllItem);this.$filtersItem=$('.'+classes.filtersItem);this.filtersContainer=$('.'+classes.filtersContainer);this.$forumLink=$('.'+classes.forumLink);};SwiftypeSearch.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$iconClear.on('click keyup',function(ev){if(ev.type==='click'||ev.which===13){_this.$searchInput.val('');_this.$filtersAllItem.addClass(classes.isActive);_this.$filtersItem.removeClass(classes.isActive);_this.$forumLink.removeClass(classes.isVisible);_this.initialQuery='';_this.toggleSearchButtons();location.hash='';_this.$searchInput.data('filters','');}});this.$window.on('hashchange',function(){var params=$.hashParams();_this.initialQuery=params.stq;_this.activeFilters=params.stf?params.stf.split(','):[];_this.toggleSearchButtons();_this.showFilters();});this.$iconSearch.on('click keyup',function(ev){if(ev.type==='click'||ev.which===13){_this.$searchForm.trigger('submit');}});this.$searchForm.on('submit',function(){if(!_this.$searchInput.val()){_this.$forumLink.removeClass(classes.isVisible);}
    Cog.fireEvent('analytics','search.searchBoxSubmit',{actionType:'click',clickType:'pageAction',siteSection:'mainSection',elementLayer1:'swiftypeResults',elementLayer2:'searchBox',elementLayer3:'searchButton',searchTerm:_this.$searchInput.val()});});$(document).on('click','.'+classes.spellingSuggestionLink,function(){$('.'+classes.spellingSuggestionContainer).parent().remove();});this.$filtersItem.on('click keyup',function(ev){if(ev.type==='click'||ev.which===13){var $clickedFilter=$(ev.delegateTarget);var areFiltersSelected=false;$clickedFilter.toggleClass(classes.isActive);areFiltersSelected=_this.getFiltersStr().length>0;if(areFiltersSelected){_this.$filtersAllItem.removeClass(classes.isHidden).removeClass(classes.isActive);}else{_this.$filtersAllItem.addClass(classes.isActive);}
    _this.reloadResults();if(!$clickedFilter.hasClass(classes.isActive)){$clickedFilter.blur();}}});this.$filtersAllItem.on('click keyup',function(ev){if(ev.type==='click'||ev.which===13){_this.$filtersAllItem.addClass(classes.isActive);_this.$filtersItem.removeClass(classes.isActive);_this.reloadResults();}});this.$filtersAllItem.on('transitionend',function(){if(_this.$filtersAllItem.hasClass(classes.isActive)){_this.$filtersAllItem.addClass(classes.isHidden);}});};SwiftypeSearch.prototype.reloadResults=function reloadResults(){var params=$.hashParams();var filtersStr=this.getFiltersStr();this.$searchInput.data('filters',filtersStr);if(params.stq){Swiftype.setSearchHash(params.stq,params.stp,filtersStr);}};SwiftypeSearch.prototype.getFiltersStr=function getFiltersStr(){return $('.'+classes.filtersItem+'.'+classes.isActive).map(function(ind,obj){return encodeURIComponent($(obj).data('category'));}).get().toString();};SwiftypeSearch.prototype.initializeTexts=function initializeTexts(){this.texts={noResults:this.$swiftSearch.data('no-results')||'Sorry, we couldn’t find any results for "*{query}*"',spellingSuggestionNoResults:this.$swiftSearch.data('spelling-suggestion-no-results')||'There are no results for "*{query}*"',spellingSuggestion:this.$swiftSearch.data('spelling-suggestion')||'Showing results for "*{suggestion}*" instead',spellingSuggestionWithResults:this.$swiftSearch.data('spelling-suggestion-with-results')||'Did you mean: "*{suggestion}*"?',error:this.$swiftSearch.data('error')||'*Sorry!* Our search isn’t working. We’re hoping to have it up-and-running again soon.',forumLink:this.$forumLink.html()||''};};SwiftypeSearch.prototype.prepareHtmls=function prepareHtmls(searchQuery,spellingSuggestion){function replaceBold(str){return str.replace('*','<b>').replace('*','</b>');}
    function replaceSuggestion(str){return replaceBold(str).replace('{suggestion}','<a href="#" data-hash="true" class="st-spelling-suggestion-link" data-spelling-suggestion="'+spellingSuggestion+'">'+spellingSuggestion+'</a>');}
    function replaceQuery(str){return replaceBold(str).replace('{query}',searchQuery).replace('q=query','q='+searchQuery);}
    return{noResult:'\n                    <div class="st-no-results-container">\n                        <div id="st-no-results" class="st-no-results">\n                            '+replaceQuery(this.texts.noResults)+'\n                        </div>\n                    </div>',spellingSuggestionWithResults:'\n                    <div class="st-no-results-container">\n                        <div class="st-spelling-suggestion">\n                            '+replaceSuggestion(this.texts.spellingSuggestionWithResults)+'\n                        </div>\n                    </div>',spellingSuggestion:'\n                    <div class="st-no-results-container is-hidden">\n                        <div class="st-spelling-suggestion">\n                            <span>'+replaceQuery(this.texts.spellingSuggestionNoResults)+'</span>\n                            <p>'+replaceSuggestion(this.texts.spellingSuggestion)+'</p>\n                        </div>\n                    </div>',error:'\n                    <div class="st-no-results-container">\n                        <div class="st-no-results st-no-results-error">\n                            '+replaceBold(this.texts.error)+'\n                        </div>\n                    </div>',forumLink:replaceQuery(this.texts.forumLink)};};SwiftypeSearch.prototype.updateSearchValue=function updateSearchValue(){var currentQuery=Swiftype.currentQuery||'';this.$searchInput.val(currentQuery);};SwiftypeSearch.prototype.updateFiltersValue=function updateFiltersValue(){var params=$.hashParams();var filters=[];if(params.stf){filters=params.stf.split(',');this.$filtersAllItem.removeClass(classes.isActive).removeClass(classes.isHidden);this.$filtersItem.each(function(ind,obj){var $obj=$(obj);var category=$obj.data('category');if($.inArray(category,filters)!==-1){$obj.addClass(classes.isActive);}else{$obj.removeClass(classes.isActive);}});}else{this.$filtersAllItem.addClass(classes.isActive).addClass(classes.isHidden);this.$filtersItem.removeClass(classes.isActive);}
    var filtersStr=filters.map(encodeURIComponent).toString();this.$searchInput.data('filters',filtersStr);};SwiftypeSearch.prototype.handleSearchIcons=function handleSearchIcons(){var _this2=this;if(this.initialQuery.length){this.toggleSearchButtons();}
    this.$searchInput.on('change keyup',function(){_this2.toggleSearchButtons();});this.$searchInput.on('focus',function(){Cog.fireEvent('analytics','search.searchBoxFocus',{actionType:'textboxEntry',siteSection:'mainSection',elementLayer1:'swiftypeResults',elementLayer2:'searchInputText'});});};SwiftypeSearch.prototype.initializeTemplates=function initializeTemplates(){this.resultTemplate=Hogan.compile('\n                {{#headline}}\n                {{#url}}\n                <div class="search-result">\n                    <a href="{{ url }}">\n                        {{#image}}\n                        <img alt="{{ headline }} image" src="{{ image }}" />\n                        {{/image}}\n                        {{#headlineHighlight}}\n                        <h4 class="result-title"> {{{ headlineHighlight }}} </h4>\n                        {{/headlineHighlight}}\n                        <p class="result-description"> {{{ description }}} </p>\n                        <p class="result-category">\n                            {{#label}}\n                            <span class="result-category-label"> {{ label }}  </span>\n                            {{/label}}\n                            {{#hasDate}}\n                            <span class="result-date"> {{ date }} </span>\n                            {{/hasDate}}\n                        </p>\n                    </a>\n                </div>\n                {{/url}}\n                {{/headline}}');this.loadingTemplate='<div class="swiftype-loading">\n                   <div class="loading-spinner-container">\n                       <span class="loading-spinner"></span>\n                   </div>\n                </div>';this.pageLinkTemplate=Hogan.compile('<a href="#"\n                    class="page-link {{ cssClass }}"\n                    data-hash="true"\n                    aria-label="Goto Page {{ pageNumber }}"\n                    data-page="{{ pageNumber }}">{{ linkText }}</a>');};SwiftypeSearch.prototype.readFilters=function readFilters(){return{page:{category:this.activeFilters}};};SwiftypeSearch.prototype.initSwiftypeSearch=function initSwiftypeSearch(){this.$searchInput.swiftypeSearch({spelling:'always',fetchFields:{page:['headline','title','url','image','description','category','label','publication_date','publication_date_formatted']},filters:this.readFilters.bind(this),resultContainingElement:this.$resultsContainer,engineKey:this.engineKey,postRenderFunction:this.customPostRenderer.bind(this),loadingFunction:this.customLoadingFunction.bind(this),renderFunction:this.customRenderResults.bind(this),renderPaginationForType:this.customRenderPagination.bind(this),perPage:this.resultsPerPage,renderErrorFunction:this.renderErrorFunction.bind(this),timeout:15000});this.initialQuery=Swiftype.currentQuery||'';};SwiftypeSearch.prototype.showFilters=function showFilters(){if(window.location.hash){this.filtersContainer.removeClass('is-hidden');}else{this.filtersContainer.addClass('is-hidden');}};SwiftypeSearch.prototype.toggleSearchButtons=function toggleSearchButtons(){if(Swiftype.currentQuery&&Swiftype.currentQuery.length){var newSearchQuery=this.$searchInput.val();var isQueryChanged=newSearchQuery!==this.initialQuery;if(isQueryChanged){this.$iconClear.removeClass(classes.isVisible);this.$iconSearch.addClass(classes.isVisible);this.$iconClear.attr('tabindex','-1');this.$iconSearch.attr('tabindex','0');}else{this.$iconClear.addClass(classes.isVisible);this.$iconSearch.removeClass(classes.isVisible);this.$iconClear.attr('tabindex','0');this.$iconSearch.attr('tabindex','-1');}}};SwiftypeSearch.prototype.handleForumLink=function handleForumLink(htmls,visible){if(visible){this.$forumLink.html(htmls.forumLink);this.$forumLink.addClass(classes.isVisible);}else{this.$forumLink.removeClass(classes.isVisible);}};SwiftypeSearch.prototype.parseIsoDate=function parseIsoDate(date){var dateObj=new Date(date);var locale='en-us';var year=dateObj.getFullYear();var month=dateObj.toLocaleString(locale,{month:'short'});var dt=dateObj.getDate();return month+' '+dt+', '+year;};SwiftypeSearch.prototype.customRenderResults=function customRenderResults(documentType,item){var data={headline:item.headline||item.title,headlineHighlight:item.headline||item.title,url:item.url,image:item.category==='Deals'&&item.image,description:item.description,label:item.label,hasDate:item.publication_date_formatted||item.publication_date,date:item.publication_date_formatted||this.parseIsoDate(item.publication_date)};return this.resultTemplate.render(data);};SwiftypeSearch.prototype.customLoadingFunction=function customLoadingFunction(query,$resultContainer){$resultContainer.html(this.loadingTemplate);};SwiftypeSearch.prototype.customPostRenderer=function customPostRenderer(data){var totalResultCount=0;var spellingSuggestion=null;var searchQuery=void 0;var spellingContainerAlreadyApplied=void 0;if(this.$spellingContainer){this.$resultsContainer.prepend(this.$spellingContainer);this.$spellingContainer.removeClass(''+classes.isHidden);this.$spellingContainer=false;spellingContainerAlreadyApplied=true;}
    if(data.info&&data.info.page){searchQuery=this.escapeHtml(data.info.page.query);$.each(data.info,function(index,infoEl){totalResultCount+=infoEl.total_result_count;if(infoEl.spelling_suggestion){spellingSuggestion=infoEl.spelling_suggestion.text;}});}
    var htmls=this.prepareHtmls(searchQuery,spellingSuggestion);if(totalResultCount===0&&!spellingSuggestion){this.$resultsContainer.append(htmls.noResult);this.$searchTipsContainer.addClass(''+classes.isVisible);this.$browseInsteadContainer.addClass(''+classes.isVisible);}else if(totalResultCount===0&&spellingSuggestion){this.$searchTipsContainer.removeClass(''+classes.isVisible);this.$spellingContainer=$(htmls.spellingSuggestion);this.updateFiltersValue();Swiftype.setSearchHash(spellingSuggestion,1,this.getFiltersStr());}else if(totalResultCount&&spellingSuggestion&&!spellingContainerAlreadyApplied){this.$resultsContainer.prepend(htmls.spellingSuggestionWithResults);this.$searchTipsContainer.removeClass(''+classes.isVisible);}
    if(totalResultCount){this.$searchTipsContainer.removeClass(''+classes.isVisible);this.$browseInsteadContainer.removeClass(''+classes.isVisible);}
    this.handleForumLink(htmls,totalResultCount);this.updateSearchValue();this.updateFiltersValue();this.toggleSearchButtons();this.$searchInput.blur();Cog.fireEvent('analytics','search.searchResultsLoaded',{actionType:'resultsLoaded',searchTerm:searchQuery,filters:this.calculateFilters(),searchResultsNumber:totalResultCount});};SwiftypeSearch.prototype.calculateFilters=function calculateFilters(){var filters=[];if($.hashParams().stf){filters=$.hashParams().stf.split(',');}
    var results={};this.$filtersItem.each(function(ind,obj){var $obj=$(obj);var category=$obj.data('category');results[category]={label:$obj.text().trim(),active:$.inArray(category,filters)!==-1};});return results;};SwiftypeSearch.prototype.escapeHtml=function escapeHtml(query){if(_.isUndefined(query)){return '';}
    var lt=/</g;var gt=/>/g;var ap=/'/g;var ic=/"/g;return query.toString().replace(lt,'&lt;').replace(gt,'&gt;').replace(ap,'&#39;').replace(ic,'&#34;');};SwiftypeSearch.prototype.customRenderPagination=function customRenderPagination(type,currentPage,totalPages){if(totalPages<2){return false;}
    var paginationTemplate='<div class="swiftype-pagination-container"><div class="swiftype-pagination"><nav role="navigation" aria-label="Pagination">';var maxPageCount=100;var isLast=currentPage===totalPages||currentPage===maxPageCount;var isFirst=currentPage===1;var prevPage=currentPage-1;var nextPage=currentPage+1;var maxPagesCount=100;if(isLast&&!isFirst){paginationTemplate+=this.renderPageLink(prevPage,'Prev',classes.linkPrev);paginationTemplate+=this.renderPagesRange(currentPage-3,currentPage,totalPages,currentPage);}else if(!isFirst){paginationTemplate+=this.renderPageLink(prevPage,'Prev',classes.linkPrev);paginationTemplate+=this.renderPagesRange(prevPage,nextPage,totalPages,currentPage);}else{paginationTemplate+=this.renderPagesRange(currentPage,currentPage+3,totalPages,currentPage);}
    if(!isLast&&currentPage<=maxPagesCount&&totalPages>1){paginationTemplate+=this.renderPageLink(nextPage,'Next',classes.linkNext);}
    paginationTemplate+='</nav></div></div>';return paginationTemplate;};SwiftypeSearch.prototype.renderPagesRange=function renderPagesRange(startPage,endPage,totalPages,activePage){var pagesRange='';startPage=startPage>0?startPage:1;for(var page=startPage;page<=endPage&&page<=totalPages;page++){if(page===activePage){pagesRange+=this.renderPageLink(page,page,classes.isActive);}else{pagesRange+=this.renderPageLink(page);}}
    return pagesRange;};SwiftypeSearch.prototype.renderErrorFunction=function renderErrorFunction(){var htmls=this.prepareHtmls();this.$browseInsteadContainer.addClass(''+classes.isVisible);this.$resultsContainer.html(htmls.error);};SwiftypeSearch.prototype.renderPageLink=function renderPageLink(pageNumber){var linkText=arguments.length>1&&arguments[1]!==undefined?arguments[1]:pageNumber;var cssClass=arguments[2];var data={pageNumber:pageNumber,linkText:linkText,cssClass:cssClass};return this.pageLinkTemplate.render(data);};return SwiftypeSearch;}();api.onRegister=function(scope){new SwiftypeSearch(scope.$scope);};Cog.registerComponent({name:'swiftSearch',api:api,selector:'.swiftype-container'});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var names={searchInputName:'searchBox',searchOptionInputName:'searchOption'};var SwiftypeSearchBoxFrom=function(){function SwiftypeSearchBoxFrom($element){_classCallCheck(this,SwiftypeSearchBoxFrom);this.$swiftypeSearchBoxFrom=$element;this.bindUIElements();this.bindUIEvents();}
SwiftypeSearchBoxFrom.prototype.bindUIElements=function bindUIElements(){this.$searchInput=this.$swiftypeSearchBoxFrom.find('[name=\''+names.searchInputName+'\']');this.$searchOptions=this.$swiftypeSearchBoxFrom.find('[name=\''+names.searchOptionInputName+'\']');};SwiftypeSearchBoxFrom.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$swiftypeSearchBoxFrom.submit(function(ev){ev.preventDefault();var searchRedirectUrl=_this.$searchOptions.filter(':checked').val();var inputValue=_this.$searchInput.val();window.location.href=encodeURI(searchRedirectUrl.replace('%s',inputValue));});};return SwiftypeSearchBoxFrom;}();api.onRegister=function(scope){new SwiftypeSearchBoxFrom(scope.$scope);};Cog.registerComponent({name:'swiftypeSearchBoxForm',api:api,selector:'.swiftype-search-box-form'});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var selectors={styledSelect:'styled-select',selectOptions:'select-options',dataSelectedUrl:'data-selected-url',selectHidden:'select-hidden'};var NavigationSearchFormSelect=function(){function NavigationSearchFormSelect($element){_classCallCheck(this,NavigationSearchFormSelect);this.$formSelect=$element;this.initUIElements();this.bindUIEvents();}
NavigationSearchFormSelect.prototype.initUIElements=function initUIElements(){this.$formSelect.addClass(selectors.selectHidden);this.$formSelect.wrap('<div class="select"></div>');this.$formSelect.after('<div class="styled-select" tabindex="0"></div>');this.$styledSelect=this.$formSelect.next('.'+selectors.styledSelect);var $defaultOption=this.$formSelect.children('option').eq(0);this.$styledSelect.text($defaultOption.text());this.$styledSelect.attr(selectors.dataSelectedUrl,$defaultOption.val());this.$document=$(document);this.prepareFormValues();};NavigationSearchFormSelect.prototype.prepareFormValues=function prepareFormValues(){this.$list=$('<ul />',{class:'select-options'});var numberOfOptions=this.$formSelect.children('option').length;for(var i=0;i<numberOfOptions;i++){var option=this.$formSelect.children('option').eq(i);$('<li />',{text:option.text(),rel:option.val(),tabindex:0}).appendTo(this.$list);}
    this.$listItems=this.$list.children('li');this.$list.insertAfter(this.$styledSelect);};NavigationSearchFormSelect.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$styledSelect.click(function(ev){_this.enrollTheList(ev);});this.$listItems.click(function(ev){_this.updateSelectedOptionAndHideTheList(ev);});this.$document.click(function(){_this.hideTheList();});this.$styledSelect.on('keydown',function(ev){var keyCode=ev.keyCode||ev.which;if(keyCode===13){ev.preventDefault();_this.enrollTheList(ev);}
    if(keyCode===40){ev.preventDefault();_this.enrollTheList(ev);}});this.$listItems.on('keydown',function(ev){var keyCode=ev.keyCode||ev.which;if(keyCode===13){ev.preventDefault();_this.updateSelectedOptionAndHideTheList(ev);_this.$formSelect.closest('.selectField').siblings('.textField').find('input').focus();}
    if(keyCode===38){ev.preventDefault();$(ev.target).prev().focus();}
    if(keyCode===40){ev.preventDefault();$(ev.target).next().focus();}});};NavigationSearchFormSelect.prototype.enrollTheList=function enrollTheList(ev){ev.stopPropagation();var $clickedItem=$(ev.currentTarget);$('div.styled-select.active').not($clickedItem).each(function(){$clickedItem.removeClass('active').next('.'+selectors.selectOptions).hide();});$clickedItem.toggleClass('active').next('.'+selectors.selectOptions).toggleClass('active').fadeToggle('fast','linear');};NavigationSearchFormSelect.prototype.updateSelectedOptionAndHideTheList=function updateSelectedOptionAndHideTheList(ev){ev.stopPropagation();var $selectedOption=$(ev.currentTarget);this.$styledSelect.text($selectedOption.text()).removeClass('active');var selectedUrl=$selectedOption.attr('rel');this.$formSelect.val(selectedUrl);this.$styledSelect.attr(selectors.dataSelectedUrl,selectedUrl);this.$list.hide();};NavigationSearchFormSelect.prototype.hideTheList=function hideTheList(){this.$styledSelect.removeClass('active');this.$list.hide();};return NavigationSearchFormSelect;}();api.onRegister=function(scope){new NavigationSearchFormSelect(scope.$scope);};Cog.registerComponent({name:'navigationSearchSelect',api:api,selector:'.navigation-search select'});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var selectors={navigationSearchForm:'form.navigation-search',dataSelectedUrl:'data-selected-url'};var NavigationSearch=function(){function NavigationSearch($element){_classCallCheck(this,NavigationSearch);this.$searchForm=$element;this.bindUIElements();this.bindUIEvents();this.addFormAction();}
NavigationSearch.prototype.bindUIElements=function bindUIElements(){this.$body=$('body');this.$searchButton=this.$searchForm.find('button');this.$searchInput=this.$searchForm.find('input[name="textField"]');this.$formEl=this.$searchForm.find('form');this.$firstOption=this.$searchForm.find('.select-options li').eq(0);this.$styledSelect=this.$searchForm.find('.styled-select');};NavigationSearch.prototype.bindUIEvents=function bindUIEvents(){var _this=this;$(window).on('resize',_.debounce(function(){_this.clearSearchInput();},150));this.$searchInput.on('focus',function(){Cog.fireEvent('analytics','search.searchBoxFocus',{actionType:'textboxEntry',siteSection:'masthead',elementLayer1:'searchBox',elementLayer2:'searchInputText'});});this.$body.on('click',function(ev){return _this.handleFocusState(ev);});this.$body.on('focusin',function(ev){return _this.handleFocusState(ev);});this.$searchForm.on('submit',function(ev){ev.preventDefault();_this.handleSearchQuery();_this.clearSearchInput();});};NavigationSearch.prototype.handleFocusState=function handleFocusState(ev){if($(ev.target).parents().filter('.'+selectors.navigationSearchForm).length){if(!this.$searchForm.hasClass('focus')){this.$searchForm.addClass('focus');}}else{this.$searchForm.removeClass('focus');}};NavigationSearch.prototype.addFormAction=function addFormAction(){this.$formEl.attr('action','#');};NavigationSearch.prototype.handleSearchQuery=function handleSearchQuery(){var selectedUrl=this.$styledSelect.attr(selectors.dataSelectedUrl);var inputValue=this.$searchInput.val();function callback(){window.location.href=encodeURI(selectedUrl.replace('%s',inputValue));}
    Cog.fireEvent('analytics','search.searchBoxSubmit',{actionType:'click',clickType:'pageAction',siteSection:'masthead',elementLayer1:'searchBox',elementLayer2:'searchButton',elementLayer3:undefined,searchTerm:this.$searchInput.val(),filterLabel:this.$styledSelect.text(),callback:callback});setTimeout(callback,2000);};NavigationSearch.prototype.clearSearchInput=function clearSearchInput(){this.$searchInput.val('');this.$styledSelect.attr(selectors.dataSelectedUrl,this.$firstOption.attr('rel'));this.$styledSelect.text(this.$firstOption.text());};return NavigationSearch;}();api.onRegister=function(scope){new NavigationSearch(scope.$scope);};Cog.registerComponent({name:'navigationSearchBox',api:api,selector:'.navigation-search'});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var selectors={navigationSearchLink:'top-nav-v2__search',navigationMobileToggleLinkOpen:'top-nav-v2__search--open',navigationSearchForm:'form.navigation-search',navigationSeachContainer:'top-nav-v2-search-box',navigationSearchToggleClass:'top-nav-v2-search-box-open',searchResultsUrl:'search-results-url',topNavMobileWrapper:'.top-nav-v2-mobile-view',topNavWrapper:'.top-nav-v2'};var NavigationV2SearchForm=function(){function NavigationV2SearchForm($element){_classCallCheck(this,NavigationV2SearchForm);this.$searchForm=$element;this.bindUIElements();this.bindValues();this.bindUIEvents();this.addFormAction();this.makeAutocompleteOff();}
NavigationV2SearchForm.prototype.bindUIElements=function bindUIElements(){this.$body=$('body');this.$document=$(document);this.$searchToggleButton=this.$body.find('.'+selectors.navigationSearchLink).parent();this.$searchContainer=this.$body.find('.'+selectors.navigationSeachContainer);this.$formEl=this.$searchForm.find('form');this.$searchInput=this.$searchForm.find('input[name="search"]');this.$searchButton=this.$searchForm.find('button[type="submit"]');this.$searchCloseButton=this.$searchForm.find('button[type="button"]');this.$searchLink=this.$body.find('.'+selectors.navigationSearchLink);};NavigationV2SearchForm.prototype.bindValues=function bindValues(){this.isMobileNavVisible=null;};NavigationV2SearchForm.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$searchToggleButton.on('click',function(ev){ev.preventDefault();ev.stopImmediatePropagation();var $toggleButton=$(ev.target);var isSearchBarOpen=_this.handleFormVisibility();_this.isMobileNav($toggleButton);$toggleButton.toggleClass(selectors.navigationMobileToggleLinkOpen);Cog.fireEvent('analytics','search.searchBoxToggle',{actionType:'click',clickType:'pageAction',siteSection:(_this.isMobileNavVisible?'Mobile ':'')+'MastHead TopNav',itemIdentifier:''+(isSearchBarOpen?'Search Open':'Search Close'),elementLayer1:'snippetReference '+_this.getTopNavSnippetName($toggleButton),elementLayer2:'box '+(_this.isMobileNavVisible?selectors.topNavMobileWrapper:selectors.topNavWrapper),elementLayer3:'richText'});});this.$searchCloseButton.on('click',function(ev){ev.preventDefault();_this.handleFormVisibility();Cog.fireEvent('analytics','search.searchBoxClose',{actionType:'click',clickType:'pageAction',siteSection:'MastHead Search',itemIdentifier:'Close Icon',elementLayer1:'Search',elementLayer2:undefined,elementLayer3:undefined});});this.$searchForm.on('submit',function(ev){ev.preventDefault();_this.handleSearchQuery();_this.clearSearchInput();});this.$document.on('isMobile',this.handleSearchButton.bind(this));};NavigationV2SearchForm.prototype.getTopNavSnippetName=function getTopNavSnippetName($element){return $element.closest('.snippetReference').attr('class').split(' ').filter(function(elem){return elem.indexOf('v2')!==-1;}).toString();};NavigationV2SearchForm.prototype.isMobileNav=function isMobileNav($element){this.isMobileNavVisible=$element.closest(selectors.topNavMobileWrapper).length>0;};NavigationV2SearchForm.prototype.makeAutocompleteOff=function makeAutocompleteOff(){this.$searchInput.attr('autocomplete','off');};NavigationV2SearchForm.prototype.addFormAction=function addFormAction(){this.$formEl.attr('action','#');};NavigationV2SearchForm.prototype.clearSearchInput=function clearSearchInput(){this.$searchInput.val('');};NavigationV2SearchForm.prototype.handleFormVisibility=function handleFormVisibility(){var isOpen=false;this.$searchContainer.toggleClass(selectors.navigationSearchToggleClass);if(this.$searchContainer.hasClass(selectors.navigationSearchToggleClass)){this.$searchInput[0].focus();isOpen=true;}else{this.$searchToggleButton.focus();isOpen=false;}
    return isOpen;};NavigationV2SearchForm.prototype.handleSearchButton=function handleSearchButton(){if($('.'+selectors.navigationSearchToggleClass).length){this.$searchLink.addClass(selectors.navigationMobileToggleLinkOpen);}else this.$searchLink.removeClass(selectors.navigationMobileToggleLinkOpen);};NavigationV2SearchForm.prototype.handleSearchQuery=function handleSearchQuery(){var searchUrl=this.$formEl.find('[name='+selectors.searchResultsUrl+']').val();var searchInputValue=this.$searchInput.val();function callback(){var origin=window.location.protocol+'//'+window.location.host;window.location.href=encodeURI(origin+searchUrl.replace('&amp;','&').replace('%s',searchInputValue));}
    Cog.fireEvent('analytics','search.searchBoxSubmit',{actionType:'click',clickType:'pageAction',siteSection:(this.isMobileNavVisible?'Mobile ':'')+'MastHead Search',itemIdentifier:'Search Icon',elementLayer1:'Search',elementLayer2:undefined,elementLayer3:undefined,searchTerm:this.$searchInput.val(),filterLabel:'all',callback:callback});setTimeout(callback,1000);};return NavigationV2SearchForm;}();api.onRegister=function(scope){new NavigationV2SearchForm(scope.$scope);};Cog.registerComponent({name:'navigationV2SearchFrom',api:api,selector:'.navigation-search-v2'});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={content:'.component-content',closeButton:'.tooltip-button--close',toggleButton:'.toggle-button',tooltip:'.tooltip'};var classes={isExpanded:'is-expanded',isCollapsed:'is-collapsed-by-default'};var localStorageMap={affiliateLinkExplainer:{key:'affiliateLinkExplainer',value:'displayed'}};var AffiliateLinkExplainer=function(){function AffiliateLinkExplainer($element){_classCallCheck(this,AffiliateLinkExplainer);this.bindElements($element);this.bindEvents();this.checkIfShouldDsiplayTooltip();this.saveInformationInLocalStorage();}
AffiliateLinkExplainer.prototype.bindElements=function bindElements($element){this.$affiliateLinkExplainer=$element;this.$closeButton=this.$affiliateLinkExplainer.find(selectors.closeButton);this.$toggleButton=this.$affiliateLinkExplainer.find(selectors.toggleButton);this.$tooltip=this.$affiliateLinkExplainer.find(selectors.tooltip);};AffiliateLinkExplainer.prototype.bindEvents=function bindEvents(){this.tooltipToggleHandler=this.onTooltipToggle.bind(this);this.$toggleButton.on('click',this.tooltipToggleHandler);this.$closeButton.on('click',this.tooltipToggleHandler);};AffiliateLinkExplainer.prototype.checkIfShouldDsiplayTooltip=function checkIfShouldDsiplayTooltip(){var wasNotDisplayedBefore=!this.getInformationFromLocalStorage();var isCollapsedByDefault=this.$affiliateLinkExplainer.hasClass(classes.isCollapsed);var shouldDisplayTooltip=wasNotDisplayedBefore&&!isCollapsedByDefault;if(shouldDisplayTooltip){this.toggleTooltip();}
    this.setAdditionalAriaAttributes();};AffiliateLinkExplainer.prototype.toggleTooltip=function toggleTooltip(){this.$affiliateLinkExplainer.toggleClass(classes.isExpanded);this.setAdditionalAriaAttributes();};AffiliateLinkExplainer.prototype.setAdditionalAriaAttributes=function setAdditionalAriaAttributes(){var isExpanded=!!this.$affiliateLinkExplainer.hasClass(classes.isExpanded);this.$toggleButton.attr('aria-expanded',isExpanded);this.$tooltip.attr('aria-hidden',!isExpanded);};AffiliateLinkExplainer.prototype.getInformationFromLocalStorage=function getInformationFromLocalStorage(){var key=localStorageMap.affiliateLinkExplainer.key;return localStorage.getItem(key);};AffiliateLinkExplainer.prototype.saveInformationInLocalStorage=function saveInformationInLocalStorage(){var _localStorageMap$affi=localStorageMap.affiliateLinkExplainer,key=_localStorageMap$affi.key,value=_localStorageMap$affi.value;localStorage.setItem(key,value);};AffiliateLinkExplainer.prototype.onTooltipToggle=function onTooltipToggle(e){this.toggleTooltip();if(!this.$affiliateLinkExplainer.hasClass(classes.isExpanded)&&e.originalEvent.detail===0){this.$toggleButton.focus();}};return AffiliateLinkExplainer;}();api.onRegister=function(scope){new AffiliateLinkExplainer(scope.$scope);};Cog.registerComponent({name:'affiliateLinkExplainer',api:api,selector:'.affiliateLinkExplainer > .component-content'});})(Cog.jQuery());var _templateObject=_taggedTemplateLiteralLoose(['',''],['','']);function _taggedTemplateLiteralLoose(strings,raw){strings.raw=raw;return strings;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var classes={isHidden:'is-hidden',isSelected:'is-selected',selectorYear:'selector-year',selectorMonth:'selector-month',searchButton:'archive-search-button',martinsBlogRhs:'martins-blog-rhs',teamBlogRhs:'team-blog-rhs',dealsHuntersRhs:'deals-hunters-rhs'};var ArchiveSelector=function(){function ArchiveSelector($element){_classCallCheck(this,ArchiveSelector);this.$archiveSelector=$element;this.startYear=2005;this.currentYear=moment().year();this.blogRootPath=this.$archiveSelector.find('.blog-root-path').attr('href');this.bindUIElements();this.bindUIEvents();this.init();}
ArchiveSelector.prototype.init=function init(){this.handleStartingYear();this.fillInMonthDropdown();this.fillInYearDropdown();};ArchiveSelector.prototype.bindUIElements=function bindUIElements(){this.$form=this.$archiveSelector.find('form');this.$select=this.$archiveSelector.find('select');this.$allOptions=this.$select.find('option:not(.placeholder):selected');this.$selectorYear=this.$select.filter('.'+classes.selectorYear);this.$selectorMonth=this.$select.filter('.'+classes.selectorMonth);this.$searchButton=this.$archiveSelector.find('.'+classes.searchButton);};ArchiveSelector.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$select.on('change',function(ev){var $changedSelect=$(ev.currentTarget);var $options=$changedSelect.find('option:not(.placeholder):selected');_this.$allOptions=_this.$select.find('option:not(.placeholder):selected');if($options.length){$changedSelect.addClass(classes.isSelected);}else{_this.$searchButton.addClass(classes.isHidden);$changedSelect.removeClass(classes.isSelected);}
    if(_this.$allOptions.length){_this.$searchButton.removeClass(classes.isHidden);}else{_this.$searchButton.addClass(classes.isHidden);}});this.$form.on('submit',function(ev){ev.preventDefault();_this.constructRedirectUrl();});};ArchiveSelector.prototype.handleStartingYear=function handleStartingYear(){var configuredStartYear=parseInt(this.$archiveSelector.data('startingYear'),10);if(configuredStartYear>0){this.startYear=configuredStartYear;}};ArchiveSelector.prototype.fillInMonthDropdown=function fillInMonthDropdown(){var months=moment.months();var monthOptionTpl=function monthOptionTpl(literals,month){return '<option name="month">'+month+'</option>';};for(var month in months){var $option=$(monthOptionTpl(_templateObject,months[month]));this.$selectorMonth.append($option);}};ArchiveSelector.prototype.fillInYearDropdown=function fillInYearDropdown(){var yearOptionTpl=function yearOptionTpl(literals,year){return '<option name="year">'+year+'</option>';};for(var year=this.currentYear;year>=this.startYear;year--){var $option=$(yearOptionTpl(_templateObject,year));this.$selectorYear.append($option);}};ArchiveSelector.prototype.constructRedirectUrl=function constructRedirectUrl(){var selectedMonthOption=this.$selectorMonth.find('option:selected:not(.placeholder)').val();var selectedYear=this.$selectorYear.find('option:selected:not(.placeholder)').val();var selectedMonth='';var url='';if(_.isUndefined(selectedMonthOption)){selectedMonth='';}else{selectedMonth=moment().month(selectedMonthOption).format('MM');}
    if(_.isUndefined(selectedYear)){selectedYear=this.currentYear;}
    if(this.blogRootPath.indexOf('/',this.blogRootPath.length-1)===-1){this.blogRootPath=this.blogRootPath+'/';}
    url=''+this.blogRootPath+selectedYear+(selectedMonth?'/'+selectedMonth:'');window.location.href=url;};return ArchiveSelector;}();api.onRegister=function(scope){new ArchiveSelector(scope.$scope);};Cog.registerComponent({name:'archiveSelector',api:api,selector:'.archive-selector'});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var classes={activeFixedWidth:'table-fixed-width--active',cellClass:'span[class^="table-cell"]',cellWhite:'table-cell-white',cellGrey:'table-cell-grey',cellBlue:'table-cell-blue',cellOrange:'table-cell-orange',content:'component-content',firstColumn:'tr td:first-of-type',firstCellWithBlueBorderBottom:'table-cell-border-bottom:first',firstRow:'tbody > tr:first-of-type',fixedWidth:'table-fixed-width',hasImageRight:'has-image-right',hasImageLeft:'has-image-left',hasImage:'has-image',isOverflown:'table-scroll',row:'tr',swipeIcon:'table-swipe-icon',tableButton:'table-button',tableGuide:'table-guide',tableWithFixedColumn:'table-column-fixed',title:'table-title'};var Table=function(){function Table($element,media){_classCallCheck(this,Table);this.$table=$element;this.media=media;this.bindUIElements();this.bindUIEvents();this.init();}
Table.prototype.init=function init(){this.$table.find('table tr:even').addClass('even');this.moveSelectionStylesToCells();this.doesTableOverflow();};Table.prototype.bindUIElements=function bindUIElements(){this.$cells=this.$table.find('td, th');this.$selectionStyledEls=this.$table.find(''+classes.cellClass);this.$firstCol=this.$table.find(classes.firstColumn);this.$button=this.$table.find('.'+classes.tableButton);this.$window=$(window);};Table.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$button.on('click',function(ev){_this.openTableWindow(ev);});this.$window.on('resize',_.debounce(function(){_this.doesTableOverflow();}));Cog.addListener('table','check-overflow',this.doesTableOverflow,{scope:this});Cog.addListener('table','check-swipe-icon-position',this.initSwipeIcon,{scope:this});};Table.prototype.isMobile=function isMobile(){return this.$window.width()<768;};Table.prototype.openTableWindow=function openTableWindow(ev){var height=this.$window.height()/2;var width=this.$window.width()/2;var link=ev.target.href;window.open(link,'','menubar=1,resizable=1,scrollbars=1,width='+width+',height='+height);return false;};Table.prototype.moveSelectionStylesToCells=function moveSelectionStylesToCells(){this.$selectionStyledEls.each(function(idx,el){var $element=$(el);var $parent=$element.parent();var $cell=$element.closest('td, th');var classNames=$element.attr('class');if($element.text()==='TABLE_CELL_STYLE'){if($parent.is('td, th')){$element.hide();}else{$parent.hide();}}
    $cell.addClass(classNames);});this.$cells.each(function(idx,el){var $cell=$(el);var hasImage=$cell.find('img').length;var hasImageNext=$cell.find('a ~ img').length;var hasImagePrev=$cell.find('img ~ a').length;if(hasImageNext){$cell.addClass(classes.hasImageRight);}else if(hasImagePrev){$cell.addClass(classes.hasImageLeft);}else if(hasImage){$cell.addClass(classes.hasImage);}});};Table.prototype.doesTableOverflow=function doesTableOverflow(){this.setCellsHeight();var tableOverflows=this.$table.find('table')[0].scrollWidth>this.$table[0].clientWidth;if(this.$table.hasClass(classes.tableWithFixedColumn)&&this.isMobile()){tableOverflows=this.$table.find('table')[0].scrollWidth>this.$table[0].clientWidth-this.$firstCol.outerWidth();}
    if(tableOverflows){this.$table.addClass(classes.isOverflown);if(this.media.isMobileOrTablet()){this.initSwipeIcon();}}else{this.$table.removeClass(classes.isOverflown);}};Table.prototype.initSwipeIcon=function initSwipeIcon(){var $swipeIconElement=this.$table.find('.'+classes.swipeIcon);var $swipeIconTemplate=$('<span class="'+classes.swipeIcon+'"></span>');var $swipeIcon=$swipeIconElement.length!==0?$swipeIconElement:$swipeIconTemplate;var $tableContent=this.$table.find('.'+classes.content);var $tableTitle=this.$table.find('.'+classes.title).get(0);var $firstCellWithBlueBorderBottom=this.$table.find('td.'+classes.firstCellWithBlueBorderBottom+', th.'+classes.firstCellWithBlueBorderBottom).first();var firstRowWithBlueBorderBottomIdx=$firstCellWithBlueBorderBottom.attr('rowspan')-1||$firstCellWithBlueBorderBottom.closest(classes.row).index();var rowIdxToAttachSwipeIcon=firstRowWithBlueBorderBottomIdx>=0?firstRowWithBlueBorderBottomIdx:0;var $rowToAttachSwipeIcon=this.$table.find(classes.row).get(rowIdxToAttachSwipeIcon);var tableTitleHeight=$tableTitle?$tableTitle.clientHeight:0;var rowWithBlueBorderBottomHeight=$rowToAttachSwipeIcon?$rowToAttachSwipeIcon.clientHeight+$rowToAttachSwipeIcon.offsetTop:0;var topPosition=tableTitleHeight+rowWithBlueBorderBottomHeight-12;$swipeIcon.css({top:topPosition});if($swipeIconElement.length===0){$tableContent.prepend($swipeIconTemplate);}};Table.prototype.setCellsHeight=function setCellsHeight(){var isGuide=this.$table.is('.'+classes.tableGuide);if(isGuide&&this.isMobile()){var isFixedWidth=this.$table.is('.'+classes.fixedWidth);var isFixedColumn=this.$table.is('.'+classes.tableWithFixedColumn);if(isFixedWidth){this.$table.addClass(classes.activeFixedWidth);}
    if(isFixedColumn){var $cells=this.$table.find('tr > td:first-of-type');$cells.each(function(id,cell){var siblingsHeight=cell.nextElementSibling.offsetHeight;var thisHeight=cell.offsetHeight;if(thisHeight<siblingsHeight){cell.style.height=siblingsHeight+'px';}else{cell.nextElementSibling.style.height=thisHeight+'px';}});}}};return Table;}();api.onRegister=function(scope){new Table(scope.$scope,this.external.media);};Cog.registerComponent({name:'table',api:api,selector:'.table',requires:[{name:'utils.media',apiId:'media'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var classes={isActive:'is-active',listOpener:'az-list-opener',azList:'az-list-content'};var AZList=function(){function AZList($element){_classCallCheck(this,AZList);this.$azListContainer=$element;this.bindUIElements();this.bindUIEvents();}
AZList.prototype.bindUIElements=function bindUIElements(){this.$listOpener=this.$azListContainer.find('.'+classes.listOpener);this.$azList=this.$azListContainer.find('.'+classes.azList);};AZList.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$listOpener.on('click',function(){_this.toggleList();});};AZList.prototype.toggleList=function toggleList(){this.$azList.toggleClass(classes.isActive);this.$listOpener.toggleClass(classes.isActive);};return AZList;}();api.onRegister=function(scope){new AZList(scope.$scope);};Cog.registerComponent({name:'AZList',api:api,selector:'.a-z-list'});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var selectors={azListNav:'az-list-nav',azListContent:'az-list-content',azListWrapper:'az-list-wrapper',azListDivider:'az-list-divider',azListTitle:'az-list-title',isFixed:'is-fixed',navAnchors:'a[href*=\\#]'};var values={bottom:null,navHeight:null,scrollTop:null,scopeOffsetTop:null,listHeight:null,isMobile:null,prevWidth:null,contentHeight:null};var AzListNew=function(){function AzListNew($scope){_classCallCheck(this,AzListNew);this.$scope=$scope;this.init();}
AzListNew.prototype.init=function init(){this.isMobileCheck();this.bindElements();this.setValues();this.attachScroll();this.attachResize();this.attachClick();if(values.isMobile){this.setMobileNavigationMaxHeight();this.setValues();this.stickNav();}else{this.stickTitlebar();}};AzListNew.prototype.isMobileCheck=function isMobileCheck(){values.isMobile=window.matchMedia('screen and (max-width: 767px)').matches;};AzListNew.prototype.bindElements=function bindElements(){this.$azListTitle=this.$scope.find('.'+selectors.azListTitle);this.$azListWrapper=this.$azListTitle.find('.'+selectors.azListWrapper);this.$azListDivider=this.$azListTitle.find('.'+selectors.azListDivider);this.$azListNav=this.$azListWrapper.find('.'+selectors.azListNav);this.$azListContent=this.$scope.find('.'+selectors.azListContent);this.$navAnchors=this.$azListNav.find(selectors.navAnchors);};AzListNew.prototype.setValues=function setValues(){this.setNavHeight();this.setScopeOffsetTop();this.setListHeight();this.setScrollTop();this.setBottom();this.setWindowWidth();this.setContentHeight();};AzListNew.prototype.setWindowWidth=function setWindowWidth(){values.prevWidth=$(window).width();};AzListNew.prototype.setBottom=function setBottom(){values.bottom=values.isMobile?this.$azListContent.offset().top+this.$azListContent.outerHeight(true)-values.listHeight:this.$scope.offset().top+this.$azListContent.outerHeight(true);};AzListNew.prototype.setContentHeight=function setContentHeight(){values.contentHeight=this.$azListContent.height();};AzListNew.prototype.setListHeight=function setListHeight(){values.listHeight=this.$azListNav.height();};AzListNew.prototype.setNavHeight=function setNavHeight(){values.navHeight=this.$azListWrapper.height();};AzListNew.prototype.setScrollTop=function setScrollTop(){values.scrollTop=$(document).scrollTop();};AzListNew.prototype.setScopeOffsetTop=function setScopeOffsetTop(){values.scopeOffsetTop=values.isMobile?this.$azListContent.offset().top:this.$scope.offset().top;};AzListNew.prototype.stickTitlebar=function stickTitlebar(){if(values.scrollTop>values.scopeOffsetTop&&values.scrollTop<values.bottom){this.$azListWrapper.addClass(selectors.isFixed).css({top:0});this.$azListDivider.css({'padding-bottom':values.navHeight});}else if(values.scrollTop>values.scopeOffsetTop&&values.scrollTop>values.bottom){this.$azListWrapper.addClass(selectors.isFixed).css({top:-(values.scrollTop-values.bottom)});}else if(values.scrollTop<values.scopeOffsetTop){this.$azListWrapper.removeClass(selectors.isFixed);this.$azListDivider.css({'padding-bottom':0});}};AzListNew.prototype.stickNav=function stickNav(){if(values.scrollTop>values.scopeOffsetTop&&values.scrollTop<values.bottom){this.$azListNav.addClass(selectors.isFixed).css({top:0});}else if(values.scrollTop>values.scopeOffsetTop&&values.scrollTop>values.bottom){this.$azListNav.addClass(selectors.isFixed).css({top:-(values.scrollTop-values.bottom)});}else if(values.scrollTop<values.scopeOffsetTop){this.$azListNav.removeClass(selectors.isFixed).css({top:values.navHeight});}};AzListNew.prototype.setMobileNavigationMaxHeight=function setMobileNavigationMaxHeight(){if(values.contentHeight<values.listHeight){this.$azListNav.css({'max-height':values.contentHeight});}else{this.$azListNav.css({'max-height':'100vh'});}};AzListNew.prototype.attachScroll=function attachScroll(){var _this=this;$(document).on('scroll',function(){_this.setScrollTop();_this.setScopeOffsetTop();_this.isMobileCheck();_this.setBottom();if(values.isMobile===false){_this.stickTitlebar();}else{_this.stickNav();}});};AzListNew.prototype.attachResize=function attachResize(){var _this2=this;$(window).on('resize',_.debounce(function(){if(values.prevWidth===$(window).width()){return;}
    _this2.isMobileCheck();_this2.setValues();if(values.isMobile){_this2.setMobileNavigationMaxHeight();_this2.$azListDivider.css({'padding-bottom':0});_this2.$azListWrapper.removeClass(selectors.isFixed).css({top:0});_this2.$azListNav.removeClass(selectors.isFixed).css({top:values.navHeight});}else{_this2.$azListNav.removeClass(selectors.isFixed).css({top:0});}},250));};AzListNew.prototype.attachClick=function attachClick(){this.$navAnchors.on('click',function(event){event.preventDefault();var $element=$(document.getElementById(event.target.hash.substring(1)));$('html,body').animate({scrollTop:$element.offset().top},500);});};return AzListNew;}();api.onRegister=function(scope){new AzListNew(scope.$scope);};Cog.registerComponent({name:'AzListNew',selector:'.newAzlist',api:api});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var selectors={articleListItem:'.articleList-article',articleListTitle:'.articleList-title a',articleListDescription:'.articleList-description'};var RelatedArticles=function(){function RelatedArticles($scope){_classCallCheck(this,RelatedArticles);this.$scope=$scope;this.init();}
RelatedArticles.prototype.init=function init(){var $articles=this.$scope.find(selectors.articleListItem);var titleMaxLength=50;var firstDescriptionMaxLength=1000;var nextDescriptionMaxLength=1000;if(this.$scope.hasClass('deals-hunters-blogs')){titleMaxLength=80;}
    if(this.$scope.hasClass('category-news-list')){titleMaxLength=25;}
    if(this.$scope.hasClass('featured-news-list')){firstDescriptionMaxLength=163;nextDescriptionMaxLength=82;}
    this.addTitleAttr($articles,selectors.articleListTitle);this.setLength($articles,selectors.articleListTitle,titleMaxLength,titleMaxLength);this.setLength($articles,selectors.articleListDescription,firstDescriptionMaxLength,nextDescriptionMaxLength);};RelatedArticles.prototype.addTitleAttr=function addTitleAttr($elements,selector){$elements.each(function(i,element){var $element=$(element).find(selector);var text=$element.text();$element.attr('title',text);});};RelatedArticles.prototype.setLength=function setLength($elements,selector,firstMaxLength,nextMaxLength){var _this=this;$elements.each(function(i,element){var $element=$(element).find(selector);var text=$element.text();var maxLength=i===0?firstMaxLength:nextMaxLength;var cuttedText=_this.cutString(text,maxLength);$element.html(cuttedText);});};RelatedArticles.prototype.cutString=function cutString(string,length){var cut=string.indexOf(' ',length);if(cut===-1){return string;}
    if(string.length<length){return string;}
    return string.substring(0,cut)+'\u2026';};return RelatedArticles;}();api.onRegister=function(scope){new RelatedArticles(scope.$scope);};Cog.registerComponent({name:'relatedArticles',selector:'.related-articles, .rhs-recent-blogs, .deals-hunters-blogs, .category-news-list, .featured-news-list',api:api});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var classes={flipButton:'.button-fullinfo'};var DealPredictor=function(){function DealPredictor($element){_classCallCheck(this,DealPredictor);this.$dealPredictor=$element;this.bindUIElements();this.bindUIEvents();}
DealPredictor.prototype.bindUIElements=function bindUIElements(){this.$flipButton=this.$dealPredictor.find(classes.flipButton);};DealPredictor.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$flipButton.on('click',function(){_this.$dealPredictor.toggleClass('flip');return false;});};return DealPredictor;}();api.onRegister=function(scope){new DealPredictor(scope.$scope);};Cog.registerComponent({name:'dealPredictor',api:api,selector:'.dealPredictor'});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var classes={prevButton:'.flex-prev',nextButton:'.flex-next',slides:'.slides',dealCards:'.dealPredictor',dealPagination:'.deal-pagination>a',weekHeader:'.week-title'};var DealPredictorWeek=function(){function DealPredictorWeek($element){_classCallCheck(this,DealPredictorWeek);this.$dealPredictorWeek=$element;this.bindUIElements();this.bindUIEvents();}
DealPredictorWeek.prototype.bindUIElements=function bindUIElements(){this.$prevButton=this.$dealPredictorWeek.find(classes.prevButton);this.$nextButton=this.$dealPredictorWeek.find(classes.nextButton);this.$slides=this.$dealPredictorWeek.find(classes.slides);this.$dealPagination=this.$dealPredictorWeek.find(classes.dealPagination);this.$dealCards=this.$dealPredictorWeek.find(classes.dealCards);this.$weekHeader=$(this.$dealPredictorWeek.find(classes.weekHeader)[0]);};DealPredictorWeek.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$dealsNumber=this.$dealCards.length;this.$currentDeal=0;$(this.$dealPagination[this.$currentDeal]).addClass('active-slide');this.$prevButton.on('click',function(){_this.goPrev();return false;});this.$nextButton.on('click',function(){_this.goNext();return false;});this.$dealPagination.each(function(i,item){$(item).on('click',function(){_this.goToPage(i,item);return false;});});this.$hammer=new Hammer(this.$slides[0],{enable:true,velocity:0.1,threshold:2});this.$hammer.on('swipeleft',function(){_this.goNext();});this.$hammer.on('swiperight',function(){_this.goPrev();});this.goToDealAnchor();};DealPredictorWeek.prototype.goPrev=function goPrev(){var scrollTo=this.$currentDeal;if(scrollTo>0){scrollTo--;}else{scrollTo=this.$dealsNumber-1;this.$slides.css('left',this.$dealsNumber*-100+'%');}
    this.goToPage(scrollTo,$(this.$dealPagination[scrollTo]));return false;};DealPredictorWeek.prototype.goNext=function goNext(){var scrollTo=this.$currentDeal;if(scrollTo<this.$dealsNumber-1){scrollTo++;}else{scrollTo=0;this.$slides.css('left','100%');}
    this.goToPage(scrollTo,$(this.$dealPagination[scrollTo]));return false;};DealPredictorWeek.prototype.goToPage=function goToPage(i,item){$(this.$dealPagination[this.$currentDeal]).removeClass('active-slide');$(item).addClass('active-slide');this.$currentDeal=i;var newOffset=this.$currentDeal*-100;this.$slides.css('left',newOffset+'%');return false;};DealPredictorWeek.prototype.goToDealAnchor=function goToDealAnchor(){if(this.$weekHeader.data('currentweek')&&!window.location.hash){window.location.hash='#'+this.$weekHeader.attr('id');}
    if(window.location.hash&&window.location.hash.startsWith('#deal-')){var $dealAnchored=this.$dealPredictorWeek.find('[name=\''+window.location.hash.replace('#','')+'\']');if($dealAnchored.length===1){var scrollTo=$($dealAnchored[0]).closest('.dealPredictor').index();if(scrollTo>0&&scrollTo<this.$dealCards.length){this.$dealPredictorWeek.find('.flexslider').scrollLeft(0);this.goToPage(scrollTo,$(this.$dealPagination[scrollTo]));}}}};return DealPredictorWeek;}();api.onRegister=function(scope){new DealPredictorWeek(scope.$scope);};Cog.registerComponent({name:'dealPredictorWeek',api:api,selector:'.dealPredictorWeek'});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var selectors={mainContentSectionContainer:'main-content-section'};var Utils=function(){function Utils(){_classCallCheck(this,Utils);this.init();}
Utils.prototype.init=function init(){var $elements=$('.'+selectors.mainContentSectionContainer);this.resetEmptySpacing($elements);};Utils.prototype.resetEmptySpacing=function resetEmptySpacing($elements){$elements.each(function(idx,element){var $element=$(element);if($element.children().length===0){$element.addClass('reset-margin');}});};return Utils;}();api.init=function(){new Utils();};Cog.registerStatic({name:'utils',api:api});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var selectors={sliderContainer:'> .component-content > .content',slidesElements:'.product-box-compact-container > .content > .box'};var classes={slickInitialized:'slick-initialized'};var Slider=function(){function Slider($element,media){_classCallCheck(this,Slider);this.$slider=$element;this.media=media;this.bindUiElements();this.bindUIEvents();this.initSlider();}
Slider.prototype.bindUiElements=function bindUiElements(){this.$sliderContainer=this.$slider.find(selectors.sliderContainer);this.$slidesElements=this.$sliderContainer.find(selectors.slidesElements);};Slider.prototype.checkViewport=function checkViewport(){if(this.media.isMobile()&&!this.$sliderContainer.hasClass(classes.slickInitialized)){this.initSlider();}};Slider.prototype.makeSliderElementsEqualHeight=function makeSliderElementsEqualHeight(){var heights=[];this.$slidesElements.each(function(index,slide){var $slideElement=$(slide);$slideElement.css('height','');heights.push($slideElement.outerHeight());});var maxHeight=Math.max.apply(Math,heights);if(this.media.isMobile()){this.$slidesElements.css('height',maxHeight);}};Slider.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$sliderContainer.on('init',function(){return _this.makeSliderElementsEqualHeight();});$(window).on('resize',_.debounce(function(){_this.checkViewport();_this.makeSliderElementsEqualHeight();},150));};Slider.prototype.initSlider=function initSlider(){this.$sliderContainer.slick({dots:true,vertical:false,slide:'.section',slidesToShow:1,infinite:false,variableWidth:true,mobileFirst:true,centerPadding:'20%',responsive:[{breakpoint:767,settings:'unslick'}]});};return Slider;}();api.onRegister=function(scope){new Slider(scope.$scope,this.external.media);};Cog.registerComponent({name:'Slider',api:api,selector:'.slider:not(.cq-Editable-dom)',requires:[{name:'utils.media',apiId:'media'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var selectors={dealsCompactList:'dealsCompactList-list',dealsCompactListHomepage:'deals-compact-list-homepage',dealsCompactListCategoryPage:'deals-compact-list-category-page',dealsCompactListTopDeals:'deals-compact-list-top-deals',dealsCompactListUncutText:'deals-compact-list-uncut-text',listTitle:'dealsCompactList-link-title',listDescription:'dealsCompactList-link-description',listConfig:'deals-count.config'};var DealsCompactList=function(){function DealsCompactList($scope,media){_classCallCheck(this,DealsCompactList);this.$scope=$scope;this.media=media;this.init();this.bindUIEvents();}
DealsCompactList.prototype.init=function init(){var $listDescription=this.$scope.find('.'+selectors.listDescription);var $listTitle=this.$scope.find('.'+selectors.listTitle);var descriptionMaxLength=25;var titleMaxLength=15;if((this.$scope.hasClass(selectors.dealsCompactListHomepage)||this.$scope.hasClass(selectors.dealsCompactListCategoryPage)||this.$scope.hasClass(selectors.dealsCompactListTopDeals))&&!this.$scope.hasClass(selectors.dealsCompactListUncutText)){this.setTextLength($listTitle,titleMaxLength);this.setTextLength($listDescription,descriptionMaxLength);}
    if(this.$scope.hasClass(selectors.dealsCompactListHomepage)||this.$scope.hasClass(selectors.dealsCompactListCategoryPage)){this.setListMinHeight();}};DealsCompactList.prototype.bindUIEvents=function bindUIEvents(){var _this=this;$(window).on('resize',_.debounce(function(){if(_this.$scope.hasClass(selectors.dealsCompactListHomepage)||_this.$scope.hasClass(selectors.dealsCompactListCategoryPage)){_this.setListMinHeight();}},150));};DealsCompactList.prototype.setTextLength=function setTextLength($text,textMaxLength){var _this2=this;var textString=void 0;var cutText=void 0;$text.each(function(i,element){var $element=$(element);textString=$element.text();cutText=_this2.cutString(textString,textMaxLength);$element.html(cutText);});};DealsCompactList.prototype.cutString=function cutString(string,length){var cut=string.indexOf(' ',length);if(cut===-1){return string;}if(string.length<length){return string;}
    return string.substring(0,cut)+'\u2026';};DealsCompactList.prototype.setListMinHeight=function setListMinHeight(){var $dealsCompactList=this.$scope.find('.'+selectors.dealsCompactList);var maxCount=this.$scope.find('.'+selectors.listConfig).data('items-limit');var elemHeight=108;var listHeight=maxCount*elemHeight;if(this.media.isMobile()){$dealsCompactList.height('');}else{$dealsCompactList.height(listHeight);}};return DealsCompactList;}();api.onRegister=function(scope){new DealsCompactList(scope.$scope,this.external.media);};Cog.registerComponent({name:'dealsCompactList',selector:'.dealsCompactList',api:api,requires:[{name:'utils.media',apiId:'media'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var classes={overlayLink:'product-box-overlay-link',productBoxFullContainer:'product-box-full-container',productBoxCompactContainer:'product-box-compact-container',overlayContainer:'product-box-overlay-container',overlayContent:'product-box-overlay-content',overlayContentInner:'product-box-overlay-content-inner',overlayClose:'product-box-overlay-close',overlayBackground:'product-box-overlay-background',overlayVisible:'product-box-overlay-visible',isVisible:'is-visible',isHidden:'is-hidden'};var ProductBox=function(){function ProductBox($element){_classCallCheck(this,ProductBox);this.$productBox=$element;this.$productBoxContainer=this.$productBox.find('> .compact');this.bindUIElements();this.bindUIEvents();this.buildOverlay();}
ProductBox.prototype.bindUIElements=function bindUIElements(){this.$body=$('body');this.$document=$(document);this.$productBoxOverlayLink=this.$productBox.find('.'+classes.overlayLink);this.$productBoxFullContainer=this.$productBoxOverlayLink.closest('.'+classes.productBoxCompactContainer).siblings('.'+classes.productBoxFullContainer);this.$overlayBackground={};this.$overlayContainer={};this.$overlayContentInner={};};ProductBox.prototype.bindUIEvents=function bindUIEvents(){var _this=this;this.$productBoxOverlayLink.on('click',function(ev){ev.preventDefault();ev.stopPropagation();_this.showOverlay();});this.$document.on('click touchstart','.'+classes.overlayContent,function(ev){ev.stopPropagation();});this.$document.on('click touchstart','.'+classes.overlayBackground+', .'+classes.overlayContainer+', .'+classes.overlayClose,function(){if(_this.isVisible){_this.hideOverlay();}});this.$document.on('keydown',function(ev){if(ev.keyCode===27){_this.hideOverlay();}});};ProductBox.prototype.buildOverlay=function buildOverlay(){this.$productBoxFullContainer.addClass(''+classes.overlayContentInner).removeClass(classes.isHidden);this.$productBoxContainer.append(function(){return '<div class="'+classes.overlayBackground+'" style="display: none;"></div>\n                       <div class="'+classes.overlayContainer+'" style="display: none;">\n                            <div class="'+classes.overlayContent+' lightbox--default-size">\n                                <div tabindex="0" class="'+classes.overlayClose+'" style="display: block;"></div>\n                            </div>\n                       </div>';});this.$overlayContainer=this.$productBox.find('.'+classes.overlayContainer);this.$overlayContent=this.$productBox.find('.'+classes.overlayContent);this.$overlayBackground=this.$productBox.find('.'+classes.overlayBackground);this.$productBoxFullContainer.appendTo(this.$overlayContent);};ProductBox.prototype.showOverlay=function showOverlay(){this.isVisible=true;this.scrollPosition=$(window).scrollTop();this.$body.addClass(classes.overlayVisible);this.$overlayContainer.fadeIn();this.$overlayBackground.fadeIn();this.$overlayContainer.css({top:'50px'});};ProductBox.prototype.hideOverlay=function hideOverlay(){var _this2=this;this.$overlayContainer.fadeOut();this.$overlayBackground.fadeOut();if(this.isVisible){this.isVisible=false;setTimeout(function(){_this2.$body.removeClass(classes.overlayVisible);},400);}
    $('.container-fluid').off('scroll');$(window).scrollTop(this.scrollPosition);};return ProductBox;}();api.onRegister=function(scope){new ProductBox(scope.$scope);};Cog.registerComponent({name:'ProductBox',api:api,selector:'.productBox'});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={calculatorsAndNews:'.promoBox > .calculators-and-news',promoBoxItem:'.promoBoxItem > .component-content',promoBoxEmpty:'.promoBoxItem:not(:has(>div))'};var CalculatorsAndNews=function(){function CalculatorsAndNews($scope,status){_classCallCheck(this,CalculatorsAndNews);this.$scope=$scope;this.status=status;this.init();}
CalculatorsAndNews.prototype.init=function init(){if(this.status.isEdit()){return;}
    this.removeEmptyBoxes();var items=this.$scope.find(selectors.promoBoxItem).length;if(items===3){this.$scope.addClass('has-three-items');}else if(items===2){this.$scope.addClass('has-two-items');}else if(items<2){this.$scope.parent().remove();}};CalculatorsAndNews.prototype.removeEmptyBoxes=function removeEmptyBoxes(){this.$scope.find(selectors.promoBoxEmpty).remove();};return CalculatorsAndNews;}();api.onRegister=function(scope){new CalculatorsAndNews(scope.$scope,this.external.status);};Cog.registerComponent({name:'calculatorsAndNews',selector:selectors.calculatorsAndNews,api:api,requires:[{name:'utils.status',apiId:'status'}]});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={promoboxTitle:'.promobox-title, .promobox-title a, .promobox-title p',promoboxDescription:'.promobox-description'};var classes={clamped:'clamped',initialized:'initialized'};var desiredLines=3;var maxLines=2;var PromoBoxContentClamping=function(){function PromoBoxContentClamping($element,promoBoxSection){_classCallCheck(this,PromoBoxContentClamping);this.$scope=$element;this.promoBoxSection=promoBoxSection;this.init();}
PromoBoxContentClamping.prototype.init=function init(){this.bindElements();this.clampIt();};PromoBoxContentClamping.prototype.bindElements=function bindElements(){this.$title=this.$scope.find(selectors.promoboxTitle);this.$description=this.$scope.find(selectors.promoboxDescription);this.titleLineHeight=parseInt(this.$title.css('line-height'),10);this.descriptionLineHeight=parseInt(this.$description.css('line-height'),10);this.titleLines=this.$title.height()/this.titleLineHeight;this.descriptionLines=this.$description.height()/this.descriptionLineHeight;};PromoBoxContentClamping.prototype.addClampedProps=function addClampedProps($elem,lines){$elem.addClass(classes.clamped);$elem.css({'-webkit-line-clamp':lines.toString()});};PromoBoxContentClamping.prototype.clampIt=function clampIt(){if(this.promoBoxSection.isSection(this.$scope)){var linesLeft=desiredLines;if(this.titleLines>=maxLines){this.addClampedProps(this.$title,maxLines);linesLeft-=maxLines;if(this.descriptionLines>=linesLeft){this.addClampedProps(this.$description,linesLeft);}}else if(this.descriptionLines>=maxLines){this.addClampedProps(this.$description,maxLines);}else{this.$scope.removeClass(classes.initialized);}}else{if(this.titleLines>=desiredLines){this.$elementToBeClamped=this.$title.find('a');this.lineClampValue=desiredLines;}else if(this.titleLines+this.descriptionLines>=desiredLines){this.$elementToBeClamped=this.$description;this.lineClampValue=desiredLines-this.titleLines;}
    if(this.$elementToBeClamped&&this.lineClampValue){this.$elementToBeClamped.addClass(classes.clamped);this.$elementToBeClamped.css({'-webkit-line-clamp':this.lineClampValue.toString()});}else{this.$scope.removeClass(classes.initialized);}}};return PromoBoxContentClamping;}();api.onRegister=function(scope){new PromoBoxContentClamping(scope.$scope,this.external.promoBoxSection);};Cog.registerComponent({name:'PromoBoxContentClamping',api:api,selector:'.promobox-content-standard',requires:[{name:'utils.promoBoxSection',apiId:'promoBoxSection'}]});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={contentCointainer:'promobox-content-hero',promoboxTitleVariations:'.promobox-title, .promobox-title a, .promobox-title p',promoboxTitle:'promobox-title',promoboxDescription:'promobox-description'};var classes={clamped:'clamped'};var maxVisibleTitleLines=3;var PromoBoxHeroContentClamping=function(){function PromoBoxHeroContentClamping($element,status,promoBoxSection){_classCallCheck(this,PromoBoxHeroContentClamping);this.$scope=$element;this.status=status;this.promoBoxSection=promoBoxSection;this.init();}
PromoBoxHeroContentClamping.prototype.init=function init(){if(this.promoBoxSection.isSectionHero(this.$scope)&&!this.status.isAuthor()){this.bindElements();this.clampTitle();this.clampDescription();this.watchWindowResize();}};PromoBoxHeroContentClamping.prototype.bindElements=function bindElements(){this.$window=$(window);this.$titleTag=this.$scope.find('.'+selectors.promoboxTitle);this.$title=this.$scope.find(selectors.promoboxTitleVariations);this.$description=this.$scope.find('.'+selectors.promoboxDescription);this.preservedTitle=$(this.$title[this.$title.length-1]).html().trim();};PromoBoxHeroContentClamping.prototype.clampTitle=function clampTitle(){var $title=$(this.$title[this.$title.length-1]);var lineHeight=parseInt($title.css('line-height'),10);var availableSpace=lineHeight*maxVisibleTitleLines;var titleSplitToSingleWords=this.preservedTitle.split(' ');if(this.$titleTag.height()>availableSpace||this.$titleTag.height()/availableSpace<1){$title.text('');var currentShortenedTitle='';var shortenedTitleWordBefore='';for(var i=0;i<titleSplitToSingleWords.length;i++){if(this.$titleTag.height()>availableSpace){$title.html(shortenedTitleWordBefore.trim()+'&hellip;');break;}
    shortenedTitleWordBefore=currentShortenedTitle;currentShortenedTitle+=titleSplitToSingleWords[i]+' ';$title.html(currentShortenedTitle.trim()+'&hellip;');}
    if(this.$titleTag.height()>availableSpace){$title.html(shortenedTitleWordBefore.trim()+'&hellip;');}
    var currentTitle=$title.html().trim();if(this.preservedTitle.split(' ').length===currentTitle.split(' ').length&&currentTitle.slice(-1)==='\u2026'){$title.html(currentTitle.slice(0,-1));}}};PromoBoxHeroContentClamping.prototype.clampDescription=function clampDescription(){var $description=this.$description;if(this.$description.length>1){this.$description.each(function(i,elem){if($(elem).is('.text, .large')){$description=$(elem);}});}
    var textToCheckLineHeight=$description;var elementMarginBottom=0;var listItems=$description.find('li');var paragraphs=$description.find('p');if(listItems.length){var listItem=$(listItems[0]);elementMarginBottom=parseInt(listItem.css('margin-bottom'),10);textToCheckLineHeight=listItem.find('a');}else if(paragraphs.length){var paragraph=$(paragraphs[0]);elementMarginBottom=parseInt(paragraph.css('margin-bottom'),10);textToCheckLineHeight=paragraph.find('a');}
    var titleMarginTop=parseInt(this.$title.css('margin-top'),10);var titleMarginBottom=parseInt(this.$title.css('margin-bottom'),10);var titleFullHeight=this.$title.height()+titleMarginBottom+titleMarginTop;var leftSpace=this.$scope.parent().height()-titleFullHeight;var descLineHeight=parseInt(textToCheckLineHeight.css('line-height'),10);var descriptionLines=Math.floor((leftSpace+elementMarginBottom)/(descLineHeight+elementMarginBottom));$description.addClass(classes.clamped);$description.css({'-webkit-line-clamp':descriptionLines.toString()});};PromoBoxHeroContentClamping.prototype.watchWindowResize=function watchWindowResize(){var _this=this;this.$window.resize(function(){_this.clampTitle();_this.clampDescription();});};return PromoBoxHeroContentClamping;}();api.onRegister=function(scope){new PromoBoxHeroContentClamping(scope.$scope,this.external.status,this.external.promoBoxSection);};Cog.registerComponent({name:'PromoBoxHeroContentClamping',api:api,selector:'.promobox-content-hero',requires:[{name:'utils.status',apiId:'status'},{name:'utils.promoBoxSection',apiId:'promoBoxSection'}]});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={promoboxItem:'.promoBoxItem',promoboxTitle:'.promobox-title',promoboxImage:'.promobox-image',lhsAccordion:'.accordion.guide-side-column-dropdown',lhsAccordionTitle:'.accordion-title-text'};var PromoBoxLeftHandSide=function(){function PromoBoxLeftHandSide($element){_classCallCheck(this,PromoBoxLeftHandSide);this.$scope=$element;this.init();}
PromoBoxLeftHandSide.prototype.init=function init(){this.bindElements();this.handleTracking();};PromoBoxLeftHandSide.prototype.bindElements=function bindElements(){this.$promoboxItem=this.$scope.find(selectors.promoboxItem);this.$titleLink=this.$promoboxItem.find(selectors.promoboxTitle).parent();this.$imageLink=this.$promoboxItem.find(selectors.promoboxImage+' > a');};PromoBoxLeftHandSide.prototype.handleTracking=function handleTracking(){var _this=this;this.$titleLink.add(this.$imageLink).on('click',function(event){var $target=$(event.target);var $currentTarget=$(event.currentTarget);Cog.fireEvent('analytics','promoBoxLeftHandSide.linkClick',{$target:$target,$currentTarget:$currentTarget,elementLayer1:_this.getAccordionTitle($target),elementLayer2:'Links',elementLayer3:'link',elementLayer4:_this.getPromoboxItemIndex($target),itemIdentifier:$target.text()||_this.getPromoboxItemTitle($target),href:$currentTarget.attr('href')});});};PromoBoxLeftHandSide.prototype.getAccordionTitle=function getAccordionTitle($childElement){return $childElement.closest(selectors.lhsAccordion).find(selectors.lhsAccordionTitle).text();};PromoBoxLeftHandSide.prototype.getPromoboxItemIndex=function getPromoboxItemIndex($childElement){return $childElement.closest(selectors.promoboxItem).index();};PromoBoxLeftHandSide.prototype.getPromoboxItemTitle=function getPromoboxItemTitle($img){return $img.closest(selectors.promoboxItem).find(selectors.promoboxTitle).text();};return PromoBoxLeftHandSide;}();api.onRegister=function(scope){new PromoBoxLeftHandSide(scope.$scope);};Cog.registerComponent({name:'PromoBoxLeftHandSide',api:api,selector:'.promoBox > .left-hand-sidebar'});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var DealsAffiLinks=function(){function DealsAffiLinks($element){_classCallCheck(this,DealsAffiLinks);this.$links=$element.find('.deals-link-intro p:last');this.$intro=$element.find('.deals-link-intro');this.$config=document.getElementsByClassName('config');this.addLinks();}
DealsAffiLinks.prototype.addLinks=function addLinks(){if(this.$config.length>0){var items=JSON.parse(this.$config[0].getAttribute('data-list-config'));if(items&&items.length>0){this.$intro.removeClass('is-hidden');for(var i=0;i<items.length;i++){if(items[i].nonaffiliateLink){this.$links.append('<a href=\''+items[i].nonaffiliateLink+'\' target=\''+items[i].nonaffiliateLinkTarget+'\'>'+items[i].nonaffiliateLinkText+'</a> ');}}}}};return DealsAffiLinks;}();api.onRegister=function(scope){new DealsAffiLinks(scope.$scope);};Cog.registerComponent({name:'dealsAffiLinks',api:api,selector:'.deals-affilated-links'});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var DealsCounter=function(){function DealsCounter(){_classCallCheck(this,DealsCounter);$(document).ready(this.init);}
DealsCounter.prototype.init=function init(){var count=0;$('.deals-count.config').each(function(i,val){var currentCount=parseInt($(val).data('count'),10)||0;count+=currentCount;});var currentDeals=count===1?' Current Deal':' Current Deals';$('.deals_counter').html(count+currentDeals);};return DealsCounter;}();api.init=function(){new DealsCounter();};Cog.registerStatic({name:'dealsCounter',api:api});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var constants={expiryInMinutes:20*60*1000};var classes={trendingItems:'trending-items',trendingConfig:'trending-config'};var Trending=function(){function Trending($element,status){_classCallCheck(this,Trending);this.$trendingContainer=$element;this.status=status;this.bindData();this.bindEvents();}
Trending.prototype.bindData=function bindData(){this.$trendingItems=this.$trendingContainer.find('.'+classes.trendingItems);this.$trendingConfig=this.$trendingItems.find('.'+classes.trendingConfig);this.$ol=this.$trendingItems.find('ol');this.items=this.$trendingConfig.data('json').items;this.itemTemplate=this.$trendingItems.find('script').html().trim();};Trending.prototype.bindEvents=function bindEvents(){$(document).ready(this.print.bind(this));};Trending.prototype.print=function print(){var _this=this;$.each(this.getItems(),function(i,it){_this.$ol.append($(_this.itemTemplate.replace('$path',it.path).replace('$title',it.title)));});Cog.fireEvent('most-popular','loaded');};Trending.prototype.getItems=function getItems(){if(this.status.isAuthor()){return this.items;}
    var trending=JSON.parse(window.sessionStorage.getItem('trending'));var dateNow=new Date().getTime();var dateExpiresAt=dateNow+constants.expiryInMinutes;if(trending&&trending.items&&trending.expiresAt>dateNow){this.items=trending.items;}else{window.sessionStorage.setItem('trending',JSON.stringify({expiresAt:dateExpiresAt,items:this.items}));}
    return this.items;};return Trending;}();api.onRegister=function(scope){new Trending(scope.$scope,this.external.status);};Cog.registerComponent({name:'Trending',api:api,selector:'.trending',requires:[{name:'utils.status',apiId:'status'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={dealsPriorityList:'.dealsPriorityList',dealsPriorityListTitle:'.dealsPriorityList-link-title'};var DealsPriorityList=function(){function DealsPriorityList($scope){_classCallCheck(this,DealsPriorityList);this.$scope=$scope;this.init();}
DealsPriorityList.prototype.init=function init(){var $titles=this.$scope.find(selectors.dealsPriorityListTitle);var titleMaxLength=42;this.setLength($titles,titleMaxLength);};DealsPriorityList.prototype.setLength=function setLength($elements,maxLength){var _this=this;$elements.each(function(i,element){var $element=$(element);var text=$element.text();var cutText=_this.cutString(text,maxLength);$element.html(cutText);});};DealsPriorityList.prototype.cutString=function cutString(string,length){var cut=string.indexOf(' ',length);if(cut===-1){return string;}
    if(string.length<=length){return string;}
    return string.substring(0,cut)+'\u2026';};return DealsPriorityList;}();api.onRegister=function(scope){new DealsPriorityList(scope.$scope);};Cog.registerComponent({name:'dealsPriorityList',selector:selectors.dealsPriorityList,api:api});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var classes={isActive:'is-active'};var selectors={tickerContainer:'.feed-provider-feeds',tweet:'.twitter-feed'};var constants={mobileTickerAutoScrollingStep:1,mobileTickerAutoScrollingSpeed:15,desktopTickerAutoSwitchSpeed:8000};var TwitterTicker=function(){function TwitterTicker($element,media){_classCallCheck(this,TwitterTicker);this.$ticker=$element;this.media=media;this.isMobileLayout=this.media.isMobileOrTablet();this.mobileMouseOverHandler=this.onMobileMouseOver.bind(this);this.mobileMouseOutHandler=this.onMobileMouseOut.bind(this);this.desktopMouseOverHandler=this.onDesktopMouseOver.bind(this);this.desktopMouseOutHandler=this.onDesktopMouseOut.bind(this);this.desktopTransitionEndHandler=this.onDesktopTransitionEnd.bind(this);this.bindUiElements();this.init();}
TwitterTicker.prototype.init=function init(){var _this=this;Cog.addListener('twitter','feedsLoaded',function(){_this.initTicker();_this.showAdditionButtons();_this.bindResizeHandler();},{scope:this});};TwitterTicker.prototype.initTicker=function initTicker(){this.$tweets=this.$tickerContainer.find(selectors.tweet);if(this.isMobileLayout){if(this.isDesktopTickerInitialized){this.destroyDesktopTicker();}
    if(this.$tweets.length>0){this.initMobileTicker();}}else{if(this.isMobileTickerInitialized){this.destroyMobileTicker();}
    if(this.$tweets.length>0){this.initDesktopTicker();}}};TwitterTicker.prototype.initDesktopTicker=function initDesktopTicker(){this.$tickerContainer.find('.'+classes.isActive).removeClass(classes.isActive);this.tweetsCount=this.$tweets.length;var initialTweetIdx=0;var $initialTweet=this.$tweets.eq(initialTweetIdx).addClass(classes.isActive);this.$currentTweet=$initialTweet;this.changeTweetOnDesktop($initialTweet,initialTweetIdx,this.tweetsCount);this.isDesktopTickerInitialized=true;};TwitterTicker.prototype.initMobileTicker=function initMobileTicker(){this.destroyDesktopTicker();this.$tickerContainer.smoothDivScroll({autoScrollingMode:'always',autoScrollingDirection:'endlessLoopRight',autoScrollingStep:constants.mobileTickerAutoScrollingStep,autoScrollingInterval:constants.mobileTickerAutoScrollingSpeed});this.$tickerContainer.smoothDivScroll('startAutoScrolling');this.bindMobileEvents();this.isMobileTickerInitialized=true;};TwitterTicker.prototype.destroyDesktopTicker=function destroyDesktopTicker(){this.unbindDesktopEvents();clearTimeout(this.tweetChangeTimer);this.isDesktopTickerInitialized=false;};TwitterTicker.prototype.destroyMobileTicker=function destroyMobileTicker(){this.$tickerContainer.smoothDivScroll('destroy');this.unbindMobileEvents();this.isMobileTickerInitialized=false;};TwitterTicker.prototype.bindUiElements=function bindUiElements(){this.$tickerContainer=this.$ticker.find(selectors.tickerContainer);};TwitterTicker.prototype.changeTweetOnDesktop=function changeTweetOnDesktop($currentTweet,tweetIdx,tweetsCount){var _this2=this;this.unbindDesktopEvents();if(!this.ismouseOver&&$currentTweet){this.tweetChangeTimer=setTimeout(function(){$currentTweet.on('transitionend',_this2.desktopTransitionEndHandler);$currentTweet.removeClass(classes.isActive);_this2.nextTweetIdx=tweetIdx+1<tweetsCount?tweetIdx+1:0;_this2.$currentTweet=_this2.$tweets.eq(_this2.nextTweetIdx);},constants.desktopTickerAutoSwitchSpeed);}
    this.bindDesktopEvents();};TwitterTicker.prototype.showAdditionButtons=function showAdditionButtons(){var additionalData=this.$ticker.find('>.component-content')[0].dataset;var twitterIcon='<span class="twitter-ticker-icon"></span>';var followUsCta='<a class="twitter-ticker-cta" href="'+additionalData.followUsUrl+'">'+additionalData.followUsLinklabel+'</a>';this.$tickerContainer.before(twitterIcon);this.$tickerContainer.after(followUsCta);};TwitterTicker.prototype.onMobileMouseOver=function onMobileMouseOver(){if(!('ontouchstart'in window)){this.$tickerContainer.smoothDivScroll('stopAutoScrolling');}};TwitterTicker.prototype.onDesktopMouseOver=function onDesktopMouseOver(){this.ismouseOver=true;if(this.$currentTweet&&this.$currentTweet.hasClass('is-active')){clearTimeout(this.tweetChangeTimer);}};TwitterTicker.prototype.onDesktopMouseOut=function onDesktopMouseOut(){this.ismouseOver=false;this.changeTweetOnDesktop(this.$currentTweet,this.nextTweetIdx,this.tweetsCount);};TwitterTicker.prototype.onDesktopTransitionEnd=function onDesktopTransitionEnd(){this.$currentTweet.off('transitionend',this.desktopTransitionEndHandler);this.$currentTweet.addClass(classes.isActive);this.changeTweetOnDesktop(this.$currentTweet,this.nextTweetIdx,this.tweetsCount);};TwitterTicker.prototype.onMobileMouseOut=function onMobileMouseOut(){this.$tickerContainer.smoothDivScroll('startAutoScrolling');};TwitterTicker.prototype.bindResizeHandler=function bindResizeHandler(){var _this3=this;$(window).on('resize',_.debounce(function(){var isLayoutChanged=_this3.isMobileLayout!==_this3.media.isMobileOrTablet();_this3.isMobileLayout=_this3.media.isMobileOrTablet();if(isLayoutChanged){_this3.initTicker();}},250));};TwitterTicker.prototype.bindMobileEvents=function bindMobileEvents(){this.$tickerContainer.on('mouseover',this.mobileMouseOverHandler);this.$tickerContainer.on('mouseout',this.mobileMouseOutHandler);};TwitterTicker.prototype.bindDesktopEvents=function bindDesktopEvents(){this.$tickerContainer.on('mouseover',this.desktopMouseOverHandler);this.$tickerContainer.on('mouseout',this.desktopMouseOutHandler);};TwitterTicker.prototype.unbindMobileEvents=function unbindMobileEvents(){this.$tickerContainer.off('mouseover',this.mobileMouseOverHandler);this.$tickerContainer.off('mouseout',this.mobileMouseOutHandler);};TwitterTicker.prototype.unbindDesktopEvents=function unbindDesktopEvents(){this.$tickerContainer.off('mouseover',this.desktopMouseOverHandler);this.$tickerContainer.off('mouseout',this.desktopMouseOutHandler);};return TwitterTicker;}();api.onRegister=function(scope){new TwitterTicker(scope.$scope,this.external.media);};Cog.registerComponent({name:'TwitterTicker',api:api,selector:'.twitter-ticker',requires:[{name:'utils.media',apiId:'media'}]});})(Cog.jQuery());(function($){var api={};var selectors={embeddedTweet:'embeddedTweet'};api.goToHash=function(){var currentHash=window.location.hash;var $scrollToElement=$(currentHash);if(!$scrollToElement.length)return;var scrollPosition=$scrollToElement.offset().top;$('html, body').stop().animate({scrollTop:scrollPosition},800);};api.bindEvents=function(){if(typeof window.twttr.events!=='undefined'){window.twttr.events.bind('loaded',api.goToHash);}else{window.twttr.ready(function(){window.twttr.events.bind('loaded',api.goToHash);});}};api.loadWidgetsJs=function(){window.twttr=function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs");api.bindEvents();};api.init=function(){var $embeddedTweet=$('.'+selectors.embeddedTweet);if($embeddedTweet.length){api.loadWidgetsJs();}};Cog.registerStatic({name:'embedded-tweet',api:api});})(Cog.jQuery());(function(){var api={};api.onRegister=function(scope){if(!this.external.status.isEdit()&&scope.$scope.text().trim()===''){scope.$scope.remove();}};Cog.registerComponent({name:'expirableBox',api:api,selector:'.expirableBox',requires:[{name:'utils.status',apiId:'status'}]});})();(function(){var api={};var textMaxLength=25;var initialTipBoxHeight=210;var $seeMoreElement=$('.tip-box-general-expand');var $tipBoxScrollElement=$('.tip-box-general-scroll ul');api.isMobile=function(){return window.matchMedia('screen and (max-width: 767px)').matches;};api.resetTipBoxScrollHeight=function(){$tipBoxScrollElement.attr('style','');$seeMoreElement.removeClass('is-expanded');};api.cutString=function(string,length){var cut=string.indexOf(' ',length);if(cut===-1){return string;}
if(string.length<=length){return string;}
return string.substring(0,cut)+'\u2026';};api.parseParagraphs=function($elements){if(api.isMobile()){return;}
$elements.each(function(index,element){var trimmedText=api.cutString(element.innerText,textMaxLength);element.innerText=trimmedText;});};api.handleExpandClick=function(ev){var fullTipBoxHeight=$tipBoxScrollElement.get(0).scrollHeight;var currentHeight=$tipBoxScrollElement.height();var desiredHeight=fullTipBoxHeight===currentHeight?initialTipBoxHeight:fullTipBoxHeight;var $target=$(ev.target);$tipBoxScrollElement.animate({height:desiredHeight},500);$seeMoreElement.toggleClass('is-expanded');Cog.fireEvent('analytics','clickable.click',{$target:$target,href:'#see-more'});};api.bindEvents=function($elements){$seeMoreElement.find('div').click(api.handleExpandClick);$(window).on('resize',_.debounce(function(){api.resetTipBoxScrollHeight();api.parseParagraphs($elements);},150));};api.onRegister=function(element){var $this=element.$scope;var $elements=$this.find('.tip-box-general-scroll .trim-text');api.parseParagraphs($elements);api.bindEvents($elements);};Cog.registerComponent({name:'tipListBoxGeneral',api:api,selector:'.tip-box-general'});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var initialTipBoxHomeHeight=310;var selectors={componentSelector:'tipListBox',tipListBoxRHS:'tipListBox-rhs',scrollList:'tip-box-main-scroll',tipList:'tip-box-main-list',expandLinksWrapper:'tip-box-main-expand',showMoreLink:'tip-box-main-expand-more',showLessLink:'tip-box-main-expand-less',listExpandedClass:'is-expanded',listElements:'tip-box-main-list-item',hiddenClass:'hidden'};var TipListBoxMain=function(){function TipListBoxMain($scope,media){_classCallCheck(this,TipListBoxMain);this.$scope=$scope;this.media=media;this.bindElements();this.overrideTitles();this.changeEmailFormPosition(this.$scope);this.bindEvents(this.$scope);}
TipListBoxMain.prototype.bindElements=function bindElements(){this.$window=$(window);this.$expandLinksWrapper=this.$scope.find('.'+selectors.expandLinksWrapper);this.$scrollList=this.$scope.find('.'+selectors.scrollList);this.$tipList=this.$scrollList.find('.'+selectors.tipList);this.$listElements=this.$tipList.find('.'+selectors.listElements);this.initialTipBoxHeight=this.isRHS()?this.$tipList.height():initialTipBoxHomeHeight;this.itemsOnStart=this.isRHS()?4:3;};TipListBoxMain.prototype.bindEvents=function bindEvents(){this.toggleListElements(this.itemsOnStart);this.watchWindowResize();this.toggleList();};TipListBoxMain.prototype.watchWindowResize=function watchWindowResize(){var _this=this;var windowWidth=this.$window.width();this.$window.on('resize',_.debounce(function(){var resizedWindowWidth=_this.$window.width();if(resizedWindowWidth!==windowWidth){_this.changeEmailFormPosition(_this.$scope);_this.resetTipBoxScrollHeight();_this.initialTipBoxHeight=_this.isRHS()?_this.$tipList.height():initialTipBoxHomeHeight;windowWidth=resizedWindowWidth;}},150));};TipListBoxMain.prototype.isRHS=function isRHS(){return this.$scope.parents('.'+selectors.tipListBoxRHS).length;};TipListBoxMain.prototype.resetTipBoxScrollHeight=function resetTipBoxScrollHeight(){this.$tipList.attr('style','');this.$expandLinksWrapper.removeClass('is-expanded');};TipListBoxMain.prototype.toggleList=function toggleList(){var _this2=this;this.$expandLinksWrapper.find('a').on('click',function(e){e.preventDefault();var $target=$(e.target);var $link=$(e.currentTarget);var ifShowMore=$link.parent().hasClass(selectors.showMoreLink);_this2.$expandLinksWrapper.toggleClass(selectors.listExpandedClass);_this2.toggleListElements(_this2.itemsOnStart);var fullTipListHeight=_this2.$tipList.get(0).scrollHeight;var desiredHeight=ifShowMore?fullTipListHeight:_this2.initialTipBoxHeight;_this2.$tipList.animate({height:desiredHeight},500);Cog.fireEvent('analytics','clickable.click',{$target:$target,href:'#see-more'});});};TipListBoxMain.prototype.toggleListElements=function toggleListElements(itemsOnStart){var _this3=this;this.$listElements.each(function(i,elem){if(i>itemsOnStart-1){if(!_this3.$expandLinksWrapper.hasClass(selectors.listExpandedClass)){setTimeout(function(){return $(elem).addClass(selectors.hiddenClass);},500);}else{$(elem).removeClass(selectors.hiddenClass);}}});};TipListBoxMain.prototype.overrideTitles=function overrideTitles(){var $items=$('.tip-box-main-list-item');var $toOverride=this.$tipList.data('json')&&this.$tipList.data('json').override;if($toOverride){$.each($toOverride,function(key,override){$.each($items,function(itemKey,item){if($(item).children()[0].href===override.path){$(item).find('.trim-text').replaceWith($(override.title).addClass('trim-text'));}});});}};TipListBoxMain.prototype.changeEmailFormPosition=function changeEmailFormPosition($this){var isMobile=this.media.isMobile();var $form=$this.find('.tip-box-main-form');var $scrollBox=$this.find('.tip-box-main-scroll')[0];var $inputsLinks=$this.find('.tip-box-main-inputs-links.home');if(!isMobile&&$form[0].nextElementSibling!==$scrollBox||isMobile&&$form[0].nextElementSibling===$scrollBox){return;}
    if(!isMobile&&$form[0].nextElementSibling!==$inputsLinks[0]){var $detForm=$form.detach();$inputsLinks.before($detForm);}else{var _$detForm=$form.detach();var $heading=$this.find('.tip-box-heading-section');$heading.after(_$detForm);}};return TipListBoxMain;}();api.onRegister=function(scope){new TipListBoxMain(scope.$scope,this.external.media);};Cog.registerComponent({name:'tipListBoxMain',api:api,selector:'.tip-box-main',requires:[{name:'utils.media',apiId:'media'}]});})(Cog.jQuery());(function(){var api={};function handleButtonVisibility(container,leftButton,rightButton){if(container.scrollLeft>0){leftButton.classList.add('video-showcase-scroll-button-visible');}else{leftButton.classList.remove('video-showcase-scroll-button-visible');}
if(container.scrollWidth>container.clientWidth&&container.scrollLeft+container.clientWidth<container.scrollWidth){rightButton.classList.add('video-showcase-scroll-button-visible');}else if(container.scrollWidth>container.clientWidth){rightButton.classList.remove('video-showcase-scroll-button-visible');}}
api.onRegister=function(scope){var videoShowcaseContainer=scope.$scope.find('.video-showcase-container')[0];var rightButton=scope.$scope.find('.video-showcase-scroll-right-button')[0];var leftButton=scope.$scope.find('.video-showcase-scroll-left-button')[0];if(videoShowcaseContainer.scrollWidth>videoShowcaseContainer.clientWidth){rightButton.classList.add('video-showcase-scroll-button-visible');}
    var imageWidth=scope.$scope.find('.video-image')[0].offsetWidth+10;leftButton.onclick=function(){var mod=videoShowcaseContainer.scrollLeft%imageWidth;if(mod){$(videoShowcaseContainer).animate({scrollLeft:'-='+mod},500);}else{$(videoShowcaseContainer).animate({scrollLeft:'-='+imageWidth},500);}};rightButton.onclick=function(){$(videoShowcaseContainer).animate({scrollLeft:'+='+imageWidth},500);};$(window).onresize=function(){handleButtonVisibility(videoShowcaseContainer,leftButton,rightButton);};videoShowcaseContainer.onscroll=function(){handleButtonVisibility(videoShowcaseContainer,leftButton,rightButton);};};Cog.registerComponent({name:'video-showcase',api:api,selector:'.videoShowcase'});})(Cog.jQuery());(function(){var api={};var players={};var getUrlParameters=function getUrlParameters(url){var params={};var parser=document.createElement('a');parser.href=url;var query=parser.search.substring(1);var vars=query.split('&');for(var i=0;i<vars.length;i++){var pair=vars[i].split('=');params[pair[0]]=decodeURIComponent(pair[1]);}
return params;};var createYouTubeApiQueue=function createYouTubeApiQueue(scope){if(!window.youTubeApiQueue){window.youTubeApiQueue=[];}
var youTubePlayers=scope.$scope.find('.youtube-player-container');youTubePlayers.each(function(index,item){var optionsElement=$(item).find('.youtube-player-data');var playerOptions={title:optionsElement.data('title'),videoId:optionsElement.data('video-id'),elementId:optionsElement.data('video-id'),description:optionsElement.data('description'),altText:optionsElement.data('alt-text'),startTime:optionsElement.data('start-time'),startTimeAsSeconds:optionsElement.data('start-time-as-seconds')};if(playerOptions.videoId){window.youTubeApiQueue.push(playerOptions);}else{var playerContainer=item;playerContainer.classList.add('youtube-player-hidden');var player=$(item).find('.youtube-player');player[0].classList.add('youtube-player-hidden');if(playerOptions.altText){var altElement=$(item).find('.youtube-player-alt');altElement[0].classList.add('alt-visible');}else{var defaultAltElement=$(item).find('.youtube-player-alt-default');defaultAltElement[0].classList.add('alt-visible');}}});$(window).on('hashchange',function(){if(window.location.hash.match(new RegExp('#youtube-player-(.+)-chapter(\\d+)'))){$(''+window.location.hash)[0].click();}});};window.onYouTubeIframeAPIReady=function(){if(window.youTubeApiQueue){for(var i=0;i<window.youTubeApiQueue.length;i++){var videoContainerId='youtube-player-'+window.youTubeApiQueue[i].elementId;players[window.youTubeApiQueue[i].elementId]=new window.YT.Player(videoContainerId,{videoId:window.youTubeApiQueue[i].elementId,events:{onReady:window.youtubeIframeAPI_onReady.bind(window.youTubeApiQueue[i]),onStateChange:window.youtubeIframeAPI_onPlayerStateChange.bind(window.youTubeApiQueue[i])}});}}};window.youtubeIframeAPI_onReady=function(event){var params=getUrlParameters(window.location.href);var regExp=/youtube-player-(.+)/;var currentPlayerId=event.target.getIframe().id;event.target.getIframe().classList.add('youtube-player','lazyload');var chapterLinks=$('[id^=\''+currentPlayerId+'-chapter\']');chapterLinks.each(function(index,item){$(item).on('click',function(){event.target.seekTo(item.getAttribute('data-seek-time'));var status=event.target.getPlayerState();if(status===5){event.target.mute();}
event.target.playVideo();});});if(window.location.hash&&window.location.hash.match(new RegExp('#'+currentPlayerId+'-chapter(\\d+)'))){$(''+window.location.hash)[0].click();return;}
if(params.autoplay==="true"&&window.location.hash==='#'+currentPlayerId){var urlVideoId=regExp.exec(window.location.hash)[1];var time=params.t;if(urlVideoId===this.videoId){event.target.mute();event.target.playVideo();if(time){event.target.seekTo(time);}}}};window.youtubeIframeAPI_onPlayerStateChange=function(event){};api.onRegister=function(scope){createYouTubeApiQueue(scope);if(window.YT&&window.YT.loaded){window.onYouTubeIframeAPIReady();}else{var tag=document.createElement('script');tag.src='https://www.youtube.com/iframe_api';var firstScriptTag=document.getElementsByTagName('script')[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);}};Cog.registerComponent({name:'youtubeIframeAPI',api:api,selector:'body'});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={seeMoreElement:'.tools-list-show-more',seeLessElement:'.tools-list-show-less',toolsListItem:'.toolsListItem'};var isExpandedClass='is-expanded';var ToolsList=function(){function ToolsList($scope){_classCallCheck(this,ToolsList);this.$scope=$scope;this.bindElements();this.bindEvents();this.handleShowMoreButton();}
ToolsList.prototype.bindElements=function bindElements(){this.$toolsListSeeMore=this.$scope.find(selectors.seeMoreElement);this.$toolsListSeeLess=this.$scope.find(selectors.seeLessElement);this.$toolsListItems=this.$scope.find(selectors.toolsListItem);this.$showMoreText=this.$toolsListSeeMore[0].innerText;this.$window=$(window);};ToolsList.prototype.fireAnalyticsEvent=function fireAnalyticsEvent($target,href){Cog.fireEvent('analytics','clickable.click',{$target:$target,href:href});};ToolsList.prototype.scrollToToolsListTop=function scrollToToolsListTop(){var isMobile=this.$window.width()<768;if(isMobile){var toolsListTop=this.$scope.offset().top;this.$window.scrollTop(toolsListTop);}};ToolsList.prototype.handleShowMoreButton=function handleShowMoreButton(){var _this=this;var hiddenItems=0;this.$toolsListItems.each(function(index,item){if($(item).is(':hidden')){hiddenItems++;}});if(!hiddenItems){this.$toolsListSeeMore.hide();}else{this.$toolsListSeeMore.show();}
    this.$toolsListSeeMore.text(function(){return _this.$showMoreText+' ('+hiddenItems+')';});};ToolsList.prototype.bindEvents=function bindEvents(){var _this2=this;var that=this;this.$window.on('resize',_.debounce(that.handleShowMoreButton.bind(this),150));this.$toolsListSeeMore.click(function(ev){var $target=$(ev.target);_this2.$scope.addClass(isExpandedClass);_this2.$toolsListSeeMore.hide();_this2.fireAnalyticsEvent($target,'#see-more');});this.$toolsListSeeLess.click(function(ev){var $target=$(ev.target);_this2.$scope.removeClass(isExpandedClass);_this2.$toolsListSeeMore.show();_this2.fireAnalyticsEvent($target,'#see-less');_this2.scrollToToolsListTop();});};return ToolsList;}();api.onRegister=function(scope){new ToolsList(scope.$scope);};Cog.registerComponent({name:'toolsList',api:api,selector:'.toolsList'});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($,Sly){var api={};var classes={trendingItems:'trending-items',mostPopularSlider:'most-popular-slider',mostPopularScrollbar:'most-popular-scrollbar',mostPopularNavNextPage:'most-popular-nav-next-page',mostPopularNavPrevPage:'most-popular-nav-prev-page'};var Trending=function(){function Trending($element){_classCallCheck(this,Trending);this.$trendingContainer=$element;this.sliderReached=0;this.bindData();this.bindEvents();this.prepareAdditionalMarkup();this.initializeSlider();this.bindAnalyticsEvents();}
Trending.prototype.bindData=function bindData(){this.$trendingItems=this.$trendingContainer.find('.'+classes.trendingItems);this.$mostPopularSlider=this.$trendingItems.find('.'+classes.mostPopularSlider);};Trending.prototype.bindEvents=function bindEvents(){var _this=this;$(window).on('resize',_.debounce(function(){_this.slider.reload();},150));this.$trendingItems.on('keyup',function(e){var $currentTarget=$(e.target);var keyCode=e.keyCode||e.which;if(keyCode===9){_this.slider.activate($currentTarget.closest('li'));}});};Trending.prototype.fireAnalyticsEvent=function fireAnalyticsEvent(ev,href,elementExtraInfo,$explicitTarget){var $target=$explicitTarget||$(ev.target);Cog.fireEvent('analytics','clickable.click',{$target:$target,href:href,elementExtraInfo:elementExtraInfo});};Trending.prototype.handleSliderScrollEvent=function handleSliderScrollEvent(percent){this.fireAnalyticsEvent(null,'#slider',percent+'%',this.$scrollBar);};Trending.prototype.handleSliderScroll=function handleSliderScroll(){var _slider$pos=this.slider.pos,cur=_slider$pos.cur,end=_slider$pos.end;var currentPosition=parseInt(cur/end*100,10);if(this.sliderReached<100&&currentPosition===100){this.handleSliderScrollEvent(100);}else if(this.sliderReached<75&&currentPosition>=75){this.handleSliderScrollEvent(75);}else if(this.sliderReached<50&&currentPosition>=50){this.handleSliderScrollEvent(50);}else if(this.sliderReached<25&&currentPosition>=25){this.handleSliderScrollEvent(25);}
    this.sliderReached=Math.max(currentPosition,this.sliderReached);};Trending.prototype.bindAnalyticsEvents=function bindAnalyticsEvents(){var _this2=this;this.$nextPageButton.click(function(ev){return _this2.fireAnalyticsEvent(ev,'#>','right');});this.$prevPageButton.click(function(ev){return _this2.fireAnalyticsEvent(ev,'#<','left');});this.slider.on('moveEnd',function(){return _this2.handleSliderScroll();});};Trending.prototype.prepareAdditionalMarkup=function prepareAdditionalMarkup(){var $scrollBar=$('<div class="'+classes.mostPopularScrollbar+'"><div class="handle"></div></div>');var $navButtons=$('<div class="most-popular-nav-buttons">\n                <button aria-label="Scroll to left" class="'+classes.mostPopularNavPrevPage+'"></button>\n                <button aria-label="Scroll to right" class="'+classes.mostPopularNavNextPage+'"></button>\n            </div>');this.$trendingItems.append($scrollBar).append($navButtons);this.$scrollBar=this.$trendingContainer.find('.'+classes.mostPopularScrollbar);this.$prevPageButton=this.$trendingContainer.find('.'+classes.mostPopularNavPrevPage);this.$nextPageButton=this.$trendingContainer.find('.'+classes.mostPopularNavNextPage);};Trending.prototype.initializeSlider=function initializeSlider(){this.slider=new Sly(this.$mostPopularSlider,{slidee:this.$mostPopularSlider.find('ol'),horizontal:1,itemNav:'basic',smart:1,activateOn:'click',mouseDragging:1,touchDragging:1,releaseSwing:1,startAt:0,scrollBar:this.$scrollBar,activatePageOn:'click',speed:300,elasticBounds:1,easing:'easeOutExpo',dragHandle:1,dynamicHandle:1,clickBar:1,prevPage:this.$prevPageButton,nextPage:this.$nextPageButton});this.slider.init();this.slider.reload();};return Trending;}();api.onRegister=function(scope){new Trending(scope.$scope);};Cog.registerComponent({name:'TrendingWithScrollbar',api:api,selector:'.trending-with-scrollbar'});})(Cog.jQuery(),window.Sly);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($,Sly){var api={};var classes={dealsHuntersBlogs:'deals-hunters-blogs',dealsHuntersBlogsContent:'component-content',dealsHuntersBlogsScrollbar:'deals-hunters-blogs-scrollbar',dealsHuntersBlogsNavNextPage:'deals-hunters-blogs-nav-next-page',dealsHuntersBlogsNavPrevPage:'deals-hunters-blogs-nav-prev-page'};var DealsHuntersBlogs=function(){function DealsHuntersBlogs($element){_classCallCheck(this,DealsHuntersBlogs);this.$dealsHuntersBlogsComposite=$element;this.bindData();this.bindEvents();this.prepareAdditionalMarkup();this.initializeSlider();}
DealsHuntersBlogs.prototype.bindData=function bindData(){this.$dealsHuntersBlogs=this.$dealsHuntersBlogsComposite.find('.'+classes.dealsHuntersBlogs);this.$dealsHuntersBlogsContent=this.$dealsHuntersBlogs.find('.'+classes.dealsHuntersBlogsContent);};DealsHuntersBlogs.prototype.bindEvents=function bindEvents(){var _this=this;$(window).on('resize',_.debounce(function(){_this.slider.reload();},150));this.$dealsHuntersBlogs.on('keyup',function(e){var $currentTarget=$(e.target);var keyCode=e.keyCode||e.which;if(keyCode===9&&_this.slider){_this.slider.activate($currentTarget.closest('li'));}});};DealsHuntersBlogs.prototype.prepareAdditionalMarkup=function prepareAdditionalMarkup(){var $scrollBar=$('<div class="'+classes.dealsHuntersBlogsScrollbar+'"><div class="handle"></div></div>');var $navButtons=$('<div class="deals-hunters-blogs-nav-buttons">\n                    <button aria-label="Scroll to left" class="'+classes.dealsHuntersBlogsNavPrevPage+'"></button>\n                    <button aria-label="Scroll to right" class="'+classes.dealsHuntersBlogsNavNextPage+'"></button>\n                </div>');this.$dealsHuntersBlogs.append($scrollBar).append($navButtons);this.$scrollBar=this.$dealsHuntersBlogsComposite.find('.'+classes.dealsHuntersBlogsScrollbar);this.$prevPageButton=this.$dealsHuntersBlogsComposite.find('.'+classes.dealsHuntersBlogsNavPrevPage);this.$nextPageButton=this.$dealsHuntersBlogsComposite.find('.'+classes.dealsHuntersBlogsNavNextPage);};DealsHuntersBlogs.prototype.initializeSlider=function initializeSlider(){this.slider=new Sly(this.$dealsHuntersBlogsContent,{slidee:this.$dealsHuntersBlogsContent.find('ul'),horizontal:1,itemNav:'basic',smart:1,activateOn:'click',mouseDragging:1,touchDragging:1,releaseSwing:1,startAt:0,scrollBar:this.$scrollBar,activatePageOn:'click',speed:300,elasticBounds:1,easing:'easeOutExpo',dragHandle:1,dynamicHandle:1,clickBar:1,prevPage:this.$prevPageButton,nextPage:this.$nextPageButton});this.slider.init();this.slider.reload();};return DealsHuntersBlogs;}();api.onRegister=function(scope){new DealsHuntersBlogs(scope.$scope);};Cog.registerComponent({name:'DealsHuntersBlogs',api:api,selector:'.composite-variation-recent-deals-hunters-blogs'});})(Cog.jQuery(),window.Sly);(function(){var api={};var selectors={seeMoreElement:'.editors-picks-expand-more',seeLessElement:'.editors-picks-expand-less',editorsPicksInfoShown:'.editors-picks-expand-shown',editorsPicksInfoAll:'.editors-picks-expand-all'};var isExpandedClass='is-expanded';var INITIAL_ITEMS_NUMBER=5;api.adjustInformation=function(items,allItems,elements){elements.$editorsPicksInfoShown.text(items);elements.$editorsPicksInfoAll.text(allItems);};api.handleSeeMoreClick=function(ev,$scope,allItems,elements){var $target=$(ev.target);$scope.addClass(isExpandedClass);elements.$seeMoreElement.hide();elements.$seeLessElement.show();api.adjustInformation(allItems,allItems,elements);$($scope.find('> .content > .promoBoxItem')[5]).find('.promobox-content-standard .promobox-title a').focus();Cog.fireEvent('analytics','clickable.click',{$target:$target,href:'#see-more'});Cog.init($scope);};api.handleSeeLessClick=function(ev,$scope,allItems,elements){var $target=$(ev.target);$scope.removeClass(isExpandedClass);elements.$seeMoreElement.show();elements.$seeLessElement.hide();api.adjustInformation(INITIAL_ITEMS_NUMBER,allItems,elements);Cog.fireEvent('analytics','clickable.click',{$target:$target,href:'#see-less'});};api.bindEvents=function($scope,elements){var allItems=$scope.find('.promoBoxItem').length;api.adjustInformation(INITIAL_ITEMS_NUMBER,allItems,elements);elements.$seeMoreElement.click(function(ev){return api.handleSeeMoreClick(ev,$scope,allItems,elements);});elements.$seeLessElement.click(function(ev){return api.handleSeeLessClick(ev,$scope,allItems,elements);});};api.onRegister=function(element){var $scope=element.$scope;var elements={$seeMoreElement:$scope.find(selectors.seeMoreElement),$seeLessElement:$scope.find(selectors.seeLessElement),$editorsPicksInfoShown:$scope.find(selectors.editorsPicksInfoShown),$editorsPicksInfoAll:$scope.find(selectors.editorsPicksInfoAll)};api.bindEvents($scope,elements);};Cog.registerComponent({name:'promoBoxEditorsPicks',api:api,selector:'.editors-picks'});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var classes={isVisible:'is-visible',isItemVisible:'is-item-visible'};var selectors={expandMoreButton:'.dynamic-guides-expand-more',expandInfo:'.dynamic-guides-expand-info',secondContainer:'.container2',thirdContainer:'.container3',thirdContainerItems:'.item',itemsShown:'.dynamic-guides-indicator-shown',itemsAll:'.dynamic-guides-indicator-all',visibleContainerItems:'.container1 > .item',updatedDynamicGuides:'.subcategory-top-promo-box',promoBoxItem:'.promoBoxItem',fourthContainer:'.container4'};var SCROLL_DURATION=500;var PromoBoxDynamicGuides=function(){function PromoBoxDynamicGuides($scope,status,media){_classCallCheck(this,PromoBoxDynamicGuides);this.$scope=$scope;this.status=status;this.media=media;this.bindUIElements();if(!this.isUpdated()){this.bindUIEvents();this.itemsAll=parseInt(this.$expandInfoAll.text(),10);}
this.init();if(!this.isUpdated()){this.updateComponentInAuthoring();}}
PromoBoxDynamicGuides.prototype.init=function init(){if(this.isUpdated()){this.handleCounterAndButtonOnLoad();this.showMoreItems();}else{this.getShownElementsQty();this.updateExpandInfo();this.updateShowMoreButtonState();this.setNextScrollTop();}};PromoBoxDynamicGuides.prototype.bindUIElements=function bindUIElements(){this.$seeMoreButton=this.$scope.find(selectors.expandMoreButton);this.$expandInfo=this.$scope.find(selectors.expandInfo);this.$secondContainer=this.$scope.find(selectors.secondContainer);this.$thirdContainer=this.$scope.find(selectors.thirdContainer);this.$thirdContainerItems=this.$scope.find(selectors.thirdContainerItems);this.$fourthContainer=this.$scope.find(selectors.fourthContainer);this.$expandInfoShown=this.$expandInfo.find(selectors.itemsShown);this.$expandInfoAll=this.$expandInfo.find(selectors.itemsAll);this.$visibleContainerItems=this.$scope.find(selectors.visibleContainerItems);this.$allItems=this.$scope.find(selectors.promoBoxItem);};PromoBoxDynamicGuides.prototype.isUpdated=function isUpdated(){return!!this.$scope.parents().find(selectors.updatedDynamicGuides).length;};PromoBoxDynamicGuides.prototype.handleCounterAndButtonOnLoad=function handleCounterAndButtonOnLoad(){var maxItemsVisibleOnEnter=19;if(this.$allItems.length<=maxItemsVisibleOnEnter){this.updateVisibleItemsCounter(this.$allItems.length);}else{this.updateVisibleItemsCounter(maxItemsVisibleOnEnter);this.$seeMoreButton.css('display','inline-block');}};PromoBoxDynamicGuides.prototype.updateVisibleItemsCounter=function updateVisibleItemsCounter(number){this.$expandInfoShown.text(number);};PromoBoxDynamicGuides.prototype.showMoreItems=function showMoreItems(){var _this=this;var showOnClickNumber=8;var allVisibleItemsCount=19;this.$seeMoreButton.on('click',function(){var shownCount=0;var $hiddenItems=_this.$fourthContainer.find(selectors.promoBoxItem+':not(.'+classes.isItemVisible+')');var $firstShownItem=void 0;$hiddenItems.each(function(i,elem){if(i===shownCount&&i<showOnClickNumber){$(elem).addClass(classes.isItemVisible);shownCount++;allVisibleItemsCount++;}
    if(i===0){$firstShownItem=$(elem);$(elem).find('.promobox-content-standard .promobox-title a').focus();}
    if(shownCount>=$hiddenItems.length){_this.$seeMoreButton.css('display','none');}});if(!_this.media.isTabletHorizontalOrDesktop()){$('html,body').animate({scrollTop:$firstShownItem.offset().top},SCROLL_DURATION,function(){$firstShownItem.find('.promobox-content-standard .promobox-title a').focus();});}else{$firstShownItem.find('.promobox-content-standard .promobox-title a').focus();}
    _this.updateVisibleItemsCounter(allVisibleItemsCount);Cog.fireEvent('analytics','clickable.click',{$target:_this.$seeMoreButton,href:'#see-more'});});};PromoBoxDynamicGuides.prototype.setNextScrollTop=function setNextScrollTop(){this.nextScrollTop=this.$scope.position().top+this.$scope.offset().top+this.$scope.outerHeight();};PromoBoxDynamicGuides.prototype.scrollToExpandedItems=function scrollToExpandedItems(){if(!this.media.isTabletHorizontalOrDesktop()){$('html,body').animate({scrollTop:this.nextScrollTop},SCROLL_DURATION);}};PromoBoxDynamicGuides.prototype.getShownElementsQty=function getShownElementsQty(){this.itemsShown=this.media.isTabletHorizontalOrDesktop()?Math.min(13,this.itemsAll):this.$visibleContainerItems.length;if(this.media.isTabletHorizontalOrDesktop()){this.isSecondContainerShown=true;this.$secondContainer.addClass(classes.isVisible);}};PromoBoxDynamicGuides.prototype.updateExpandInfo=function updateExpandInfo(){this.$expandInfoShown.text(this.itemsShown);};PromoBoxDynamicGuides.prototype.updateShowMoreButtonState=function updateShowMoreButtonState(){if(this.itemsAll>this.itemsShown){this.$seeMoreButton.addClass(classes.isVisible);}else{this.$seeMoreButton.removeClass(classes.isVisible);}};PromoBoxDynamicGuides.prototype.bindUIEvents=function bindUIEvents(){var _this2=this;this.$seeMoreButton.click(function(){return _this2.handleSeeMoreClick();});$(window).on('resize',_.debounce(function(){_this2.setNextScrollTop();},250));};PromoBoxDynamicGuides.prototype.revealItems=function revealItems(){this.$thirdContainerItems.slice(0,this.itemsShown).addClass(classes.isItemVisible);};PromoBoxDynamicGuides.prototype.focusOnElement=function focusOnElement($container,elementIndex){$container.find('.item').eq(elementIndex).find('a').eq(0).focus();};PromoBoxDynamicGuides.prototype.handleSeeMoreClick=function handleSeeMoreClick(){if(!this.isSecondContainerShown){this.$secondContainer.addClass(classes.isVisible);this.focusOnElement(this.$secondContainer,0);this.itemsShown=Math.min(this.itemsShown+7,this.itemsAll);this.isSecondContainerShown=true;Cog.init(this.$secondContainer);}else if(this.itemsShown<this.itemsAll){var prevItemsShown=this.itemsShown;this.$thirdContainer.addClass(classes.isVisible);this.itemsShown=Math.min(this.itemsShown+9,this.itemsAll);this.revealItems();this.focusOnElement(this.$thirdContainer,prevItemsShown-13);Cog.init({$element:this.$thirdContainer});}else{this.$thirdContainer.addClass(classes.isVisible);this.itemsShown=this.itemsAll;Cog.init({$element:this.$thirdContainer});}
    Cog.fireEvent('analytics','clickable.click',{$target:this.$seeMoreButton,href:'#see-more'});this.updateExpandInfo();this.updateShowMoreButtonState();this.scrollToExpandedItems();this.setNextScrollTop();};PromoBoxDynamicGuides.prototype.updateComponentInAuthoring=function updateComponentInAuthoring(){if(!this.status.isAuthor()){return;}
    var $elements=this.$scope.find('.promoBoxItem');if($elements.length<=6){return;}
    var lastElement=$elements.eq(12);if(lastElement.length===0){lastElement=$elements.last();}
    lastElement.addClass('dynamic-guides-last-item');};return PromoBoxDynamicGuides;}();api.onRegister=function(scope){new PromoBoxDynamicGuides(scope.$scope,this.external.status,this.external.media);};Cog.registerComponent({name:'promoBoxDynamicGuides',api:api,selector:'.dynamic-guides',requires:[{name:'utils.status',apiId:'status'},{name:'utils.media',apiId:'media'}]});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($,Sly){var api={};var classes={isWrapped:'is-wrapped',toggleButtonWrapper:'in-page-navigation-button',navList:'in-page-navigation-items',navWrapper:'in-page-navigation-wrapper',leftGradient:'left-gradient',rightGradient:'right-gradient'};var InpageNavigation=function(){function InpageNavigation($element,media){_classCallCheck(this,InpageNavigation);this.$scope=$element;this.media=media;this.init();}
InpageNavigation.prototype.init=function init(){this.bindElements();this.bindEvents();this.wrapNavigation();};InpageNavigation.prototype.bindElements=function bindElements(){this.$toggleButtonWrapper=this.$scope.find('.'+classes.toggleButtonWrapper);this.$toggleButton=this.$toggleButtonWrapper.find('button');this.$navList=this.$scope.find('.'+classes.navList);this.$navWrapper=this.$scope.find('.'+classes.navWrapper);};InpageNavigation.prototype.bindEvents=function bindEvents(){var _this=this;this.$toggleButton.on('click',function(ev){var isExpanded=_this.$toggleButtonWrapper.attr('aria-expanded')==='true';var $target=$(ev.target);_this.$toggleButtonWrapper.attr('aria-expanded',isExpanded?'false':'true');Cog.fireEvent('analytics','clickable.click',{$target:$target,href:isExpanded?'#close':'#open',elementExtraInfo:isExpanded?'close':'open'});});$(window).on('resize',_.debounce(function(){_this.wrapNavigation();},250));this.$navWrapper.on('keyup',function(e){var keyCode=e.keyCode||e.which;if(keyCode===9){var $currentButton=$(e.target);_this.slider.toCenter($currentButton.parent());}});};InpageNavigation.prototype.wrapNavigation=function wrapNavigation(){var navWrapperWidth=this.$navWrapper[0].scrollWidth;var isTabletOrDesktop=this.media.isTabletOrDesktop();if(isTabletOrDesktop&&navWrapperWidth>this.$navList.width()){this.$scope.addClass(classes.isWrapped);if(!this.slider||!this.slider.initialized){this.initializeSlider();}}
    if(!isTabletOrDesktop&&this.slider){this.slider.destroy();}};InpageNavigation.prototype.initializeSlider=function initializeSlider(){var _this2=this;this.slider=new Sly(this.$navWrapper,{slidee:this.$navList,horizontal:1,itemNav:'centered',smart:false,activateOn:'click',mouseDragging:1,touchDragging:1,releaseSwing:1,scrollSource:this.$navWrapper,scrollBy:1,scrollTrap:true,startAt:0,activatePageOn:'click',speed:300,elasticBounds:0,easing:'easeOutExpo',dragHandle:1,dynamicHandle:1,clickBar:1,activeClass:'sly-active'});this.slider.init();this.slider.on('move',function(){return _this2.handleSliderScroll();});this.slider.toCenter(this.$navList.find('.active').parent());this.handleSliderScroll();};InpageNavigation.prototype.handleSliderScroll=function handleSliderScroll(){var _slider$pos=this.slider.pos,cur=_slider$pos.cur,end=_slider$pos.end;var currentPosition=parseInt(cur/end*100,10);this.$scope.toggleClass(classes.leftGradient,currentPosition>1);this.$scope.toggleClass(classes.rightGradient,currentPosition<99);};return InpageNavigation;}();api.onRegister=function(scope){new InpageNavigation(scope.$scope,this.external.media);};Cog.registerComponent({name:'InpageNavigation',api:api,selector:'.in-page-navigation-component',requires:[{name:'utils.media',apiId:'media'}]});})(Cog.jQuery(),window.Sly);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var keysToHandle={rightArrow:39,leftArrow:37,space:32,enter:13,tab:9};var api={tabs:[]};var values={isDesktop:null};var megamenuOpenTimeoutMs=200;var Megamenu=function(){function Megamenu($scope,status,media){_classCallCheck(this,Megamenu);this.logger=Cog.logger('MegaMenu');this.$scope=$scope;this.status=status;this.media=media;this.bindEvents();this.init();this.bindElements();this.attachResize();$(window).trigger('resize');}
Megamenu.prototype.attachResize=function attachResize(){var _this=this;$(window).on('resize',_.debounce(function(){_this.isDesktopCheck();if(values.isDesktop||_this.status.isAuthor()){_this.detachEvents();_this.attachEvents();}else{_this.detachEvents();}},200));};Megamenu.prototype.init=function init(){this.addActivatedStateIfUrlMatches();this.halfOfTheViewportWidth=$(window).width()/2;this.tabFocus=0;$('.mobile-header-fixed-height').addClass('no-padding');this.activateTabTimeout=[];};Megamenu.prototype.addActivatedStateIfUrlMatches=function addActivatedStateIfUrlMatches(){var navItemWithCurrentUrl=this.$scope.find('.megaMenu-nav-item > a[href="'+window.location.href+'"]');if(navItemWithCurrentUrl.length!==1){this.logger.info('Category URLs should be unique');return;}
    var tabWithCurrentUrl=navItemWithCurrentUrl.closest('.megaMenu-nav-item');tabWithCurrentUrl.addClass('activated');};Megamenu.prototype.bindEvents=function bindEvents(){this.activateTab=this.activateTab.bind(this);this.deactivateTabs=this.deactivateTabs.bind(this);this.activateFirstOrLastTab=this.activateFirstOrLastTab.bind(this);this.handleKeysForAccessibility=this.handleKeysForAccessibility.bind(this);};Megamenu.prototype.bindElements=function bindElements(){var _this2=this;this.$tabs=this.$scope.find('.component-content > .megaMenu-nav .megaMenu-nav-item');this.$header=$('#header');this.$componentContent=this.$scope.find('.megaMenu-wrapper').children('.component-content').first();this.$contents=this.$scope.find('.component-content > .megaMenu-content');this.$contents.addClass('is-hidden');this.$megaMenuNav=this.$scope.find('.megaMenu-nav');this.$moreList=$('.top-nav-v2__moreButton');this.$lastAnchorsInEachTab={};this.$contents.each(function(i,tabContent){var content=$(tabContent);_this2.$lastAnchorsInEachTab[content.attr('id')]=content.find('a').last();});};Megamenu.prototype.attachEvents=function attachEvents(){if(this.status.isAuthor()){this.$tabs.on('click',this.activateTab);}else{this.$tabs.on('click',function(e){return $(e.currentTarget).children('a').blur();});this.$tabs.on('mouseenter',this.activateTab);this.$componentContent.on('mouseleave',this.deactivateTabs);this.$megaMenuNav.on('mouseenter',this.activateFirstOrLastTab);this.$componentContent.on('keydown',this.handleKeysForAccessibility);}
    this.$tabs.filter('.is-active').trigger('click');};Megamenu.prototype.detachEvents=function detachEvents(){this.$tabs.off('mouseenter',this.activateTab);this.$componentContent.off('mouseleave',this.deactivateTabs);this.$megaMenuNav.off('mouseenter',this.activateFirstOrLastTab);this.$componentContent.off('keydown',this.handleKeysForAccessibility);};Megamenu.prototype.activateTab=function activateTab(e){e.preventDefault();this.activate($(e.currentTarget));};Megamenu.prototype.activate=function activate($tab){var _this3=this;this.activateTabTimeout.push(setTimeout(function(){_this3.showCurrentTab($tab);_this3.markAsActive($tab);_this3.markAsSelectedForAccessibility($tab);_this3.showOverlay();_this3.hideMoreList();_this3.shrinkMoreListForAccessibility();},megamenuOpenTimeoutMs));};Megamenu.prototype.showCurrentTab=function showCurrentTab($tab){this.$contents.addClass('is-hidden');this.$contents.filter($tab.find('a').data('category-id')).removeClass('is-hidden');};Megamenu.prototype.markAsActive=function markAsActive($tab){this.$tabs.removeClass('is-active');$tab.addClass('is-active');};Megamenu.prototype.markAsSelectedForAccessibility=function markAsSelectedForAccessibility($tab){this.$tabs.attr('aria-selected',false);$tab.attr('aria-selected',true);};Megamenu.prototype.showOverlay=function showOverlay(){this.$header.addClass('megaMenu__overlay');};Megamenu.prototype.hideMoreList=function hideMoreList(){this.$moreList.removeClass('active');};Megamenu.prototype.shrinkMoreListForAccessibility=function shrinkMoreListForAccessibility(){this.$moreList.attr('aria-expanded',false);};Megamenu.prototype.deactivateTabs=function deactivateTabs(e){e.preventDefault();this.activateTabTimeout.forEach(function(tab){return clearTimeout(tab);});this.activateTabTimeout=[];this.hideMegamenu();};Megamenu.prototype.hideMegamenu=function hideMegamenu(){this.hideAllTabs();this.markAsInactive();this.hideOverlay();};Megamenu.prototype.hideAllTabs=function hideAllTabs(){this.$contents.addClass('is-hidden');};Megamenu.prototype.markAsInactive=function markAsInactive(){this.$tabs.removeClass('is-active');};Megamenu.prototype.hideOverlay=function hideOverlay(){this.$header.removeClass('megaMenu__overlay');};Megamenu.prototype.activateFirstOrLastTab=function activateFirstOrLastTab(e){if(!this.isHoveringOnTheSidesOfMenu(e)){return;}
    if(this.isHoveringOnTheLeft(e)){this.activateFirstTab();}else{this.activateLastTab();}};Megamenu.prototype.isHoveringOnTheSidesOfMenu=function isHoveringOnTheSidesOfMenu(e){return e.currentTarget===e.target;};Megamenu.prototype.isHoveringOnTheLeft=function isHoveringOnTheLeft(e){return e.pageX<this.halfOfTheViewportWidth;};Megamenu.prototype.activateFirstTab=function activateFirstTab(){this.activate(this.$tabs.first());};Megamenu.prototype.activateLastTab=function activateLastTab(){this.activate(this.$tabs.last());};Megamenu.prototype.handleKeysForAccessibility=function handleKeysForAccessibility(e){if(Object.values(keysToHandle).includes(e.keyCode)){this.$focusedTab=$(this.$tabs[this.tabFocus]);switch(e.keyCode){case keysToHandle.rightArrow:this.moveFocusToRight();break;case keysToHandle.leftArrow:this.moveFocusToLeft();break;case keysToHandle.space:this.openCurrentCategory(e);break;case keysToHandle.enter:this.followCategoryUrl();break;case keysToHandle.tab:this.hideMegamenuAfterLastAnchor(e);break;}}};Megamenu.prototype.moveFocusToLeft=function moveFocusToLeft(){this.$focusedTab.attr('tabindex',-1);this.tabFocus--;if(this.tabFocus<0){this.tabFocus=this.$tabs.length-1;}
    this.changeFocus();};Megamenu.prototype.changeFocus=function changeFocus(){var $tabToFocus=$(this.$tabs[this.tabFocus]);$tabToFocus.attr('tabindex',0);$tabToFocus.focus();};Megamenu.prototype.moveFocusToRight=function moveFocusToRight(){this.$focusedTab.attr('tabindex',-1);this.tabFocus++;if(this.tabFocus>=this.$tabs.length){this.tabFocus=0;}
    this.changeFocus();};Megamenu.prototype.openCurrentCategory=function openCurrentCategory(e){e.preventDefault();this.$openedTab=this.$focusedTab;this.$focusedTab.mouseenter();};Megamenu.prototype.followCategoryUrl=function followCategoryUrl(){var tabAnchor=this.$focusedTab.children('a');if(tabAnchor&&tabAnchor.attr('href')){window.location.href=tabAnchor.attr('href');}};Megamenu.prototype.isDesktopCheck=function isDesktopCheck(){if(this.$scope.hasClass('megaMenu-tabletHorizontal')){values.isDesktop=this.media.isDesktop();}else{values.isDesktop=this.media.isDesktopLarge();}};Megamenu.prototype.hideMegamenuAfterLastAnchor=function hideMegamenuAfterLastAnchor(e){if(!this.$openedTab){return;}
    var openedTabId=this.$openedTab.attr('aria-controls');if(this.$lastAnchorsInEachTab[openedTabId].is(e.target)){this.hideMegamenu();}};return Megamenu;}();api.onRegister=function(scope){api.tabs.push(new Megamenu(scope.$scope,this.external.status,this.external.media));};Cog.registerComponent({name:'megaMenu',api:api,selector:'.megaMenu',requires:[{name:'utils.status',apiId:'status'},{name:'utils.media',apiId:'media'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var values={$previousCategory:null,$previousLink:null,isTabletOrDesktopSmall:null,isMobile:null,isThirdLevelDisabled:false};var selectors={additionalLinksNavySection:'.megaMenu__additional-links-navy',additionalLinksGreySection:'.megaMenu__additional-links-grey',categoriesWrapper:'.megaMenu-wrapper > .component-content',contentWrapper:'.megaMenu-wrapper',navContainer:'.top-nav-v2-mobile-view',toggleMegaMenuHamburger:'.top-nav-v2-mobile-menu-open-image',toggleMegaMenuClose:'.top-nav-v2-mobile-menu-close-image',backButtonLvl2:'.megaMenu-back-lvl2'};var classes={active:'is-active',animate:'animate',overlay:'overlay',pageOverlay:'megaMenu__overlay',megaMenuButtonOpen:'top-nav-v2-mobile-menu-toggle--open',thirdLevelDisabled:'megaMenu-third-level-disabled'};var MegaMenuMobileV2=function(){function MegaMenuMobileV2($scope,status,media){_classCallCheck(this,MegaMenuMobileV2);this.$scope=$scope;this.status=status;this.media=media;if(!this.status.isAuthor()){this.addAdditionalLinksSection();this.bindElements();this.bindEvents();this.bindValues();this.attachResize();$(window).trigger('resize');this.addCategoryLinks();}}
MegaMenuMobileV2.prototype.bindEvents=function bindEvents(){this.closeMegaMenu=this.closeMegaMenu.bind(this);this.openMegamenu=this.openMegamenu.bind(this);this.setMegaMenuHeight=this.setMegaMenuHeight.bind(this);this.removeHeightSetting=this.removeHeightSetting.bind(this);};MegaMenuMobileV2.prototype.bindElements=function bindElements(){this.$document=$(document);this.$header=$('#header');this.$toggleMegaMenuHamburger=$(selectors.toggleMegaMenuHamburger);this.$toggleMegaMenuHamburgerLink=this.$toggleMegaMenuHamburger.find('a');this.$toggleMegaMenuClose=$(selectors.toggleMegaMenuClose);this.$toggleMegaMenuCloseLink=this.$toggleMegaMenuClose.find('a');this.$category=this.$scope.find('.megaMenu-nav-item');this.$categories=this.$scope.find('.megaMenu-content');this.$subcategory=this.$scope.find('.tabContent h3');this.$categoryList=this.$scope.find('.megaMenu-nav-list');this.$search=$('.top-nav-v2-search-box');};MegaMenuMobileV2.prototype.bindValues=function bindValues(){this.megaMenuSnippetName=this.$scope.closest('.snippetReference').attr('class').split(' ').filter(function(className){return className.indexOf('reference')===0;}).toString();this.isThirdLevelDisabledActive();};MegaMenuMobileV2.prototype.detachEvents=function detachEvents(){this.$document.off('click',this.closeMegaMenu);this.$toggleMegaMenuHamburgerLink.off('click',this.openMegamenu);this.$toggleMegaMenuCloseLink.off('click',this.closeMegaMenu);this.$category.off('click',this.openSubcategory);this.$document.off('cookieAccepted',this.setMegaMenuHeight);};MegaMenuMobileV2.prototype.attachEvents=function attachEvents(){var _this=this;this.$document.on('cookieAccepted',this.setMegaMenuHeight);this.$toggleMegaMenuHamburgerLink.on('click',this.openMegamenu);this.$toggleMegaMenuCloseLink.on('click',this.closeMegaMenu);this.$category.on('click',this.openSubcategory);$(selectors.backButtonLvl2).on('click',function(ev){return _this.closeSubcategory(ev);});};MegaMenuMobileV2.prototype.attachPhoneEvents=function attachPhoneEvents(){var _this2=this;this.$subcategory.on('click',function(ev){if(!values.isThirdLevelDisabled){_this2.addThirdLvlMenu(ev);}else{_this2.fireSubcategoryClickEvent(ev);}});};MegaMenuMobileV2.prototype.detachPhoneEvents=function detachPhoneEvents(){this.$subcategory.off('click');};MegaMenuMobileV2.prototype.isThirdLevelDisabledActive=function isThirdLevelDisabledActive(){values.isThirdLevelDisabled=this.$scope.hasClass(classes.thirdLevelDisabled);};MegaMenuMobileV2.prototype.addAdditionalLinksSection=function addAdditionalLinksSection(){var _this3=this;var $navySection=$(selectors.additionalLinksNavySection);var $graySection=$(selectors.additionalLinksGreySection);$navySection.insertAfter(selectors.categoriesWrapper);$graySection.insertAfter(selectors.categoriesWrapper);$navySection.find('a').on('click',function(ev){return _this3.fireBottomLinksClickEvent(ev);});$graySection.find('a').on('click',function(ev){return _this3.fireBottomLinksClickEvent(ev);});};MegaMenuMobileV2.prototype.fireBottomLinksClickEvent=function fireBottomLinksClickEvent(ev){var $link=$(ev.currentTarget);var href=$link.attr('href');var text=$link.text();Cog.fireEvent('analytics','mobileMegaMenu.bottomLinksClick',{actionType:'click',href:href,elementLayer1:'snippet '+this.megaMenuSnippetName,elementLayer2:'megamenu',elementLayer3:'richtext',itemIdentifier:text,siteSection:'MastHead BottomNav'});};MegaMenuMobileV2.prototype.openMegamenu=function openMegamenu(evt){evt.stopImmediatePropagation();this.$toggleMegaMenuHamburger.css('display','none');this.$toggleMegaMenuClose.css('display','block');this.$scope.css('display','block');this.$scope.css('width');this.$scope.addClass(classes.active);$('body').css({position:'fixed',width:'100%'});if(values.isTabletOrDesktopSmall){this.$header.addClass(classes.pageOverlay);}
    this.$document.on('click',this.closeMegaMenu);};MegaMenuMobileV2.prototype.closeMegaMenu=function closeMegaMenu(evt){evt.stopImmediatePropagation();var $target=$(evt.target);var toggleMegaMenuClose=$(selectors.toggleMegaMenuClose);var isTargetCloseImage=$target.is(toggleMegaMenuClose.find('img'));var isTargetCloseAnchor=$target.is(toggleMegaMenuClose.find('a'));var isTargetNotAChildOfNavbar=$target.closest(selectors.navContainer).length===0;var isTargetNotAChildOfMegaMenu=$target.closest(this.$scope).length===0;var isTargetNotSearch=$target.closest(this.$search).length===0;if(isTargetCloseImage||isTargetCloseAnchor||isTargetNotAChildOfNavbar&&isTargetNotAChildOfMegaMenu&&isTargetNotSearch){this.hideMegaMenu();this.$document.off('click',this.closeMegaMenu);this.$toggleMegaMenuHamburger.css('display','block');this.$toggleMegaMenuClose.css('display','none');}};MegaMenuMobileV2.prototype.hideMegaMenu=function hideMegaMenu(){var _this4=this;if(this.$scope.hasClass(classes.active)){$('body').css('position','static');this.$scope.removeClass(classes.active);if(values.isTabletOrDesktopSmall&&values.$previousCategory){values.$previousCategory.removeClass(classes.active);}
    setTimeout(function(){_this4.$scope.css('display','');$(selectors.toggleMegaMenuHamburger).removeClass(classes.megaMenuButtonOpen);_this4.$header.removeClass(classes.pageOverlay);_this4.$toggleMegaMenuHamburger.css('display','block');_this4.$toggleMegaMenuClose.css('display','none');if(values.$previousCategory){values.$previousCategory.removeClass(classes.active+' '+classes.animate);}
        if(values.$previousLink){values.$previousLink.removeClass(classes.active);}
        $(selectors.contentWrapper).removeClass(classes.animate);_this4.$categoryList.removeClass(classes.active);_this4.$scope.removeClass(classes.overlay);$('.megaMenu-nav-lvl3').remove();},500);}};MegaMenuMobileV2.prototype.openSubcategory=function openSubcategory(evt){evt.preventDefault();var $megaMenu=$('.megaMenu');var id=$(this).attr('aria-controls');var $subcategory=$('#'+id);var $previousCategory=values.$previousCategory,$previousLink=values.$previousLink;if(!$previousCategory){$subcategory.addClass(classes.active);$(this).addClass(classes.active);values.$previousCategory=$subcategory;values.$previousLink=$(this);$megaMenu.addClass(classes.overlay);}else if($previousCategory.attr('id')===id){if($previousCategory.hasClass(classes.active)){$previousCategory.removeClass(classes.active);$(this).removeClass(classes.active);$megaMenu.removeClass(classes.overlay);}else{$previousCategory.addClass(classes.active);$(this).addClass(classes.active);$megaMenu.addClass(classes.overlay);}}else{$previousLink.removeClass(classes.active);values.$previousCategory=$subcategory;values.$previousLink=$(this);if($megaMenu.hasClass(classes.overlay)){$(this).addClass(classes.active);$previousCategory.css('transition','none').removeClass(classes.active);$subcategory.css('transition','none').addClass(classes.active);setTimeout(function(){$subcategory.css('transition','');$previousCategory.css('transition','');},100);}else{$megaMenu.addClass(classes.overlay);$(this).addClass(classes.active);$previousCategory.removeClass(classes.active);$subcategory.addClass(classes.active);}}
    if(values.isMobile){$megaMenu.scrollTop(0);$(selectors.contentWrapper).addClass(classes.animate);}};MegaMenuMobileV2.prototype.closeSubcategory=function closeSubcategory(evt){evt.preventDefault();this.fireBackButtonEvent(this.giveSecondLevelBackButtonIdentifier(evt));var $subcategory=$(evt.currentTarget).parent().parent();$(selectors.contentWrapper).removeClass(classes.animate);$subcategory.removeClass(classes.active);};MegaMenuMobileV2.prototype.fireBackButtonEvent=function fireBackButtonEvent(backButtonIdentifier){Cog.fireEvent('analytics','mobileMegaMenu.backButtonClick',{actionType:'click',clickType:'internal',elementLayer1:'snippet '+this.megaMenuSnippetName,elementLayer2:'megamenu',elementLayer3:'button',itemIdentifier:backButtonIdentifier,siteSection:'MastHead MegaMenu'});};MegaMenuMobileV2.prototype.giveSecondLevelBackButtonIdentifier=function giveSecondLevelBackButtonIdentifier(ev){var tabPanelId=$(ev.target).closest('[role="tabpanel"]').attr('id');return 'Back - '+this.giveCategoryName(tabPanelId);};MegaMenuMobileV2.prototype.giveCategoryName=function giveCategoryName(tabPanelId){var $navItem=this.$scope.find('[aria-controls="'+tabPanelId+'"]');return $navItem.find('.text-wrapper').text();};MegaMenuMobileV2.prototype.addCategoryLinks=function addCategoryLinks(){var _this5=this;this.$categories.each(function(){var $this=$(this);var id=$this.attr('id');var $navItem=$('[data-category-id=#'+id+']');var link=$navItem.attr('href');var name=$navItem.find('.text-wrapper').text();var $tabContent=$this.find('.tabContent');$tabContent.prepend('<div class="megaMenu-category-lvl2"><a href="'+link+'">'+name+'</a></div>');$tabContent.prepend('<div class="megaMenu-back-lvl2"><a href="#">Back</a></div>');});this.$categories.find('.megaMenu-category-lvl2 > a').on('click',function(ev){return _this5.fireParentNavigationAnchorClick(ev);});};MegaMenuMobileV2.prototype.fireParentNavigationAnchorClick=function fireParentNavigationAnchorClick(ev){var $elementAnchor=$(ev.currentTarget);var href=$elementAnchor.attr('href');Cog.fireEvent('analytics','mobileMegaMenu.parentCategoryNavigationClick',{actionType:'click',clickType:'internal',elementLayer1:'snippet '+this.megaMenuSnippetName,elementLayer2:'megamenu',elementLayer3:'richtext',elementExtraInfo:'Parent Navigation Element',internalDestination:href,itemIdentifier:this.giveActivePanelCategoryName(),siteSection:'MastHead MegaMenu'});};MegaMenuMobileV2.prototype.addThirdLvlMenu=function addThirdLvlMenu(evt){var _this6=this;evt.preventDefault();this.fireSubcategoryClickEvent(evt);var $this=$(evt.currentTarget);var $parent=$('.megaMenu-content.is-active');var $thirdLvl=$this.parent().clone();$thirdLvl.prepend('<div class="megaMenu-back-lvl3"><a href="#">Back</a></div>');$thirdLvl.addClass('megaMenu-nav-lvl3');$thirdLvl.insertAfter($this.closest('.megaMenu-content'));$thirdLvl.css('width');$thirdLvl.addClass(classes.active);$parent.addClass(classes.animate);var $thirdLevelBackButton=$('.megaMenu-back-lvl3');$thirdLevelBackButton.on('click',function(){$thirdLvl.removeClass(classes.active);$parent.removeClass(classes.animate);setTimeout(function(){return $thirdLvl.remove();},500);});$thirdLvl.find('h3 > a').on('click',function(ev){return _this6.fireParentNavigationAnchorClick(ev);});$thirdLvl.find('li > a').on('click',function(ev){return _this6.fireThirdLevelAnchorClickEvent(ev);});$thirdLevelBackButton.on('click',function(ev){return _this6.fireThirdLevelBackButtonClickEvent(ev);});};MegaMenuMobileV2.prototype.fireSubcategoryClickEvent=function fireSubcategoryClickEvent(ev){var $elementAnchor=$(ev.currentTarget).find('a');var href=$elementAnchor.attr('href');var subcategoryLabel=$elementAnchor.text();Cog.fireEvent('analytics','mobileMegaMenu.subcategoryClick',{actionType:'click',clickType:'internal',elementLayer1:'snippet '+this.megaMenuSnippetName,elementLayer2:'megamenu',elementLayer3:'richtext',internalDestination:href,itemIdentifier:this.giveActivePanelCategoryName()+' - '+subcategoryLabel,siteSection:'MastHead MegaMenu'});};MegaMenuMobileV2.prototype.fireThirdLevelAnchorClickEvent=function fireThirdLevelAnchorClickEvent(ev){var $elementAnchor=$(ev.currentTarget);var subcategoryLabel=$elementAnchor.closest('.megaMenu-nav-lvl3').find('h3 > a').text();var href=$elementAnchor.attr('href');Cog.fireEvent('analytics','mobileMegaMenu.thirdLevelAnchorClick',{actionType:'click',href:href,elementLayer1:'snippet '+this.megaMenuSnippetName,elementLayer2:'megamenu',elementLayer3:'richtext',internalDestination:href,itemIdentifier:this.giveActivePanelCategoryName()+' - '+subcategoryLabel+' - '+$elementAnchor.text(),siteSection:'MastHead MegaMenu'});};MegaMenuMobileV2.prototype.fireThirdLevelBackButtonClickEvent=function fireThirdLevelBackButtonClickEvent(ev){this.fireBackButtonEvent(this.giveThirdLevelBackButtonIdentifier(ev));};MegaMenuMobileV2.prototype.giveThirdLevelBackButtonIdentifier=function giveThirdLevelBackButtonIdentifier(ev){var $lvl3Nav=$(ev.currentTarget).closest('.megaMenu-nav-lvl3');var subcategoryName=$lvl3Nav.find('h3 a').text();return 'Back - '+this.giveActivePanelCategoryName()+' - '+subcategoryName;};MegaMenuMobileV2.prototype.giveActivePanelCategoryName=function giveActivePanelCategoryName(){var tabPanelId=this.$categories.filter('.is-active').attr('id');return this.giveCategoryName(tabPanelId);};MegaMenuMobileV2.prototype.setMegaMenuHeight=function setMegaMenuHeight(){var topnavHeight=$(selectors.navContainer).outerHeight();var windowHeight=$(window).height();var megaMenuHeight=windowHeight-topnavHeight;this.$scope.height(megaMenuHeight);this.$categories.outerHeight(megaMenuHeight);};MegaMenuMobileV2.prototype.removeHeightSetting=function removeHeightSetting(){this.$scope.removeAttr('style');this.$categories.removeAttr('style');};MegaMenuMobileV2.prototype.isTabletOrDesktopSmallCheck=function isTabletOrDesktopSmallCheck(){if(this.$scope.hasClass('megaMenu-tabletHorizontal')){values.isTabletOrDesktopSmall=this.media.isTablet();}else{values.isTabletOrDesktopSmall=this.media.isTabletOrDesktopSmall();}};MegaMenuMobileV2.prototype.isMobileCheck=function isMobileCheck(){values.isMobile=this.media.isMobile();};MegaMenuMobileV2.prototype.attachResize=function attachResize(){var _this7=this;$(window).on('resize',_.debounce(function(){_this7.isTabletOrDesktopSmallCheck();_this7.isMobileCheck();if(values.isTabletOrDesktopSmall||values.isMobile){_this7.setMegaMenuHeight();_this7.detachEvents();_this7.attachEvents();$(document).trigger('isMobile');}else{_this7.hideMegaMenu();_this7.removeHeightSetting();_this7.detachEvents();}
    if(values.isMobile){_this7.detachPhoneEvents();_this7.attachPhoneEvents();}else{_this7.hideMegaMenu();_this7.detachPhoneEvents();}},200));};return MegaMenuMobileV2;}();api.onRegister=function(scope){new MegaMenuMobileV2(scope.$scope,this.external.status,this.external.media);};Cog.registerComponent({name:'MegaMenuMobileV2',api:api,selector:'.megaMenu',requires:[{name:'utils.status',apiId:'status'},{name:'utils.media',apiId:'media'}]});})();(function($){var api={};var values={overlayContainer:null,overlayContent:null,overlayContentInner:null,overlayBackground:null,overlayLoading:null,overlayClose:null,mobileChecked:false,mobile:false,scrollPosition:null,startingPositionTop:100,eligibilityInternalCta:null,eligibilityExternalCta:null};var selectors={eligibilityOverlayCta:'.eligibility-overlay-mse-calc-cta',eligibilityOverlayDirectCta:'.eligibility-overlay-external-calc-cta'};function EligibilityOverlay(elem,url){this.obj=elem;this.url=url;this.properties={href:$(elem).attr('href'),width:$(elem).data('overlaywidth'),extenalLink:$(elem).data('externallink')||'',label:$(elem).text()};}
EligibilityOverlay.prototype.attachEvents=function(){var self=this;var url=self.properties.href;if(url){if(!values.mobile){if(url.indexOf('.html')>-1){url=this.url.setSelector(url,'lightbox');}else if(url.substring(url.length-1)==='/'){url=url.substring(0,url.lastIndexOf('/'))+'.lightbox/';}else{url=url+'.lightbox/';}}
    $(self.obj).on('click',function(event){event.preventDefault();event.stopPropagation();if(!values.mobile){self.initOverlayContainer();self.showLoadingContainer();}
        self.visible=true;$.ajax({type:'GET',url:url,dataType:'html',success:function success(response){self.overlayBuilder(response);Cog.init({$element:values.overlayContentInner});}});self.handleEligibilityOverlayClick();});$(document).on('click touchstart','.overlay-content',function(event){event.stopPropagation();}).on('click touchstart','.overlay-background, .overlay-container, .overlay-close',function(){if(self.visible){self.hideOverlay();}}).on('keydown',function(event){if(event.keyCode===27){self.hideOverlay();}});}};EligibilityOverlay.prototype.handleEligibilityOverlayClick=function(){var self=this;Cog.fireEvent('analytics','eligibilityOverlay.triggerAnchorClick',{actionType:'click',clickType:(self.properties.extenalLink.indexOf('/redir/')>=0?'externalPaid':'externalUnpaid')+'_Eligibility_Overlay_Triggered',siteSection:'mainSection',itemIdentifier:self.properties.label,destination:self.properties.extenalLink,target:self.obj});};EligibilityOverlay.prototype.handleEligibilityOverlayInternalButtonClick=function(element){var self=this;Cog.fireEvent('analytics','eligibilityOverlay.internalButttonClick',{actionType:'click',target:element,trigger:self.obj});};EligibilityOverlay.prototype.handleEligibilityOverlayExternalButtonClick=function(element){var self=this;Cog.fireEvent('analytics','eligibilityOverlay.externalButttonClick',{actionType:'click',target:element,trigger:self.obj});};EligibilityOverlay.prototype.setEligibilityExternalUrl=function(){values.eligibilityExternalCta.attr('href',this.properties.extenalLink);};EligibilityOverlay.prototype.setEligibilityExternalIdentifier=function(){values.eligibilityExternalCta.attr('data-item-identifier',this.properties.label);};EligibilityOverlay.prototype.bindEligibilityOverlayElements=function(){var _this=this;values.eligibilityExternalCta=$(selectors.eligibilityOverlayDirectCta);values.eligibilityInternalCta=$(selectors.eligibilityOverlayCta);this.setEligibilityExternalUrl();this.setEligibilityExternalIdentifier();values.eligibilityInternalCta.on('click',function(event){_this.handleEligibilityOverlayInternalButtonClick(event.target);});values.eligibilityExternalCta.on('click',function(event){_this.handleEligibilityOverlayExternalButtonClick(event.target);});};EligibilityOverlay.prototype.initOverlayContainer=function(){var body=$('body');var overlayBackgroundHtml="<div class='overlay-background'></div>";var overlayContainerHtml='<div class=\'overlay-container eligibility-overlay-container\'>\n                    <div class=\'overlay-content\'>\n                        <div tabindex=\'0\' class=\'overlay-close\'></div>\n                        <div class=\'overlay-loading\'></div>\n                        <div class=\'overlay-content-inner\'></div>\n                    </div>\n                </div>';if(!values.overlayContainer){body.append(overlayBackgroundHtml,overlayContainerHtml);values.overlayBackground=$('.overlay-background');values.overlayContainer=$('.overlay-container');values.overlayContent=$('.overlay-content');values.overlayContentInner=$('.overlay-content-inner');values.overlayLoading=$('.overlay-loading');values.overlayClose=$('.overlay-close');}else{values.overlayContentInner.empty();}};EligibilityOverlay.prototype.showLoadingContainer=function(){values.overlayClose.hide();values.overlayBackground.show();values.overlayContainer.css({top:'50px'});values.overlayContainer.show();values.overlayLoading.show();};EligibilityOverlay.prototype.overlayBuilder=function(response){var self=this;if(values.mobile){window.open(self.properties.href,'_blank');}else{self.showOverlay(response);}};EligibilityOverlay.prototype.showOverlay=function(response){var overlayWidth=this.properties.width;values.overlayLoading.hide();values.overlayClose.show();values.scrollPosition=$(window).scrollTop();$('body').addClass('overlayVisible');values.overlayContent.removeClass('lightbox--full-content-size lightbox--default-size');values.overlayContent.css('max-width','none');if(!overlayWidth){values.overlayContent.addClass('lightbox--full-content-size');}else{values.overlayContent.addClass('lightbox--default-size');}
    values.overlayContentInner.append(response);if(values.overlayContentInner.find('.video').length){values.overlayContent.css({width:overlayWidth});}else{values.overlayContent.css({'max-width':overlayWidth});}
    $('.container-fluid').on('scroll',function(e){e.preventDefault();e.stopPropagation();return false;});this.bindEligibilityOverlayElements();};EligibilityOverlay.prototype.hideOverlay=function(){values.overlayContainer.fadeOut();values.overlayBackground.fadeOut();if(this.visible){this.visible=false;Cog.fireEvent('overlay','close');$('body').removeClass('overlayVisible');}
    $('.container-fluid').off('scroll');$(window).scrollTop(values.scrollPosition);};function checkMobile(){return Cog.Cookie.read('device-group')==='mobile';}
api.onRegister=function(elements){var self=this;if(!values.mobileChecked){values.mobile=checkMobile();values.mobileChecked=true;}
    elements.$scope.each(function(){var overlay=new EligibilityOverlay(this,self.external.url);overlay.attachEvents();});};Cog.registerComponent({name:'EligibilityOverlay',api:api,selector:'a.eligibility-overlay-trigger',requires:[{name:'utils.status',apiId:'status'},{name:'utils.url',apiId:'url'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var classes={resultsIframe:'#survey-results',pollClosedMessage:'.sg-disqualify',showResultsLink:'#show-results-link'};var SurveyGizmoPoll=function(){function SurveyGizmoPoll($element){_classCallCheck(this,SurveyGizmoPoll);this.$surveyGizmoPoll=$element;this.bindUIElements();this.bindUIEvents();}
SurveyGizmoPoll.prototype.bindUIElements=function bindUIElements(){this.$resultsIframe=this.$surveyGizmoPoll.find(classes.resultsIframe).first();this.$showResultsLink=this.$surveyGizmoPoll.find(classes.showResultsLink).first();this.$showResultsLabel=this.$showResultsLink.data('show-results-label');this.$hideResultsLabel=this.$showResultsLink.data('hide-results-label');};SurveyGizmoPoll.prototype.bindUIEvents=function bindUIEvents(){var _this=this;var comp=this;var count=0;var checkSurveyOpened=function checkSurveyOpened(){if(count<=5){if(comp.$surveyGizmoPoll.find(classes.pollClosedMessage).length>0){comp.$resultsIframe.show();comp.$showResultsLink.hide();}else{count++;setTimeout(checkSurveyOpened,1000);}}};checkSurveyOpened();this.$showResultsLink.on('click',function(){if(comp.$resultsIframe.is(':visible')){comp.$resultsIframe.hide();comp.$showResultsLink.text(_this.$showResultsLabel);}else{comp.$resultsIframe.show();comp.$showResultsLink.text(_this.$hideResultsLabel);}
    return false;});};return SurveyGizmoPoll;}();api.onRegister=function(scope){new SurveyGizmoPoll(scope.$scope);};Cog.registerComponent({name:'surveyGizmoPoll',api:api,selector:'.surveyGizmoPoll'});})();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={},sharedApi={'pageEvent':null},dataLayer=window.dataLayer,siteSectionProvider=null,layerProvider=null;var Tracker=function(){function Tracker(){_classCallCheck(this,Tracker);this.logger=Cog.logger('AnalyticsContainer');this.bindEvents();}
Tracker.prototype.bindEvents=function bindEvents(){Cog.addListener('analytics','track',this._pushToDataLayerIfAvailableWithCallback,{scope:this});};Tracker.prototype._pushToDataLayerIfAvailable=function _pushToDataLayerIfAvailable(analyticsObject){this.logger.info("GTM event {{0}}",analyticsObject);if(!_.isUndefined(dataLayer)){dataLayer.push(analyticsObject);}};Tracker.prototype._pushToDataLayerIfAvailableWithCallback=function _pushToDataLayerIfAvailableWithCallback(ev){this._pushToDataLayerIfAvailable(ev.eventData.analyticsObject);if(_.isUndefined(dataLayer)&&_.isFunction(ev.eventData.callback)){ev.eventData.callback();}};return Tracker;}();var PageEvent=function(){function PageEvent(build){_classCallCheck(this,PageEvent);this.event=build.event;this.actionType=build.actionType;this.clickType=build.clickType;this.pageElement=build.pageElement;if(!_.isUndefined(build.productDetails)){this.productDetails=build.productDetails;}
if(!_.isUndefined(build.formEntry)){this.formEntry=build.formEntry;}
if(!_.isUndefined(build.searchCriteria)){this.searchCriteria=build.searchCriteria;}
if(!_.isUndefined(build.deal)){this.deal=build.deal;}
if(!_.isUndefined(build.product)){this.product=build.product;}}
_createClass(PageEvent,null,[{key:'Builder',get:function get(){var Builder=function(){function Builder(actionType,$target){_classCallCheck(this,Builder);this.event="pageEvent";this.actionType=actionType;this.$target=$target;this.clickType=undefined;this.pageElement=undefined;this.productDetails=undefined;this.formEntry=undefined;this.searchCriteria=undefined;this.deal=undefined;}
        Builder.prototype.withClickType=function withClickType(clickType){this.clickType=clickType;return this;};Builder.prototype.withSiteSection=function withSiteSection(siteSection){if(!_.isUndefined(siteSection)){var pageElement=this.hiddenPageElement();pageElement.siteSection=siteSection;this.pageElement=pageElement;}
            return this;};Builder.prototype.withElementLayers=function withElementLayers(elementLayers){for(var i=0;i<=4;i++){this.withElementLayer(elementLayers[i],i+1);}
            return this;};Builder.prototype.withElementLayer=function withElementLayer(elementLayer,layerNo){if(!_.isUndefined(elementLayer)){var pageElement=this.hiddenPageElement();pageElement['elementLayer'+layerNo]=elementLayer;this.pageElement=pageElement;}
            return this;};Builder.prototype.withAppendedElementLayer=function withAppendedElementLayer(elementLayer){if(!_.isUndefined(elementLayer)){this.elementLayerToAppend=elementLayer;}
            return this;};Builder.prototype.withLastElementLayer=function withLastElementLayer(elementLayer){if(!_.isUndefined(elementLayer)){this.lastElementLayer=elementLayer;}
            return this;};Builder.prototype.withItemIdentifier=function withItemIdentifier(itemIdentifier){if(!_.isUndefined(itemIdentifier)){var pageElement=this.hiddenPageElement();pageElement.itemIdentifier=itemIdentifier;this.pageElement=pageElement;}
            return this;};Builder.prototype.withElementExtraInfo=function withElementExtraInfo(elementExtraInfo){if(!_.isUndefined(elementExtraInfo)){var pageElement=this.hiddenPageElement();pageElement.elementExtraInfo=elementExtraInfo;this.pageElement=pageElement;}
            return this;};Builder.prototype.withListLocation=function withListLocation(listLocation){if(!_.isUndefined(listLocation)){var pageElement=this.hiddenPageElement();pageElement.listLocation=listLocation;this.pageElement=pageElement;}
            return this;};Builder.prototype.withDestination=function withDestination(destination){if(!_.isUndefined(destination)){var pageElement=this.hiddenPageElement();pageElement.destination=destination;this.pageElement=pageElement;}
            return this;};Builder.prototype.withInternalDestination=function withInternalDestination(internalDestination){if(!_.isUndefined(internalDestination)){var pageElement=this.hiddenPageElement();pageElement.internalDestination=internalDestination;this.pageElement=pageElement;}
            return this;};Builder.prototype.withPaginationNumber=function withPaginationNumber(paginationNumber){if(!_.isUndefined(paginationNumber)){var pageElement=this.hiddenPageElement();pageElement.paginationNumber=paginationNumber;this.pageElement=pageElement;}
            return this;};Builder.prototype.withLinkID=function withLinkID(linkID){if(!_.isUndefined(linkID)){var pageElement=this.hiddenPageElement();pageElement.linkID=linkID;this.pageElement=pageElement;}
            return this;};Builder.prototype.withSearchCriteria=function withSearchCriteria(searchCriteria){this.searchCriteria=searchCriteria;return this;};Builder.prototype.withSearchTerm=function withSearchTerm(searchTerm){if(!_.isUndefined(searchTerm)){var formEntry=this.hiddenFromEntry();formEntry.searchTerm=searchTerm;this.formEntry=formEntry;}
            return this;};Builder.prototype.withSearchDropdownSelection=function withSearchDropdownSelection(searchDropdownSelection){if(!_.isUndefined(searchDropdownSelection)){var formEntry=this.hiddenFromEntry();formEntry.searchDropdownSelection=searchDropdownSelection;this.formEntry=formEntry;}
            return this;};Builder.prototype.withExtraObject=function withExtraObject(extraObject){if(!_.isUndefined(extraObject)){_.assign(this,extraObject);}
            return this;};Builder.prototype.hiddenPageElement=function hiddenPageElement(){var pageElement=this.pageElement;if(_.isUndefined(this.pageElement)){pageElement={"siteSection":undefined,"elementLayer1":undefined,"elementLayer2":undefined,"elementLayer3":undefined,"elementLayer4":undefined,"elementLayer5":undefined,"itemIdentifier":undefined,"elementExtraInfo":undefined,"listLocation":undefined,"destination":undefined,"internalDestination":undefined,"paginationNumber":undefined,"linkID":undefined};}
            return pageElement;};Builder.prototype.hiddenFromEntry=function hiddenFromEntry(){var formEntry=this.formEntry;if(_.isUndefined(this.formEntry)){formEntry={"searchTerm":undefined,"searchDropdownSelection":undefined};}
            return formEntry;};Builder.prototype.setDefaults=function setDefaults(){if(this.$target){if(_.isUndefined(this.pageElement)||_.isUndefined(this.pageElement.siteSection)){this.withSiteSection(siteSectionProvider.getSiteSectionOf(this.$target));}
            if(_.isUndefined(this.pageElement)||_.isUndefined(this.pageElement.elementLayer1)){var layers=layerProvider.getLayers(this.$target);if(!_.isUndefined(this.lastElementLayer)){layers[layers.length-1]=this.lastElementLayer;}
                if(!_.isUndefined(this.elementLayerToAppend)){layers.push(this.elementLayerToAppend);}
                this.withElementLayers(layers);}
            delete this.$target;}};Builder.prototype.build=function build(){this.setDefaults();return new PageEvent(this);};return Builder;}();return Builder;}}]);return PageEvent;}();api.init=function(){sharedApi.pageEvent=PageEvent;siteSectionProvider=this.external.analyticsSiteSectionProvider.siteSectionProvider;layerProvider=this.external.analyticsLayerProvider.layerProvider;new Tracker();};Cog.registerStatic({name:'analyticsModule',api:api,sharedApi:sharedApi,requires:[{name:'analyticsSiteSectionProvider',apiId:'analyticsSiteSectionProvider'},{name:'analyticsLayerProvider',apiId:'analyticsLayerProvider'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={},pageEvent=null;var BackToTopAnalytics=function(){function BackToTopAnalytics(){_classCallCheck(this,BackToTopAnalytics);this.bindEvents();}
BackToTopAnalytics.prototype.bindEvents=function bindEvents(){Cog.addListener('analytics','guide.backToTopClick',this.backToTopClicked,{scope:this});};BackToTopAnalytics.prototype.backToTopClicked=function backToTopClicked(ev){var $target=ev.eventData.$target;var analyticsObject=new pageEvent.Builder('click',$target).withClickType('pageAction').withElementLayer('Sharing',1).withItemIdentifier($target.text()).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};return BackToTopAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;new BackToTopAnalytics();};Cog.registerStatic({name:'analyticsBackToTopModule',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={},external={analyticsModule:null,analyticsHomepageModule:null,analyticsTipPageModule:null},pageEvent=null,clickTypeProvider=null,homepageAnalytics=null,tipPageAnalytics=null;var ClickableAnalytics=function(){function ClickableAnalytics($element){_classCallCheck(this,ClickableAnalytics);this.logger=Cog.logger('AnalyticsContainer');this.bindEvents();}
ClickableAnalytics.prototype.bindEvents=function bindEvents(){Cog.addListener('analytics','clickable.click',this.customClick,{scope:this});$('body').on('click','a',this.linkClick.bind(this));};ClickableAnalytics.prototype.customClick=function customClick(ev){this.trackClick(ev.eventData.$target,ev.eventData.href,ev.eventData.elementExtraInfo,ev);};ClickableAnalytics.prototype.linkClick=function linkClick(ev){var $target=$(ev.currentTarget);var href=$target.attr('href');if(this.isCustomClick(href)||this.isCustomListClick($target)||this.isSocialShareDealClick($target)||this.isProductBoxClick($target)||this.isDealsTileClick($target)||this.isMegaMenuClick($target)){return;}
    this.trackClick($target,href,undefined,ev);};ClickableAnalytics.prototype.trackClick=function trackClick($target,href,elementExtraInfo,ev){var builderObject=new pageEvent.Builder('click',$target).withClickType(clickTypeProvider.getClickType(href)).withDestination(clickTypeProvider.getDestination(href)).withItemIdentifier(this.getItemIdentifier($target,href)).withLinkID(this.getLinkID($target)).withElementExtraInfo(elementExtraInfo);if(homepageAnalytics.isHomepage){builderObject=homepageAnalytics.attachHomepageAnalytics(builderObject,ev,$target,elementExtraInfo);}
    if(tipPageAnalytics.isTipPage){builderObject.withInternalDestination(clickTypeProvider.getInternalDestination(href));builderObject=tipPageAnalytics.attachTipPageAnalytics(builderObject,ev,$target);}
    var analyticsObject=builderObject.build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};ClickableAnalytics.prototype.getLinkID=function getLinkID($target){return $target.data('linkId');};ClickableAnalytics.prototype.getItemIdentifier=function getItemIdentifier($target,href){var itemIdentifier=$target.text().trim()||(href.indexOf('#')===0?href.substring(1):'')||$target.attr('title');if(!itemIdentifier){var linkImage=$target.find('img');itemIdentifier=linkImage.length?linkImage.attr('alt')||linkImage.attr('title'):'';}
    return itemIdentifier;};ClickableAnalytics.prototype.isCustomClick=function isCustomClick(href){var customLinks=['#tab','#accordion'];var customLinksMatch=_.find(customLinks,function(item){return href&&href.indexOf(item)===0;});return customLinksMatch!==undefined;};ClickableAnalytics.prototype.isCustomListClick=function isCustomListClick($target){var customListsClasses=['.articleList-list','.page-list','.tip-box-general-list','.tip-box-main-list','.tools-list-items','.promoBox','.popularGuides','.most-popular-slider'];var customListsMatch=_.find(customListsClasses,function(clazz){return $target.closest(clazz).length>0;});return customListsMatch!==undefined;};ClickableAnalytics.prototype.isSocialShareDealClick=function isSocialShareDealClick($target){return $target.closest('.deals-full-list-article .share-this-bottom').length>0;};ClickableAnalytics.prototype.isProductBoxClick=function isProductBoxClick($target){return $target.closest('.composite-productboxes').length>0;};ClickableAnalytics.prototype.isDealsTileClick=function isDealsTileClick($target){return $target.closest('.dealsCompactList-article').length>0||$target.closest('.deals-full-list-article').length>0||$target.closest('.dealsPriorityList-article').length>0;};ClickableAnalytics.prototype.isMegaMenuClick=function isMegaMenuClick($target){return $target.closest('.top-nav-v2').length>0||$target.closest('.megaMenu').length>0;};return ClickableAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;homepageAnalytics=this.external.analyticsHomepageModule;tipPageAnalytics=this.external.analyticsTipPageModule;new ClickableAnalytics();};Cog.registerStatic({name:'analyticsClickableModule',api:api,externalApi:external,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'},{name:'analyticsHomepageModule',apiId:'analyticsHomepageModule'},{name:'analyticsTipPageModule',apiId:'analyticsTipPageModule'}]});})(Cog.jQuery(),_);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var sharedApi={clickTypeProvider:null};var AnalyticsClickTypeProvider=function(){function AnalyticsClickTypeProvider(){_classCallCheck(this,AnalyticsClickTypeProvider);}
AnalyticsClickTypeProvider.prototype.getClickType=function getClickType(href){var clickType='';if(this.isPageAction(href)){clickType='pageAction';}else if(this.isPaid(href)){clickType='externalPaid';}else if(this.isInternal(href)){clickType='internal';}else{clickType='externalUnpaid';}
    return clickType;};AnalyticsClickTypeProvider.prototype.getDestination=function getDestination(href){var destination='';if(this.isPaid(href)){destination=href.substring(href.indexOf('/redir/')+'/redir/'.length);var queryIndex=destination.indexOf('?');if(queryIndex>0){destination=destination.substring(0,queryIndex);}}else if(!this.isPageAction(href)&&!this.isInternal(href)){destination=href;}
    return destination;};AnalyticsClickTypeProvider.prototype.getInternalDestination=function getInternalDestination(href){return this.isInternal(href)?href:'';};AnalyticsClickTypeProvider.prototype.isPageAction=function isPageAction(href){var pageActions=['#','mailto:','javascript:'];var pageActionsMatch=_.find(pageActions,function(item){return href.indexOf(item)===0;});return pageActionsMatch!==undefined;};AnalyticsClickTypeProvider.prototype.isPaid=function isPaid(href){return href.indexOf('/redir/')>=0;};AnalyticsClickTypeProvider.prototype.isInternal=function isInternal(href){var internalDomains=['www.megashopbot.com','www.mobilevaluer.com','www.tunechecker.com','travelmoneymax.com','mse-demo.local','moneysavingexpert.com'];var indexOfQueryString=href.indexOf('?');var internalDomainMatch=_.find(internalDomains,function(item){var index=href.indexOf(item);return index>=0&&(indexOfQueryString===-1||index<indexOfQueryString);});return href[0]==='/'||internalDomainMatch!==undefined;};return AnalyticsClickTypeProvider;}();api.init=function(){sharedApi.clickTypeProvider=new AnalyticsClickTypeProvider();};Cog.registerStatic({name:'analyticsClickTypeProvider',api:api,sharedApi:sharedApi});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var CollapsibleAnalytics=function(){function CollapsibleAnalytics($element){_classCallCheck(this,CollapsibleAnalytics);this.bindEvents();}
CollapsibleAnalytics.prototype.bindEvents=function bindEvents(){Cog.addListener('tab','change',this.collapsibleClick,{scope:this});Cog.addListener('accordion','change',this.collapsibleClick,{scope:this});};CollapsibleAnalytics.prototype.collapsibleClick=function collapsibleClick(ev){if(!ev.eventData.manual){return;}
    var $target=ev.eventData.$target;Cog.fireEvent('analytics','clickable.click',{$target:$target,elementExtraInfo:ev.eventData.elementExtraInfo,href:$target.attr('href')});};return CollapsibleAnalytics;}();api.init=function(){new CollapsibleAnalytics();};Cog.registerStatic({name:'analyticsCollapsibleModule',api:api});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var selectors={compact:{dealsList:'.dealsCompactList',dealsListItem:'.dealsCompactList-article'},full:{dealsList:'.dealsFullList',dealsListItem:'.deals-full-list-article'},priority:{dealsList:'.dealsPriorityList-list',dealsListItem:'.dealsPriorityList-article'}};var tagToElementName={'A':'text','H3':'text','IMG':'image'};var dealFullParts={HEADLINE:'headline',BRAND_IMAGE:'brand_image',MORE_INFO:'more_info',CTA:'cta_button',DEAL_CONTENT:'body_content'};var tagToDealElement={'H3':dealFullParts.HEADLINE,'IMG':dealFullParts.BRAND_IMAGE};var api={},pageEvent=null,clickTypeProvider=null;var DealsListsAnalytics=function(){function DealsListsAnalytics(){_classCallCheck(this,DealsListsAnalytics);this.bindElements();this.bindEvents();}
DealsListsAnalytics.prototype.bindElements=function bindElements(){this.$dealsCompactList=$(selectors.compact.dealsList);this.$compactListAnchors=this.$dealsCompactList.find('a');this.$dealsFullList=$(selectors.full.dealsList);this.$fullListAnchors=this.$dealsFullList.find('a');this.$dealsPriorityList=$(selectors.priority.dealsList);this.$priorityListAnchors=this.$dealsPriorityList.find('a');};DealsListsAnalytics.prototype.bindEvents=function bindEvents(){var _this=this;this.$compactListAnchors.on('click',function(ev){return _this.dealsListTileClick(ev,selectors.compact);});this.$fullListAnchors.on('click',function(ev){return _this.dealsListTileClick(ev,selectors.full);});this.$priorityListAnchors.on('click',function(ev){return _this.dealsListTileClick(ev,selectors.priority);});};DealsListsAnalytics.prototype.dealsListTileClick=function dealsListTileClick(ev,selectors){var $currentTarget=$(ev.currentTarget);if($currentTarget.closest('.share-section').length>0||this.isAccordionPanel($currentTarget)||this.isCompactListCta($currentTarget)){return;}
    var $target=$(ev.target);var analyticsObject=this.createDealAnalyticsObject($currentTarget,$target,selectors);Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};DealsListsAnalytics.prototype.isAccordionPanel=function isAccordionPanel($currentTarget){return this.containsClass($currentTarget,'accordion-title-link');};DealsListsAnalytics.prototype.containsClass=function containsClass($currentTarget,clazz){var classes=$currentTarget.attr('class');return classes?classes.split().indexOf(clazz)!==-1:false;};DealsListsAnalytics.prototype.isCompactListCta=function isCompactListCta($currentTarget){return this.containsClass($currentTarget,'dealsCompactList-cta');};DealsListsAnalytics.prototype.createDealAnalyticsObject=function createDealAnalyticsObject($currentTarget,$target,selectors){var href=$currentTarget.attr('href');var itemIdentifier=this.isImage($target)?$target.attr('alt'):$currentTarget.text().trim();var builder=new pageEvent.Builder('click',$currentTarget).withClickType(clickTypeProvider.getClickType(href)).withItemIdentifier(itemIdentifier).withDestination(clickTypeProvider.getDestination(href)).withElementExtraInfo(this.getElementExtraInfo($currentTarget,$target)).withListLocation(this.getDealTileLocation($currentTarget,selectors)).withExtraObject(this.getAnalyticsData($currentTarget,selectors));if(this.isDealsFullList($currentTarget)){var clickedPart=this.recognizeClickedDealPart($currentTarget,$target);if(clickedPart===dealFullParts.MORE_INFO){builder.withLastElementLayer(clickedPart);}else{builder.withAppendedElementLayer(clickedPart);}}
    return builder.build();};DealsListsAnalytics.prototype.isImage=function isImage($target){return $target.prop('tagName')==='IMG';};DealsListsAnalytics.prototype.recognizeClickedDealPart=function recognizeClickedDealPart($currentTarget,$target){var clickedPart=dealFullParts.DEAL_CONTENT;if($currentTarget.closest('.deal-header').length>0){clickedPart=tagToDealElement[this.tagName($target)];}else if($currentTarget.closest('.accordion-container').length>0){clickedPart=dealFullParts.MORE_INFO;}else if(this.isCta($currentTarget)){clickedPart=dealFullParts.CTA;}
    return clickedPart;};DealsListsAnalytics.prototype.tagName=function tagName($element){return $element.prop('tagName');};DealsListsAnalytics.prototype.getElementExtraInfo=function getElementExtraInfo($currentTarget,$target){var elementFromTarget=this.getElementFrom($target);var elementName=elementFromTarget?elementFromTarget:this.getElementFrom($currentTarget);return this.isCta($currentTarget)?'cta':elementName;};DealsListsAnalytics.prototype.getElementFrom=function getElementFrom($target){return tagToElementName[this.tagName($target)];};DealsListsAnalytics.prototype.isCta=function isCta($currentTarget){var classAttr=$currentTarget.attr("class");return classAttr?this.hasProductBoxButtonClass(classAttr):false;};DealsListsAnalytics.prototype.hasProductBoxButtonClass=function hasProductBoxButtonClass(classAttr){var result=false;var classes=classAttr.split(' ');for(var _iterator=classes,_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++];}else{_i=_iterator.next();if(_i.done)break;_ref=_i.value;}
    var clazz=_ref;if(clazz.indexOf('button-primary')!==-1){result=true;break;}}
    return result;};DealsListsAnalytics.prototype.getDealTileLocation=function getDealTileLocation($target,selectors){var $dealElement=$target.closest(selectors.dealsListItem);return $dealElement.parent().find(selectors.dealsListItem).index($dealElement)+1;};DealsListsAnalytics.prototype.getAnalyticsData=function getAnalyticsData($currentTarget,selectors){var $listItem=$currentTarget.closest(selectors.dealsListItem);return{deal:{'id':this.dealId($listItem),'headline':this.headline($listItem),'brand':this.brand($listItem),'expiry':this.expiry($listItem)}};};DealsListsAnalytics.prototype.dealId=function dealId($listItem){return $listItem.data('deal-id');};DealsListsAnalytics.prototype.headline=function headline($listItem){return $listItem.data('deal-headline');};DealsListsAnalytics.prototype.brand=function brand($listItem){return $listItem.data('deal-brand');};DealsListsAnalytics.prototype.expiry=function expiry($listItem){return $listItem.data('deal-expiry');};DealsListsAnalytics.prototype.isDealsFullList=function isDealsFullList($currentTarget){return $currentTarget.closest(selectors.full.dealsList).length>0;};return DealsListsAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;new DealsListsAnalytics();};Cog.registerStatic({name:'analyticsDealsListsModule',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var pageEvent=null;var clickTypeProvider=null;var clickTypes={externalPaid:'externalPaid',externalUnpaid:'externalUnpaid'};var siteSections={sectionExternalPaid:'Eligibility_Overlay_externalPaid',sectionExternalUnPaid:'Eligibility_Overlay_externalUnPaid'};var EligibilityOverlayAnalytics=function(){function EligibilityOverlayAnalytics(){_classCallCheck(this,EligibilityOverlayAnalytics);this.bindEvents();this.isExternalPaid=false;}
EligibilityOverlayAnalytics.prototype.bindEvents=function bindEvents(){Cog.addListener('analytics','eligibilityOverlay.triggerAnchorClick',this.eligibilityOverlayTriggerClickHandler,{scope:this});Cog.addListener('analytics','eligibilityOverlay.internalButttonClick',this.eligibilityOverlayInternalButtonClickHandler,{scope:this});Cog.addListener('analytics','eligibilityOverlay.externalButttonClick',this.eligibilityOverlayExternalButtonClickHandler,{scope:this});};EligibilityOverlayAnalytics.prototype.eligibilityOverlayTriggerClickHandler=function eligibilityOverlayTriggerClickHandler(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType,$(data.target)).withClickType(data.clickType).withItemIdentifier(data.itemIdentifier).withSiteSection(data.siteSection).withDestination(clickTypeProvider.getDestination(data.destination)).build();this.isExternalPaid=clickTypeProvider.isPaid(data.destination);Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};EligibilityOverlayAnalytics.prototype.eligibilityOverlayInternalButtonClickHandler=function eligibilityOverlayInternalButtonClickHandler(ev){var data=ev.eventData;var $internalButton=$(data.target);var analyticsObject=new pageEvent.Builder(data.actionType,$(data.trigger)).withClickType(clickTypeProvider.getClickType($internalButton.attr('href'))).withSiteSection(this.isExternalPaid?siteSections.sectionExternalPaid:siteSections.sectionExternalUnPaid).withItemIdentifier($internalButton.text()).withDestination('').build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};EligibilityOverlayAnalytics.prototype.eligibilityOverlayExternalButtonClickHandler=function eligibilityOverlayExternalButtonClickHandler(ev){var data=ev.eventData;var $externalButton=$(data.target);var analyticsObject=new pageEvent.Builder(data.actionType,$(data.trigger)).withClickType(this.isExternalPaid?clickTypes.externalPaid:clickTypes.externalUnpaid).withSiteSection(this.isExternalPaid?siteSections.sectionExternalPaid:siteSections.sectionExternalUnPaid).withItemIdentifier($(data.trigger).text()).withDestination(clickTypeProvider.getDestination($externalButton.attr('href'))).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};return EligibilityOverlayAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;new EligibilityOverlayAnalytics();};Cog.registerStatic({name:'analyticsEligibilityOverlayModule',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var pageEvent=null;var GuidePageNavigation=function(){function GuidePageNavigation(){_classCallCheck(this,GuidePageNavigation);this.linkType={topLevelLink:'Headline',secondLevelLink:'SubHeadline'};this.bindEvents();}
GuidePageNavigation.prototype.bindEvents=function bindEvents(){Cog.addListener('analytics','guidePageNavigation.topLevelNavigationClick',this.handleTopLevelLinkClick(),{scope:this});Cog.addListener('analytics','guidePageNavigation.secondLevelNavigationClick',this.handleSecondLevelLinkClick(),{scope:this});Cog.addListener('analytics','guidePageNavigation.toggleSecondLevelClick',this.handleExpandCollapseClick,{scope:this});};GuidePageNavigation.prototype.handleLinkClick=function handleLinkClick(linkType){return function(event){var _event$eventData=event.eventData,$target=_event$eventData.$target,index=_event$eventData.index;var linkText=$target.text()||'';var linkHref=$target.attr('href');var analyticsObject=new pageEvent.Builder('click',$target).withClickType('pageAction').withSiteSection('In Page Navigation').withElementLayer('In this guide',1).withElementLayer(linkType,2).withElementLayer('jumplink',3).withElementLayer(index,4).withItemIdentifier(linkText.trim()).withInternalDestination(linkHref).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};};GuidePageNavigation.prototype.handleExpandCollapseClick=function handleExpandCollapseClick(event){var _event$eventData2=event.eventData,$target=_event$eventData2.$target,index=_event$eventData2.index,expanded=_event$eventData2.expanded;var actionType=expanded?'collapse':'expand';var linkText=$target.text()||'';var linkHref=$target.attr('href');var analyticsObject=new pageEvent.Builder('click').withClickType(actionType).withSiteSection('In Page Navigation').withElementLayer('In this guide',1).withElementLayer(this.linkType.topLevelLink,2).withElementLayer(actionType,3).withElementLayer(index,4).withItemIdentifier(linkText.trim()).withInternalDestination(linkHref).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};GuidePageNavigation.prototype.handleTopLevelLinkClick=function handleTopLevelLinkClick(){return this.handleLinkClick(this.linkType.topLevelLink);};GuidePageNavigation.prototype.handleSecondLevelLinkClick=function handleSecondLevelLinkClick(){return this.handleLinkClick(this.linkType.secondLevelLink);};return GuidePageNavigation;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;new GuidePageNavigation();};Cog.registerStatic({name:'analyticsGuidePageNavigation',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'}]});})(Cog.jQuery());(function($){var sharedApi={isHomepage:false,attachHomepageAnalytics:null};sharedApi.isHomepage=$('body.layout-homepage.template-homepage').length===1;sharedApi.attachHomepageAnalytics=function(builder,event,$target,elementExtraInfo){var parsedElementExtraInfo=elementExtraInfo||figureOutElementExtraInfo(event);return builder.withListLocation(getListLocation($target)).withElementExtraInfo(parsedElementExtraInfo);};function figureOutElementExtraInfo(ev){var $target=$(ev.target);var elementExtraInfo='text';if($target&&$target.prop('tagName')==='IMG'){elementExtraInfo=$(ev.currentTarget).hasClass('video-article')?'video':'image';}
return elementExtraInfo;}
function getListLocation($target){var itemSelector=void 0;var parentSelector=void 0;var $listItem=void 0;if(isTrendingItem($target)||isTipBoxItem($target)||isSectionGuideItem($target)){itemSelector='li';}else if(isHotDealItem($target)){itemSelector='.hotDealsItem';}else if(isPriorityDealItem($target)){itemSelector='.dealsPriorityList-article';}
    $listItem=$target.closest(itemSelector);if($listItem.length===1){return $listItem.parent().children(itemSelector).index($listItem[0])+1;}
    $listItem=$target.closest(itemSelector);if($listItem.length===1){return $listItem.closest(parentSelector).find(itemSelector).index($listItem[0])+1;}
    if(isSectionGuideHeaderItem($target)){return 0;}}
function isInPromoBox($target){return $target.closest('.promoBox').length>0;}
function isTrendingItem($target){return $target.closest('.trending-items').length>0;}
function isTipBoxItem($target){return $target.closest('.tip-box-general-scroll, .tip-box-main').length>0;}
function isHotDealItem($target){return $target.closest('.hotDealsItem').length>0;}
function isPriorityDealItem($target){return $target.closest('.dealsPriorityList-article').length>0;}
function isInMartinsBlog($target){return $target.closest("[data-id='martins-blog']").length>0;}
function isSectionGuideHeaderItem($target){var $guideSection=$target.closest("[data-id^='section-guides-']");var isNotInPromoBoxItem=$target.closest('.promoBoxItem').length===0;var isNotInList=$target.closest('ul > li').length===0;return $guideSection.length>0&&isNotInPromoBoxItem&&isNotInList;}
function isSectionGuideItem($target){var $guideSection=$target.closest("[data-id^='section-guides-']");var isInList=$target.closest('ul > li').length>0;return $guideSection.length>0&&isInList;}
Cog.registerStatic({name:'analyticsHomepageModule',api:{},sharedApi:sharedApi});})(Cog.jQuery(),_);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={},sharedApi={layerProvider:null},analyticsSelector='analytics-';var AnalyticsLayerProvider=function(){function AnalyticsLayerProvider(){_classCallCheck(this,AnalyticsLayerProvider);}
AnalyticsLayerProvider.getLayers=function getLayers($element){return this.getStaticLayers($element)||this.getCalculatedLayers($element);};AnalyticsLayerProvider.getStaticLayers=function getStaticLayers($element){return $element.closest('.tip-email-popup').length===1?['tipSignUpBanner']:undefined;};AnalyticsLayerProvider.getCalculatedLayers=function getCalculatedLayers($element){var layers=_.map($element.parents(),function(item){return this.getAnalyticsId($(item));}.bind(this));layers=this.invertArray(layers);layers.push(this.addAnalyticsIdForCurrent($element));layers=_.filter(layers,function(item){return item!=='';});if(this.isInSectionGuides($element)){layers=this.replaceWithSectionGuidesLayers($element);}else{layers=this.limitLayers(layers);}
    return layers;};AnalyticsLayerProvider.invertArray=function invertArray(array){var newArray=[];_.eachRight(array,function(it){return newArray.push(it);});return newArray;};AnalyticsLayerProvider.limitLayers=function limitLayers(layers){var newLayers=[];if(layers.length>5){newLayers.push(layers[0]);for(var i=layers.length-4;i<layers.length;i++){newLayers.push(layers[i]);}}else{newLayers=layers;}
    return newLayers;};AnalyticsLayerProvider.addAnalyticsIdForCurrent=function addAnalyticsIdForCurrent($element){return this.getAnalyticsIdFromDataId($element.find('> .tabMenuItem'))||this.getAnalyticsId($element);};AnalyticsLayerProvider.getAnalyticsId=function getAnalyticsId($element){return this.getAnalyticsIdFromDataId($element)||this.getAnalyticsIdFromId($element)||this.getAnalyticsIdFromHref($element)||this.getAnalyticsIdFromClassReference($element)||this.getAnalyticsIdFromClassAnalytics($element);};AnalyticsLayerProvider.getAnalyticsIdFromDataId=function getAnalyticsIdFromDataId($element){return $element.data('id');};AnalyticsLayerProvider.getAnalyticsIdFromId=function getAnalyticsIdFromId($element){return $element.is('.accordion-content-wrapper, .tabs-content')?this.cleanupId($element.attr('id')):'';};AnalyticsLayerProvider.getAnalyticsIdFromHref=function getAnalyticsIdFromHref($element){var analyticsString='';var href=$element.attr('href')||'';if(href.indexOf('#tab')===0||href.indexOf('#accordion')===0){analyticsString=this.cleanupId(href);}
    return analyticsString;};AnalyticsLayerProvider.cleanupId=function cleanupId(str){return str.replace(/#/,'').replace(/content-/i,'').replace(/\d+-/i,'');};AnalyticsLayerProvider.getAnalyticsIdFromClassAnalytics=function getAnalyticsIdFromClassAnalytics($element){return this.getSelectorValue($element,analyticsSelector);};AnalyticsLayerProvider.getAnalyticsIdFromClassReference=function getAnalyticsIdFromClassReference($element){var referenceSelectorValue=this.getSelectorValue($element,'reference-');var analyticsSelectorValue=this.getSelectorValue($element,analyticsSelector);var result=referenceSelectorValue;if(referenceSelectorValue&&analyticsSelectorValue){result=referenceSelectorValue+' '+analyticsSelectorValue;}
    return result;};AnalyticsLayerProvider.getSelectorValue=function getSelectorValue($element,selector){var str='';var clazz=$element.attr('class')||'';var selectorIndex=clazz.indexOf(selector);if(selectorIndex>=0){str=clazz.substring(selectorIndex+selector.length);var spaceIndex=str.indexOf(' ');if(spaceIndex>=0){str=str.substring(0,spaceIndex);}}
    return str;};AnalyticsLayerProvider.isInSectionGuides=function isInSectionGuides($element){var $guideSection=$element.closest("[data-id^='section-guides-']");return $guideSection.length>0;};AnalyticsLayerProvider.replaceWithSectionGuidesLayers=function replaceWithSectionGuidesLayers($element){var $sectionGuides=$element.closest("[data-id^='section-guides-']");var $richTexts=$sectionGuides.find('.component-content .paragraphSystem > .richText');var $promoBoxItems=$sectionGuides.find('.promoBoxItem');var elementLayer1=$sectionGuides.attr('data-id');var elementLayer2=void 0;if($richTexts.index($element.closest('.richText'))===4){elementLayer2=elementLayer1+'-tags';}else if($richTexts.index($element.closest('.richText'))===2){elementLayer2='popular-guides';}else if($promoBoxItems.index($element.closest('.promoBoxItem'))!==-1){elementLayer2='promo-guide-'+($promoBoxItems.index($element.closest('.promoBoxItem'))+1);}
    return[elementLayer1,elementLayer2];};return AnalyticsLayerProvider;}();api.init=function(){sharedApi.layerProvider=AnalyticsLayerProvider;};Cog.registerStatic({name:'analyticsLayerProvider',api:api,sharedApi:sharedApi});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var pageEvent=null;var clickTypeProvider=null;var LhsBylineShareThis=function(){function LhsBylineShareThis(){_classCallCheck(this,LhsBylineShareThis);this.bindEvents();}
LhsBylineShareThis.prototype.bindEvents=function bindEvents(){Cog.addListener('analytics','singleButtonShareThis.shareThisButton',this.handleShareThisButtonClick,{scope:this});Cog.addListener('analytics','singleButtonShareThis.shareThisItem',this.handleShareThisItemClick,{scope:this});};LhsBylineShareThis.prototype.handleShareThisButtonClick=function handleShareThisButtonClick(event){var data=event.eventData;var analyticsObject=new pageEvent.Builder('click',data.$target).withClickType(clickTypeProvider.getClickType('#')).withElementLayer(data.elementLayer1,1).withItemIdentifier(data.itemIdentifier).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};LhsBylineShareThis.prototype.handleShareThisItemClick=function handleShareThisItemClick(event){var data=event.eventData;var $item=data.$target;var $itemHref=$item.attr('href');var analyticsObject=new pageEvent.Builder('click',$item).withClickType(clickTypeProvider.getClickType($itemHref)).withElementLayer(data.elementLayer1,1).withItemIdentifier($item.attr('title')).withDestination($itemHref.indexOf('mailto')>=0?undefined:$itemHref).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};return LhsBylineShareThis;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;new LhsBylineShareThis();};Cog.registerStatic({name:'analyticsLhsBylineShareThis',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var pageEvent=null;var clickTypeProvider=null;var LhsPromoboxAnalytics=function(){function LhsPromoboxAnalytics(){_classCallCheck(this,LhsPromoboxAnalytics);this.bindEvents();}
LhsPromoboxAnalytics.prototype.bindEvents=function bindEvents(){Cog.addListener('analytics','promoBoxLeftHandSide.linkClick',this.handleTitleLinkClick,{scope:this});};LhsPromoboxAnalytics.prototype.handleTitleLinkClick=function handleTitleLinkClick(event){var data=event.eventData;var analyticsObject=new pageEvent.Builder('click',data.$target).withClickType(clickTypeProvider.getClickType(data.href)).withElementLayer(data.elementLayer1,1).withElementLayer(data.elementLayer2,2).withElementLayer(data.elementLayer3,3).withElementLayer(data.elementLayer4,4).withItemIdentifier(data.itemIdentifier.trim()).withInternalDestination(clickTypeProvider.getInternalDestination(data.href)).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};return LhsPromoboxAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;new LhsPromoboxAnalytics();};Cog.registerStatic({name:'analyticsLhsPromoboxModule',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var lastLightboxId='';var LightboxAnalytics=function(){function LightboxAnalytics($element){_classCallCheck(this,LightboxAnalytics);this.bindEvents();}
LightboxAnalytics.prototype.bindEvents=function bindEvents(){$('a.lightbox:not(.eligibility-overlay-trigger)').on('click',this.lightboxLinkClick.bind(this));Cog.addListener('overlay','close',this.lightboxCloseClick,{scope:this});};LightboxAnalytics.prototype.lightboxCloseClick=function lightboxCloseClick(ev){Cog.fireEvent('analytics','clickable.click',{$target:$('<div>'+lastLightboxId+'</div>'),href:'#lightbox-close'});};LightboxAnalytics.prototype.lightboxLinkClick=function lightboxLinkClick(ev){var $target=$(ev.currentTarget);lastLightboxId=$target.text().trim();Cog.fireEvent('analytics','clickable.click',{$target:$target,href:'#lightbox-open'});};return LightboxAnalytics;}();api.init=function(){new LightboxAnalytics();};Cog.registerStatic({name:'analyticsLightboxModule',api:api});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={},external={analyticsModule:null},pageEvent=null,clickTypeProvider=null;var ListAnalytics=function(){function ListAnalytics($element){_classCallCheck(this,ListAnalytics);this.bindElements();this.bindEvents();}
ListAnalytics.prototype.bindEvents=function bindEvents(){this.$promoBoxItem.on('click',this.promoBoxItemClick.bind(this));this.$articleListItem.on('click',this.recentArticlesClick.bind(this));this.$pageListItem.on('click',this.recentPaginatedListItemClick.bind(this));this.$tipBoxGeneralListItem.on('click',this.tipBoxListItemClick.bind(this));this.$tipBoxMainListItem.on('click',this.tipBoxListItemClick.bind(this));this.$toolsListItem.on('click',this.toolsListItemClick.bind(this));this.$popularGuidesItem.on('click',this.regularListItemClick.bind(this));this.$trending.on('click',this.regularListItemClick.bind(this));};ListAnalytics.prototype.bindElements=function bindElements(){this.$pageList=$('.page-list');this.$articleList=$('.articleList-list');this.$tipBoxGeneralList=$('.tip-box-general-list');this.$tipBoxGeneralListItem=this.$tipBoxGeneralList.find('.tip-box-general-list-item');this.$tipBoxMainList=$('.tip-box-main-list');this.$tipBoxMainListItem=this.$tipBoxMainList.find('.tip-box-main-list-item');this.$toolsList=$('.tools-list-items');this.$articleListItem=this.$articleList.find('.articleList-article');this.$pageListItem=this.$pageList.find('.page-list-item');this.$toolsListItem=this.$toolsList.find('.toolsListItem');this.$promoBoxItem=$('.promoBoxItem, .promoBox .dynamic-guides .item');this.$popularGuidesItem=$('.popularGuides a');this.$trending=$('.trending');};ListAnalytics.prototype.recentPaginatedListItemClick=function recentPaginatedListItemClick(ev){var $target=$(ev.target);var href=this.findAnchorAndHref($target);var analyticsObject=new pageEvent.Builder('click',$target).withClickType(clickTypeProvider.getClickType(href)).withElementExtraInfo(this.getElementExtraInfo($target)).withListLocation(this.getListLocation($target,'.page-list-item')).withItemIdentifier(this.getPageListItemHeadline($target)).withPaginationNumber(this.getPageNumber()).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};ListAnalytics.prototype.promoBoxItemClick=function promoBoxItemClick(ev){var customPromoBoxParentSelector="[data-id='martins-blog']";var $target=$(ev.target);var $aTag=this.findAnchor($target);var href=this.findAnchorAndHref($target);var customParentSelector=$target.closest(customPromoBoxParentSelector).length>0?customPromoBoxParentSelector:undefined;var analyticsObject=new pageEvent.Builder('click',$target).withClickType(clickTypeProvider.getClickType(href)).withElementExtraInfo(this.getElementExtraInfo($target)).withListLocation(this.getListLocationByType($target,'.promoBoxItem, .item',customParentSelector)).withItemIdentifier($aTag.text().trim()||$aTag.attr('title')).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};ListAnalytics.prototype.regularListItemClick=function regularListItemClick(ev){var $target=$(ev.target);var $aTag=this.findAnchor($target);if($aTag.size()===0){return;}
    var href=this.findHrefFromAnchor($aTag);var analyticsObject=new pageEvent.Builder('click',$target).withClickType(clickTypeProvider.getClickType(href)).withElementExtraInfo(this.getElementExtraInfo($target)).withListLocation(this.getListLocation($target,'li')).withItemIdentifier($target.text().trim()).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};ListAnalytics.prototype.recentArticlesClick=function recentArticlesClick(ev){var $target=$(ev.target);var href=this.findAnchorAndHref($target);var analyticsObject=new pageEvent.Builder('click',$target).withClickType(clickTypeProvider.getClickType(href)).withElementExtraInfo(this.getElementExtraInfo($target)).withListLocation(this.getListLocation($target,'.articleList-article')).withItemIdentifier(this.getArticleListItemHeadline($target)).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};ListAnalytics.prototype.tipBoxListItemClick=function tipBoxListItemClick(ev){var $target=$(ev.target);var $currentTarget=$(ev.currentTarget);var tipBoxItemType=$target.closest('.tip-box-general-list').length>0?'.tip-box-general-list-item':'.tip-box-main-list-item';var href=this.findAnchorAndHref($target);var analyticsObject=new pageEvent.Builder('click',$currentTarget).withClickType(clickTypeProvider.getClickType(href)).withDestination(clickTypeProvider.getDestination(href)).withElementExtraInfo(this.getElementExtraInfo($currentTarget)).withListLocation(this.getListLocation($target,tipBoxItemType)).withItemIdentifier($currentTarget.text().trim()).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};ListAnalytics.prototype.toolsListItemClick=function toolsListItemClick(ev){var $target=$(ev.target);var $currentTarget=$(ev.currentTarget);var href=this.findAnchorAndHref($target);var analyticsObject=new pageEvent.Builder('click',$currentTarget).withClickType(clickTypeProvider.getClickType(href)).withDestination(clickTypeProvider.getDestination(href)).withElementExtraInfo(this.getElementExtraInfo($currentTarget)).withListLocation(this.getListLocation($target,'.toolsListItem')-1).withItemIdentifier($currentTarget.text().trim()).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};ListAnalytics.prototype.findAnchor=function findAnchor($target){return $target.is('a')?$target:$target.closest('a');};ListAnalytics.prototype.findHrefFromAnchor=function findHrefFromAnchor($aTag){return $aTag.attr('href')||'#';};ListAnalytics.prototype.findAnchorAndHref=function findAnchorAndHref($target){var $aTag=this.findAnchor($target);return this.findHrefFromAnchor($aTag);};ListAnalytics.prototype.getListLocationByType=function getListLocationByType($target,selector,customParentSelector){var $item=$target.closest(selector);var $parent=customParentSelector?$item.closest(customParentSelector):$item.parent();var dataIndex=$item.data('index');var index=1+(dataIndex!==undefined?dataIndex:$parent.find(selector).index($item));return index||undefined;};ListAnalytics.prototype.getListLocation=function getListLocation($target,selector){return $target.parent().closest(selector).index()+1;};ListAnalytics.prototype.getPageListItemHeadline=function getPageListItemHeadline($target){return $target.closest('.page-list-item').find('.list-item-link, .news-list-item-headline, .pressreleases-list-item-headline').text();};ListAnalytics.prototype.getArticleListItemHeadline=function getArticleListItemHeadline($target){return $target.closest('.articleList-article').find('.articleList-title a').text();};ListAnalytics.prototype.getElementExtraInfo=function getElementExtraInfo($target){var parentClass=$target.closest('div,h1,h3').attr('class');var targetClass=$target.attr('class');if($target.prop('tagName')==='IMG'){return $target.closest('a').hasClass('video-article')?'video':'image';}else if(parentClass.includes('list-item-cta')){return 'cta';}else if(parentClass.includes('list-item-title')||parentClass.includes('articleList-title')||parentClass.includes('news-list-item-headline')||targetClass&&targetClass.includes('pressreleases-list-item-headline')||parentClass.includes('promobox-title')||parentClass.includes('promobox-content')||parentClass.includes('promobox-description')){return 'text';}else if(parentClass.includes('image-full')||targetClass&&targetClass.includes('articleList-thumbnail')||parentClass.includes('news-list-item-image')){return 'image';}};ListAnalytics.prototype.getPageNumber=function getPageNumber(){var number=this.$pageList.find('.pagination-navigation .is-active').text()||1;return parseInt(number,10);};return ListAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;new ListAnalytics();};Cog.registerStatic({name:'analyticsListModule',api:api,externalApi:external,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var pageEvent=null;var clickTypeProvider=null;var MegaMenuAnalytics=function(){function MegaMenuAnalytics(media){_classCallCheck(this,MegaMenuAnalytics);this.bindElements();this.bindEvents();this.media=media;}
MegaMenuAnalytics.prototype.bindElements=function bindElements(){this.$navLinks=$('.megaMenu a');};MegaMenuAnalytics.prototype.bindEvents=function bindEvents(){var _this=this;this.$navLinks.on('click',function(ev){_this.navLinksClick(ev);});};MegaMenuAnalytics.prototype.navLinksClick=function navLinksClick(ev){var $currentTarget=$(ev.currentTarget);var analyticsObject=this.createMegaMenuAnalyticsObject($currentTarget);Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};MegaMenuAnalytics.prototype.createMegaMenuAnalyticsObject=function createMegaMenuAnalyticsObject($currentTarget){var itemCategory='MastHead MegaMenu';var href=$currentTarget.attr('href');var itemIdentifier=this.getItemIdentifier($currentTarget,itemCategory);var thirdElementLayer='richtext';var internalDestination=clickTypeProvider.getInternalDestination(href);if(this.media.isTabletOrDesktopSmall()&&this.isBackBtn($currentTarget)){itemIdentifier='Back - '+itemIdentifier;thirdElementLayer='button';internalDestination=undefined;}
    var builder=new pageEvent.Builder('click',$currentTarget).withElementLayer('snippet '+this.giveSnippetName($currentTarget),1).withElementLayer('megamenu',2).withElementLayer(thirdElementLayer,3).withClickType(clickTypeProvider.getClickType(href)).withItemIdentifier(itemIdentifier).withInternalDestination(internalDestination).withDestination(clickTypeProvider.getDestination(href)).withSiteSection(itemCategory);return builder.build();};MegaMenuAnalytics.prototype.giveSnippetName=function giveSnippetName($currentTarget){return $currentTarget.closest('.snippetReference').attr('class').split(' ').filter(function(className){return className.indexOf('reference')===0;}).toString();};MegaMenuAnalytics.prototype.getItemIdentifier=function getItemIdentifier($currentTarget,section){if(section==='MastHead MegaMenu'&&$currentTarget.parent().is('h3')){return this.getCategoryName($currentTarget)+' - '+$currentTarget.text().trim();}
    if(section==='MastHead MegaMenu'&&$currentTarget.parent().is('li')&&!$currentTarget.parent().hasClass('megaMenu-nav-item')){var subcategory=$currentTarget.closest('.richText-content').find('h3');var subcategoryName=subcategory.text().trim();return this.getCategoryName(subcategory)+' - '+subcategoryName+' - '+$currentTarget.text().trim();}
    return $currentTarget.text().trim();};MegaMenuAnalytics.prototype.getCategoryName=function getCategoryName(subcategory){var categoryId=subcategory.closest('.megaMenu-content').attr('id');var categoryName=$('[data-category-id=#'+categoryId+']').text().trim();return categoryName;};MegaMenuAnalytics.prototype.isBackBtn=function isBackBtn($currentTarget){return $currentTarget.parent().hasClass('is-active');};return MegaMenuAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;new MegaMenuAnalytics(this.external.media);};Cog.registerStatic({name:'analyticsMegaMenuModule',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'},{name:'utils.media',apiId:'media'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={},pageEvent=null,clickTypeProvider=null;var MobileMegaMenuAnalytics=function(){function MobileMegaMenuAnalytics(){_classCallCheck(this,MobileMegaMenuAnalytics);this.bindEvents();}
MobileMegaMenuAnalytics.prototype.bindEvents=function bindEvents(){Cog.addListener('analytics','mobileMegaMenu.backButtonClick',this.backButtonClick,{scope:this});Cog.addListener('analytics','mobileMegaMenu.subcategoryClick',this.subcategoryClick,{scope:this});Cog.addListener('analytics','mobileMegaMenu.bottomLinksClick',this.bottomLinksClick,{scope:this});Cog.addListener('analytics','mobileMegaMenu.thirdLevelAnchorClick',this.thirdLevelAnchorClick,{scope:this});Cog.addListener('analytics','mobileMegaMenu.parentCategoryNavigationClick',this.parentCategoryNavigationClick,{scope:this});};MobileMegaMenuAnalytics.prototype.backButtonClick=function backButtonClick(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType,$(ev.currentTarget)).withClickType(data.clickType).withElementLayer(data.elementLayer1,1).withElementLayer(data.elementLayer2,2).withElementLayer(data.elementLayer3,3).withItemIdentifier(data.itemIdentifier).withSiteSection(data.siteSection).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};MobileMegaMenuAnalytics.prototype.subcategoryClick=function subcategoryClick(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType,$(ev.currentTarget)).withClickType(data.clickType).withElementLayer(data.elementLayer1,1).withElementLayer(data.elementLayer2,2).withElementLayer(data.elementLayer3,3).withInternalDestination(data.internalDestination).withItemIdentifier(data.itemIdentifier).withSiteSection(data.siteSection).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};MobileMegaMenuAnalytics.prototype.bottomLinksClick=function bottomLinksClick(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType,$(ev.currentTarget)).withClickType(clickTypeProvider.getClickType(data.href)).withElementLayer(data.elementLayer1,1).withElementLayer(data.elementLayer2,2).withElementLayer(data.elementLayer3,3).withInternalDestination(data.href).withDestination(!clickTypeProvider.isInternal(data.href)?clickTypeProvider.getDestination(data.href):'').withItemIdentifier(data.itemIdentifier).withSiteSection(data.siteSection).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};MobileMegaMenuAnalytics.prototype.thirdLevelAnchorClick=function thirdLevelAnchorClick(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType,$(ev.currentTarget)).withClickType(clickTypeProvider.getClickType(data.href)).withElementLayer(data.elementLayer1,1).withElementLayer(data.elementLayer2,2).withElementLayer(data.elementLayer3,3).withInternalDestination(data.internalDestination).withItemIdentifier(data.itemIdentifier).withSiteSection(data.siteSection).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};MobileMegaMenuAnalytics.prototype.parentCategoryNavigationClick=function parentCategoryNavigationClick(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType,$(ev.currentTarget)).withClickType(data.clickType).withElementLayer(data.elementLayer1,1).withElementLayer(data.elementLayer2,2).withElementLayer(data.elementLayer3,3).withElementExtraInfo(data.elementExtraInfo).withInternalDestination(data.internalDestination).withItemIdentifier(data.itemIdentifier).withSiteSection(data.siteSection).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};return MobileMegaMenuAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;new MobileMegaMenuAnalytics();};Cog.registerStatic({name:'analyticsMobileMegaMenuModule',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var selectors={productBox:'.composite-productboxes'};var tagToElementName={'A':'text','IMG':'image'};var api={},pageEvent=null,clickTypeProvider=null;function validAfflinkValue(afflink){return afflink==="paid"||afflink==="unpaid";}
var ProductBoxAnalytics=function(){function ProductBoxAnalytics(){_classCallCheck(this,ProductBoxAnalytics);this.bindElements();this.bindEvents();}
    ProductBoxAnalytics.prototype.bindElements=function bindElements(){this.$productBox=$('.productBox');this.$anchors=this.$productBox.find('a');};ProductBoxAnalytics.prototype.bindEvents=function bindEvents(){var _this=this;this.$anchors.on('click',function(ev){return _this.productBoxClick(ev);});};ProductBoxAnalytics.prototype.productBoxClick=function productBoxClick(ev){var $currentTarget=$(ev.currentTarget);var $target=$(ev.target);var productBoxAnalyticsObject=this.createProductBoxAnalyticsObject($currentTarget,$target);Cog.fireEvent('analytics','track',{analyticsObject:productBoxAnalyticsObject});};ProductBoxAnalytics.prototype.createProductBoxAnalyticsObject=function createProductBoxAnalyticsObject($currentTarget,$target){var href=$currentTarget.attr('href');var linkLabel=$currentTarget.text();return new pageEvent.Builder('click',$currentTarget).withClickType(clickTypeProvider.getClickType(href)).withItemIdentifier(linkLabel).withDestination(clickTypeProvider.getDestination(href)).withElementExtraInfo(this.getElementExtraInfo($target)).withListLocation(this.getProductBoxLocation($currentTarget)).withExtraObject(this.getAnalyticsData($currentTarget)).build();};ProductBoxAnalytics.prototype.getElementExtraInfo=function getElementExtraInfo($target){return this.isCta($target)?'cta':tagToElementName[$target.prop('tagName')];};ProductBoxAnalytics.prototype.isCta=function isCta($target){var classAttr=$target.attr("class");var result=false;if(classAttr){result=this.hasProductBoxButtonClass(classAttr);}
        return result;};ProductBoxAnalytics.prototype.hasProductBoxButtonClass=function hasProductBoxButtonClass(classAttr){var result=false;var classes=classAttr.split(' ');for(var _iterator=classes,_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++];}else{_i=_iterator.next();if(_i.done)break;_ref=_i.value;}
        var clazz=_ref;if(clazz.indexOf('product-box-button')!==-1){result=true;break;}}
        return result;};ProductBoxAnalytics.prototype.getProductBoxLocation=function getProductBoxLocation($currentTarget){var $usedProductBox=$currentTarget.closest(selectors.productBox);var location=0;$(selectors.productBox).each(function(idx,$productBox){if(location===0&&$usedProductBox.is($productBox)){location=idx+1;}});return location;};ProductBoxAnalytics.prototype.getAnalyticsData=function getAnalyticsData($currentTarget){var href=$currentTarget.attr('href');var $usedProductBox=$currentTarget.closest(selectors.productBox);var analyticsData=$usedProductBox.find('[data-product]').data();var deductedAfflink=clickTypeProvider.getClickType(href)==="externalPaid"?"paid":"unpaid";if(!validAfflinkValue(analyticsData.product.afflink)){analyticsData.product.afflink=deductedAfflink;}
        return analyticsData;};return ProductBoxAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;new ProductBoxAnalytics();};Cog.registerStatic({name:'analyticsProductBoxModule',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var RichtextLinkAnalytics=function(){function RichtextLinkAnalytics($element){_classCallCheck(this,RichtextLinkAnalytics);this.bindEvents();}
RichtextLinkAnalytics.prototype.bindEvents=function bindEvents(){$(document).ready(this.createLinkIds).bind(this);};RichtextLinkAnalytics.prototype.createLinkIds=function createLinkIds(ev){$('.richText-content').each(function(richtextIndex,richtextItem){$(richtextItem).find('a').each(function(i,item){var $item=$(item);var name=$item.text().trim().replace(/[.,]/g,'').replace(/\s+/g,'-').toLowerCase();$item.attr('data-link-id',name+'-'+(i+1));});});};return RichtextLinkAnalytics;}();api.init=function(){new RichtextLinkAnalytics();};Cog.registerStatic({name:'analyticsRichtextLinkModule',api:api});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var external={analyticsModule:null};var pageEvent=null;var SearchAnalytics=function(){function SearchAnalytics(){_classCallCheck(this,SearchAnalytics);this.bindEvents();}
SearchAnalytics.prototype.bindEvents=function bindEvents(){Cog.addListener('analytics','search.searchBoxSubmit',this.searchBoxSubmit,{scope:this});Cog.addListener('analytics','search.searchBoxFocus',this.searchBoxFocus,{scope:this});Cog.addListener('analytics','search.searchResultsLoaded',this.searchResultsLoaded,{scope:this});Cog.addListener('analytics','search.searchBoxClose',this.searchBoxClosed,{scope:this});Cog.addListener('analytics','search.searchBoxToggle',this.searchBoxToggle,{scope:this});};SearchAnalytics.prototype.searchBoxSubmit=function searchBoxSubmit(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType,$(ev.currentTarget)).withClickType(data.clickType).withElementLayer(data.elementLayer1,1).withElementLayer(data.elementLayer2,2).withElementLayer(data.elementLayer3,3).withSearchTerm(data.searchTerm).withSearchDropdownSelection(data.filterLabel).withItemIdentifier(data.itemIdentifier).withSiteSection(data.siteSection).build();if(!_.isUndefined(data.callback)){analyticsObject.eventCallback=data.callback;analyticsObject.eventTimeout=2000;}
    Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject,callback:data.callback});};SearchAnalytics.prototype.searchBoxClosed=function searchBoxClosed(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType).withClickType(data.clickType).withElementLayer(data.elementLayer1,1).withItemIdentifier(data.itemIdentifier).withSiteSection(data.siteSection).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};SearchAnalytics.prototype.searchBoxToggle=function searchBoxToggle(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType).withClickType(data.clickType).withElementLayer(data.elementLayer1,1).withElementLayer(data.elementLayer2,2).withElementLayer(data.elementLayer3,3).withItemIdentifier(data.itemIdentifier).withSiteSection(data.siteSection).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};SearchAnalytics.prototype.searchBoxFocus=function searchBoxFocus(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType).withSiteSection(data.siteSection).withElementLayer(data.elementLayer1,1).withElementLayer(data.elementLayer2,2).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};SearchAnalytics.prototype.searchResultsLoaded=function searchResultsLoaded(ev){var data=ev.eventData;var searchCriteria={searchTerm:data.searchTerm,filterSelection:{filter1:{filterLabel:data.filters['Guides'].label,filterSetting:data.filters['Guides'].active},filter2:{filterLabel:data.filters['News'].label,filterSetting:data.filters['News'].active},filter3:{filterLabel:data.filters['Deals'].label,filterSetting:data.filters['Deals'].active},filter4:{filterLabel:data.filters['Blogs'].label,filterSetting:data.filters['Blogs'].active},filter5:{filterLabel:data.filters['Weekly Email'].label,filterSetting:data.filters['Weekly Email'].active}},totalNumberSearchResults:data.searchResultsNumber};var analyticsObject=new pageEvent.Builder(data.actionType).withSearchCriteria(searchCriteria).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};return SearchAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;new SearchAnalytics();};Cog.registerStatic({name:'analyticsSearchModule',api:api,externalApi:external,requires:[{name:'analyticsModule',apiId:'analyticsModule'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={},sharedApi={siteSectionProvider:null};var AnalyticsSiteSectionProvider=function(){function AnalyticsSiteSectionProvider(){_classCallCheck(this,AnalyticsSiteSectionProvider);}
AnalyticsSiteSectionProvider.prototype.getSiteSectionOf=function getSiteSectionOf($target){var result='';if($target.closest('[data-site-section]').length!==0){result=$target.closest('[data-site-section]').data('site-section');}else if($target.closest('.left-sidebar-section').length!==0){result='LHS';}else if($target.closest('.sidebar-section-container,.sidebar-section,.right-sidebar-section').length!==0){if($target.closest('.email-tip-box-wrapper, .guide-side-column-dropdown, .sidebar-sticky').length!==0){result='In Page Navigation';}else{result='RHS';}}else if($target.closest('#header').length!==0){result='masthead';}else if($target.closest('#content').length!==0){result='mainSection';}else if($target.closest('.tip-email-popup').length!==0){result='bottomAlert';}else if($target.closest('.cookiePolicy').length!==0){result='topAlert';}else if($target.closest('#footer').length!==0){result='footer';}
    return result;};return AnalyticsSiteSectionProvider;}();api.init=function(){sharedApi.siteSectionProvider=new AnalyticsSiteSectionProvider();};Cog.registerStatic({name:'analyticsSiteSectionProvider',api:api,sharedApi:sharedApi});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={},pageEvent=null,clickTypeProvider=null;var SocialShareAnalytics=function(){function SocialShareAnalytics(){_classCallCheck(this,SocialShareAnalytics);this.bindElements();this.bindEvents();}
SocialShareAnalytics.prototype.bindElements=function bindElements(){this.$dealsFullList=$('.deals-full-list');this.$shareThisItem=this.$dealsFullList.find('.shareThis-item');};SocialShareAnalytics.prototype.bindEvents=function bindEvents(){var _this=this;this.$shareThisItem.on('click',function(ev){return _this.handleClick(ev);});};SocialShareAnalytics.prototype.handleClick=function handleClick(ev){var $target=$(ev.target);var $socialShareItem=$(ev.currentTarget);var $socialShareItemLink=$socialShareItem.find('a');var extraObject=this.createSocialShareDealExtraObject($target);this.trackSocialShareDealClick($target,$socialShareItemLink.attr('href'),'cta',extraObject);};SocialShareAnalytics.prototype.trackSocialShareDealClick=function trackSocialShareDealClick($target,href,elementExtraInfo,extraObject){var analyticsObject=new pageEvent.Builder('click',$target).withClickType(clickTypeProvider.getClickType(href)).withDestination(clickTypeProvider.getDestination(href)).withItemIdentifier(this.getItemIdentifier($target,href)).withElementExtraInfo(elementExtraInfo).withElementLayer('social_share',2).withListLocation(this.getListLocation($target,'.deals-full-list-article')).withExtraObject(extraObject).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};SocialShareAnalytics.prototype.getItemIdentifier=function getItemIdentifier($target,href){return $target.text().trim()||(href.indexOf('#')===0?href.substring(1):'');};SocialShareAnalytics.prototype.getListLocation=function getListLocation($target,selector){var $dealElement=$target.closest(selector);return $dealElement.parent().find(selector).index($dealElement)+1;};SocialShareAnalytics.prototype.createSocialShareDealExtraObject=function createSocialShareDealExtraObject($target){var $dealElement=$target.closest('.deals-full-list-article');if($dealElement.length===0){return;}
    var dealId=$dealElement.attr('id');var headline=$dealElement.find('.deal-heading h3').text();var expiry=$dealElement.attr('data-expiry-date');var brandName=$dealElement.attr('data-brand-name');var brand=brandName.replace(' ','-');return{deal:{id:dealId,headline:headline,brand:brand,expiry:expiry}};};return SocialShareAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;new SocialShareAnalytics();};Cog.registerStatic({name:'analyticsSocialShare',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={},pageEvent=null;var TipBoxAnalytics=function(){function TipBoxAnalytics(){_classCallCheck(this,TipBoxAnalytics);this.bindEvents();}
TipBoxAnalytics.prototype.bindEvents=function bindEvents(){Cog.addListener('analytics','tipbox.focusEmailAddress',this.focusEmailInput,{scope:this});Cog.addListener('analytics','tipbox.submitEmailAddress',this.submitEmailAddress,{scope:this});Cog.addListener('analytics','tipbox.displaySuccessMessage',this.displaySuccessMessage,{scope:this});Cog.addListener('analytics','tipbox.displayErrorMessage',this.displayErrorMessage,{scope:this});Cog.addListener('analytics','tipbox.showTipBoxPopUp',this.showTipBoxPopUp,{scope:this});Cog.addListener('analytics','tipbox.closeTipBoxPopUp',this.closeTipBoxPopUp,{scope:this});};TipBoxAnalytics.prototype.focusEmailInput=function focusEmailInput(ev){var analyticsObject=new pageEvent.Builder('textboxEntry',ev.eventData.$target).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};TipBoxAnalytics.prototype.submitEmailAddress=function submitEmailAddress(ev){var $target=ev.eventData.$target;var submitLabel=$target.find('input[type=submit]').val();var analyticsObject=void 0;if($target.parents('.email-tip-box-wrapper, .main-content-section-paragraph, .tip-box-main').length){analyticsObject=new pageEvent.Builder('click',$target).withClickType('pageAction').withElementLayer('Tip',1).withItemIdentifier('Sign Up Button').build();}else{analyticsObject=new pageEvent.Builder('click',$target).withClickType('pageAction').withItemIdentifier(submitLabel).build();}
    Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};TipBoxAnalytics.prototype.displaySuccessMessage=function displaySuccessMessage(ev){var $target=ev.eventData.$target;var analyticsObject=void 0;if($target.parents('.email-tip-box-wrapper, .main-content-section-paragraph, .tip-box-main').length){analyticsObject=new pageEvent.Builder('feedbackEvent',$target).withElementLayer('Tip',1).withItemIdentifier('Sign Up Success').build();}else if(ev.eventData.isHomeTipBox){analyticsObject=new pageEvent.Builder('feedbackEvent',$target).withItemIdentifier('success').build();}else{analyticsObject=new pageEvent.Builder('feedbackEvent',$target).withSiteSection('topAlert').withElementLayer('tipSignupSuccessAlertBanner',1).withItemIdentifier('success').build();}
    Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};TipBoxAnalytics.prototype.displayErrorMessage=function displayErrorMessage(ev){var $target=ev.eventData.$target;var analyticsObject=void 0;if($target.parents('.email-tip-box-wrapper, .main-content-section-paragraph, .tip-box-main').length){analyticsObject=new pageEvent.Builder('feedbackEvent',$target).withElementLayer('Tip',1).withItemIdentifier('Sign Up failure').withElementExtraInfo(ev.eventData.elementExtraInfo).build();}else{analyticsObject=new pageEvent.Builder('feedbackEvent',$target).withItemIdentifier('failure').withElementExtraInfo(ev.eventData.elementExtraInfo).build();}
    Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};TipBoxAnalytics.prototype.showTipBoxPopUp=function showTipBoxPopUp(ev){var analyticsObject=new pageEvent.Builder('popup',ev.eventData.$target).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};TipBoxAnalytics.prototype.closeTipBoxPopUp=function closeTipBoxPopUp(ev){var analyticsObject=new pageEvent.Builder('click',ev.eventData.$target).withClickType('pageAction').withElementExtraInfo('close').build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};return TipBoxAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;new TipBoxAnalytics();};Cog.registerStatic({name:'analyticsTipBoxModule',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'}]});})(Cog.jQuery());(function($){var sharedApi={isTipPage:false,attachTipPageAnalytics:null};sharedApi.isTipPage=$('body.template-tip-email').length===1;sharedApi.attachTipPageAnalytics=function(builder,event,$target){var tipSectionInfo=$target.data('tip');if(tipSectionInfo){var tipSections=tipSectionInfo.split('~');var currentLayer=2;tipSections.forEach(function(item){builder=builder.withElementLayer(item,currentLayer);currentLayer++;});}
if($target.attr('href').indexOf('#')===0){builder.withInternalDestination($target.attr('href'));}
return builder;};Cog.registerStatic({name:'analyticsTipPageModule',api:{},sharedApi:sharedApi});})(Cog.jQuery(),_);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function($){var api={};var pageEvent=null;var clickTypeProvider=null;var TopNavAnalytics=function(){function TopNavAnalytics(){_classCallCheck(this,TopNavAnalytics);this.bindElements();this.bindEvents();}
TopNavAnalytics.prototype.bindElements=function bindElements(){this.$topNavLinks=$('.top-nav-v2 a, .top-nav-v2-mobile-view-top-row a');};TopNavAnalytics.prototype.bindEvents=function bindEvents(){var _this=this;this.$topNavLinks.on('click',function(ev){if(ev.target.classList.contains('top-nav-v2__search'))return;_this.handleTopNavLinksClick(ev);});Cog.addListener('analytics','mobileTopnav.logoClick',this.mobileLogoClickHandler,{scope:this});Cog.addListener('analytics','mobileTopnav.hamburgerMenuClick',this.mobileHamburgerMenuClickHandler,{scope:this});Cog.addListener('analytics','mobileTopnav.moreButtonClick',this.handleTopNavLinksClick,{scope:this});};TopNavAnalytics.prototype.handleTopNavLinksClick=function handleTopNavLinksClick(event){var $currentTarget=$(event.currentTarget||event.eventData.currentTarget);var $target=$(event.target||event.eventData.target);var analyticsObject=this.createTopNavAnalyticsObject($currentTarget,$target);Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};TopNavAnalytics.prototype.createTopNavAnalyticsObject=function createTopNavAnalyticsObject($currentTarget,$target){var itemCategory='MastHead TopNav';var href=$currentTarget.attr('href');var itemIdentifier=this.getItemIdentifier($target,$currentTarget,itemCategory);var builder=new pageEvent.Builder('click',$currentTarget).withClickType(clickTypeProvider.getClickType(href)).withItemIdentifier(itemIdentifier).withInternalDestination(clickTypeProvider.getInternalDestination(href)).withDestination(clickTypeProvider.getDestination(href)).withSiteSection(itemCategory);return builder.build();};TopNavAnalytics.prototype.isImage=function isImage($target){return $target.prop('tagName')==='IMG';};TopNavAnalytics.prototype.getItemIdentifier=function getItemIdentifier($target,$currentTarget){return this.isImage($target)?$target.attr('alt'):$currentTarget.text().trim();};TopNavAnalytics.prototype.mobileLogoClickHandler=function mobileLogoClickHandler(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType,$(ev.currentTarget)).withClickType(data.clickType).withElementLayer(data.elementLayer1,1).withElementLayer(data.elementLayer2,2).withElementLayer(data.elementLayer3,3).withItemIdentifier(data.itemIdentifier).withInternalDestination(data.internalDestination).withSiteSection(data.siteSection).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};TopNavAnalytics.prototype.mobileHamburgerMenuClickHandler=function mobileHamburgerMenuClickHandler(ev){var data=ev.eventData;var analyticsObject=new pageEvent.Builder(data.actionType,$(ev.currentTarget)).withClickType(data.clickType).withElementLayer(data.elementLayer1,1).withElementLayer(data.elementLayer2,2).withElementLayer(data.elementLayer3,3).withItemIdentifier(data.itemIdentifier).withSiteSection(data.siteSection).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};return TopNavAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;new TopNavAnalytics();};Cog.registerStatic({name:'analyticsTopNavModule',api:api,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var external={analyticsModule:null};var pageEvent=null;var clickTypeProvider=null;var VideoShowcaseAnalytics=function(){function VideoShowcaseAnalytics(){_classCallCheck(this,VideoShowcaseAnalytics);this.bindElements();this.bindEvents();}
VideoShowcaseAnalytics.prototype.bindElements=function bindElements(){this.$leftButton=$('.video-showcase-scroll-left-button');this.$rightButton=$('.video-showcase-scroll-right-button');this.$links=$('.video-label-link, .video-image-link');};VideoShowcaseAnalytics.prototype.bindEvents=function bindEvents(){this.$leftButton.on('click',this.leftButtonClick.bind(this));this.$rightButton.on('click',this.rightButtonClick.bind(this));this.$links.on('click',this.linkClick.bind(this));};VideoShowcaseAnalytics.prototype.leftButtonClick=function leftButtonClick(ev){var $target=$(ev.target);var analyticsObject=new pageEvent.Builder('click',$target).withClickType('pageAction').withSiteSection('mainSection').build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};VideoShowcaseAnalytics.prototype.rightButtonClick=function rightButtonClick(ev){var $target=$(ev.target);var analyticsObject=new pageEvent.Builder('click',$target).withClickType('pageAction').withSiteSection('mainSection').build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};VideoShowcaseAnalytics.prototype.linkClick=function linkClick(ev){ev.stopImmediatePropagation();var $target=$(ev.target);var href=$target.attr('href')?$target.attr('href'):$target.closest('a').attr('href');var siteSection='mainSection';var listLocation=$target.closest('.video-image, .video-label').data('position');var elementExtraInfo=$target.prop('tagName')==='IMG'?'image':'text';var itemIdentifier=$target.text();var analyticsObject=new pageEvent.Builder('click',$target).withClickType(clickTypeProvider.getClickType(href)).withSiteSection(siteSection).withListLocation(listLocation).withElementExtraInfo(elementExtraInfo).withItemIdentifier(itemIdentifier).build();Cog.fireEvent('analytics','track',{analyticsObject:analyticsObject});};return VideoShowcaseAnalytics;}();api.init=function(){pageEvent=this.external.analyticsModule.pageEvent;clickTypeProvider=this.external.analyticsClickTypeProvider.clickTypeProvider;new VideoShowcaseAnalytics();};Cog.registerStatic({name:'analyticsVideoShowcaseModule',api:api,externalApi:external,requires:[{name:'analyticsModule',apiId:'analyticsModule'},{name:'analyticsClickTypeProvider',apiId:'analyticsClickTypeProvider'}]});})(Cog.jQuery());function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={skipToContentSnippet:'.skip-to-content',skipToContentFocus:'skip-to-content--focus',skipToContentText:'.top-nav-v2-skip-to-content',contentContainer:'.container-fluid',classStateSkipVisible:'skip-to-content--visible',classStateSkipPresent:'skip-to-content--present',footer:'#footer'};var SkipToContent=function(){function SkipToContent($scope,status){_classCallCheck(this,SkipToContent);this.$scope=$scope;this.status=status;this.bindUIElements();if(this.ifSkipToContent()){this.watchWindowResize();this.watchFocus();}}
SkipToContent.prototype.bindUIElements=function bindUIElements(){this.$skipToContentSnippet=this.$scope;this.$skipToContentText=this.$skipToContentSnippet.find(selectors.skipToContentText);this.$skipToContentLink=this.$skipToContentText.find('a');this.$contentContainer=$(selectors.contentContainer);this.$footer=$(selectors.footer);};SkipToContent.prototype.ifSkipToContent=function ifSkipToContent(){return this.$skipToContentSnippet;};SkipToContent.prototype.prepareContent=function prepareContent($topValue){this.$contentContainer.addClass(selectors.classStateSkipPresent).css('top',$topValue);this.$skipToContentSnippet.css('display','block');this.$footer.css('margin-bottom',$topValue);};SkipToContent.prototype.watchWindowResize=function watchWindowResize(){var _this=this;$(window).resize(function(){var skipHeight=_this.$scope.innerHeight();if(!_this.$skipToContentLink.is(':focus')&&_this.$contentContainer.position().top!==skipHeight){_this.$contentContainer.css('top','-'+skipHeight+'px');}else if(_this.$skipToContentLink.is(':focus')&&_this.$contentContainer.position().top!=='0'){_this.$contentContainer.css('top','0px');}});};SkipToContent.prototype.watchFocus=function watchFocus(){var _this2=this;this.prepareContent('-'+this.$scope.innerHeight()+'px');this.$skipToContentLink.on('focus',function(){_this2.$skipToContentSnippet.addClass(selectors.skipToContentFocus);_this2.$contentContainer.addClass(selectors.classStateSkipVisible);_this2.$contentContainer.css('top','0px');});this.$skipToContentLink.on('focusout',function(){_this2.$skipToContentSnippet.removeClass(selectors.skipToContentFocus);_this2.$contentContainer.removeClass(selectors.classStateSkipVisible);_this2.$contentContainer.css('top','-'+_this2.$scope.innerHeight()+'px');});};return SkipToContent;}();api.onRegister=function(scope){new SkipToContent(scope.$scope,this.external.status);};Cog.registerComponent({name:'skipToContent',api:api,selector:'.skip-to-content',requires:[{name:'utils.status',apiId:'status'}]});})();(function(){var api={};api.isSafari=function(){return(/^((?!chrome|android).)*safari/i.test(navigator.userAgent));};api.getAnchor=function(){var queryParams=new URLSearchParams(window.location.search);return queryParams.get('anchor');};api.onRegister=function(){if(api.isSafari()&&api.getAnchor()){window.location.hash=api.getAnchor();}};Cog.registerComponent({name:'tipEmail',api:api,selector:'.tipEmail'});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={componentSelector:'.guidePageNavigation',navigationMobileWrapper:'guide-navigation-mobile-wrapper',navigationDesktop:'guidePageNavigation',navigationMobile:'guidePageNavigationMobile',navigationContentWrapper:'guide-navigation-content-wrapper',navigationWrapper:'> ul',navigationListWrapper:'guide-navigation-list-wrapper',navigationFirstLevelItems:'guide-navigation-first-level',firstLevelNavigationLinkWrapper:'guide-navigation-first-level-link-wrapper',topLevelNavigationLink:'.guide-navigation-first-level-link-wrapper a',secondLevelNavigationLink:'.guide-navigation-first-level > ul > li > a',toggleSecondLevelButton:'guide-page-navigation-icon',linksWithLevel2:'chapter-has-children',navigationLink:'> ul > li > a',expandedLevel2Class:'expanded',staticLine:'guide-page-navigation-line',reachedLine:'guide-page-navigation-reached-line',reachedChapters:'guide-page-link-reached',navigationTitle:'guide-navigation-title',navigationAccordionPanel:'guide-page-navigation-accordion-panel',navigationMobilePanel:'guide-page-navigation-mobile-panel',navigationMobileFixedClass:'navigation-fixed',navigationCurrentChapterClass:'guide-current-chapter',navigationMobileLinksWrapper:'guide-page-navigation-mobile-links-wrapper',backToTopButton:'sticky-back-to-top',navigationMobileCollapsedOnSticky:'sticky-collapsed',expandedClass:'expanded',navClosedByUser:'closed-by-user'};var GuidePageNavigation=function(){function GuidePageNavigation($scope,status){_classCallCheck(this,GuidePageNavigation);this.$scope=$scope;this.status=status;this.bindElements();if(!this.status.isAuthor()){this.prepareMobileNavigation();this.bindEvents();this.adjustNavigationLineLength();this.bindAnalyticsEvents();}}
GuidePageNavigation.prototype.bindElements=function bindElements(){this.$window=$(window);this.$htmlBody=$('body,html');this.$document=$(document);this.$navigationContentWrapper=this.$scope.find('.'+selectors.navigationContentWrapper);this.$navigationListWrapper=this.$scope.find('.'+selectors.navigationListWrapper);this.$mainLinksList=this.$navigationListWrapper.find(selectors.navigationWrapper);this.$allNavigationLinks=this.$scope.find('a');this.$accordionPanel=this.$scope.find('.'+selectors.navigationAccordionPanel);this.$firstLevelListItems=this.$scope.find('.'+selectors.navigationFirstLevelItems);this.$firstLevelNaviagationLinks=this.$scope.find(selectors.topLevelNavigationLink);this.$linksWithLevel2=this.$scope.find('.'+selectors.linksWithLevel2);this.$guideContent=this.$document.find('.main-column-content-section-container');this.$guideHeadline=this.$guideContent.find('.headline');this.$mobileNavigationWrapper=this.$guideContent.find('.'+selectors.navigationMobileWrapper);this.$staticLine=this.$scope.find('.'+selectors.staticLine);this.$reachedLine=this.$scope.find('.'+selectors.reachedLine);};GuidePageNavigation.prototype.bindMobileElements=function bindMobileElements(){this.$mobileNavigationBG=this.$mobileNavigationWrapper.find('.content');this.$mobileNavigation=this.$mobileNavigationWrapper.find('.'+selectors.navigationMobile);this.$mobileNavContentWrapper=this.$mobileNavigation.find('.'+selectors.navigationContentWrapper);this.$mobileNavigationListWrapper=this.$mobileNavigation.find('.'+selectors.navigationListWrapper);this.$mobileProgressLine=this.$mobileNavigationWrapper.find('.'+selectors.reachedLine);this.$navigationMobileTitle=this.$mobileNavigationWrapper.find('.'+selectors.navigationTitle);this.$mobileBackToTopButton=this.$mobileNavigationWrapper.find('.'+selectors.backToTopButton);this.$accordionPanelMobile=this.$mobileNavigation.find('.'+selectors.navigationAccordionPanel);this.$staticLineMobile=this.$mobileNavigationWrapper.find('.'+selectors.staticLine);this.$reachedLineMobile=this.$mobileNavigationWrapper.find('.'+selectors.reachedLine);};GuidePageNavigation.prototype.bindEvents=function bindEvents(){this.handleTogglingLevel2();this.watchWindowResize();this.markReachedLinks();this.watchScroll();this.handleLinkClick();this.handleAccordionPanelClick();};GuidePageNavigation.prototype.bindMobileEvents=function bindMobileEvents(){var _this=this;this.$mobileNavigationWrapper.on('click',function(e){if($(e.target).hasClass('paragraphSystem content')){_this.closeMobileNavigation(true);}});this.$mobileBackToTopButton.on('click',function(){if(_this.$mobileNavigation.hasClass(selectors.navClosedByUser)){_this.closeMobileNavigation();}else{_this.openMobileNavigation();}});};GuidePageNavigation.prototype.bindAnalyticsEvents=function bindAnalyticsEvents(){var _this2=this;this.$firstLevelListItems.each(function(index,element){var incrementedIndex=index+1;var $listItem=$(element);if($listItem.hasClass(selectors.linksWithLevel2)){_this2.bindToggleButton($listItem,incrementedIndex);_this2.bindSubNavLinks($listItem.find(selectors.navigationLink),incrementedIndex);}
    $listItem.find(selectors.topLevelNavigationLink).on('click',function(event){Cog.fireEvent('analytics','guidePageNavigation.topLevelNavigationClick',{$target:$(event.currentTarget),index:''+incrementedIndex});});});};GuidePageNavigation.prototype.bindSubNavLinks=function bindSubNavLinks(subNavLinks,parentIndex){subNavLinks.each(function(index,element){$(element).on('click',function(event){Cog.fireEvent('analytics','guidePageNavigation.secondLevelNavigationClick',{$target:$(event.currentTarget),index:parentIndex+'.'+(index+1)});});});};GuidePageNavigation.prototype.bindToggleButton=function bindToggleButton($listItem,index){var toggleButton=$listItem.find('.'+selectors.toggleSecondLevelButton);$(toggleButton).on('click',function(){var expanded=$listItem.hasClass(selectors.expandedLevel2Class);Cog.fireEvent('analytics','guidePageNavigation.toggleSecondLevelClick',{$target:$listItem.find(selectors.topLevelNavigationLink),index:''+index,expanded:expanded});});};GuidePageNavigation.prototype.handleTogglingLevel2=function handleTogglingLevel2(){var _this3=this;var linksWithLevel2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.$linksWithLevel2;var $scope=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.$scope;linksWithLevel2.on('click',function(e){if(e.target.nodeName==='BUTTON'){var ifMobile=$scope.hasClass(selectors.navigationMobile);var itemWithLevel2=$(e.target).parent().parent();var staticLine=ifMobile?_this3.$staticLineMobile:_this3.$staticLine;var reachLine=ifMobile?_this3.$reachedLineMobile:_this3.$reachedLine;if(itemWithLevel2.is(':last-child')){staticLine.css('height',staticLine.height());}else{staticLine.css('height','');}
    if(!itemWithLevel2.next().hasClass(selectors.reachedChapters)||itemWithLevel2.is(':last-child')){reachLine.css('height',reachLine.height());}
    itemWithLevel2.toggleClass(selectors.expandedLevel2Class);itemWithLevel2.find('ul').stop(true,true).slideToggle(300,function(){_this3.changeLineLength(false,$scope);_this3.adjustNavigationLineLength($scope);staticLine.css('height','');reachLine.css('height','');});}});};GuidePageNavigation.prototype.handleLinkClick=function handleLinkClick(){var _this4=this;var allNavigationLinks=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.$allNavigationLinks;allNavigationLinks.on('click',function(e){e.preventDefault();var target=$(e.target);var ifMobile=_this4.$mobileNavigationWrapper.css('display')!=='none';var targetTitle=target.attr('href');if(ifMobile){_this4.closeMobileNavigation();}
    if(targetTitle){_this4.animateScroll(targetTitle,ifMobile);target.blur();}else if(target.parent().attr('href')){targetTitle=target.parent().attr('href');_this4.animateScroll(targetTitle,ifMobile);target.parent().blur();}});};GuidePageNavigation.prototype.animateScroll=function animateScroll(targetTitle,ifMobile){var _this5=this;var scrollTopTarget=$(targetTitle).offset().top-20;var mainContentTop=$('.main-column-content-section-container').offset().top;var scrolled=void 0;if(this.$window.scrollTop()<mainContentTop){var remValue=parseInt($('body').css('font-size'),10);scrolled=mainContentTop*0.030*remValue;scrollTopTarget-=scrolled-10;if(ifMobile){scrollTopTarget-=this.$navigationMobileTitle.height()+150;}}else if(ifMobile){scrollTopTarget-=this.$navigationMobileTitle.height()+30;}
    this.$htmlBody.animate({scrollTop:scrollTopTarget},1000).promise().then(function(){_this5.markReachedLinks();});};GuidePageNavigation.prototype.watchWindowResize=function watchWindowResize(){var _this6=this;this.$window.resize(function(){_this6.changeLineLength(false);_this6.changeLineLength(false,_this6.$mobileProgressLine);_this6.adjustNavigationLineLength();_this6.adjustNavigationLineLength(_this6.$mobileNavigation);_this6.adjustMobileNavPosition();});};GuidePageNavigation.prototype.watchScroll=function watchScroll(){var _this7=this;var firstLevelLinks=this.$mobileNavigation.find(selectors.topLevelNavigationLink);this.$window.scroll(function(){_this7.markReachedLinks();_this7.markReachedLinks(firstLevelLinks,true);var mobileNavPosition=_this7.$mobileNavigationWrapper.offset().top;var mobileFullHeight=_this7.$mobileNavigationWrapper.height();var mobileNavBottomPosition=mobileNavPosition+mobileFullHeight;var itemsWithLevel2=_this7.$mobileNavigation.find('.'+selectors.linksWithLevel2);if(_this7.$window.scrollTop()<=mobileNavBottomPosition){itemsWithLevel2.each(function(i,elem){var itemWithLevel2=$(elem);if(!itemWithLevel2.hasClass(selectors.expandedLevel2Class)){itemWithLevel2.addClass(selectors.expandedLevel2Class);itemWithLevel2.find('ul').slideDown(0);}});_this7.$mobileNavigationWrapper.removeClass(selectors.navigationMobileFixedClass);_this7.$mobileNavigation.removeClass(selectors.navigationMobileCollapsedOnSticky);_this7.followChaptersOnMobile();_this7.adjustNavigationLineLength(_this7.$mobileNavigation);_this7.$mobileNavigationBG.css('height','');_this7.$mobileNavigationWrapper.css('height','');_this7.adjustNavigationLineLength(_this7.$mobileNavigation);if(!_this7.$mobileNavigation.hasClass(selectors.expandedClass)){if(!_this7.$mobileNavigation.hasClass(selectors.navClosedByUser)){_this7.openMobileNavigation();}else{_this7.closeMobileNavigation();}}else if(_this7.$mobileNavigation.hasClass(selectors.expandedClass)&&_this7.$mobileNavigation.hasClass(selectors.navClosedByUser)){_this7.openMobileNavigation();_this7.$mobileNavigation.removeClass(selectors.navClosedByUser);}
    _this7.$mobileProgressLine.css('bottom','');}
    if(_this7.$window.scrollTop()>mobileNavBottomPosition){_this7.$mobileNavigationWrapper.height(_this7.$mobileNavigationWrapper.height());_this7.$mobileNavigationWrapper.addClass(selectors.navigationMobileFixedClass);if(_this7.$mobileNavigation.hasClass(selectors.expandedClass)&&!_this7.$mobileNavigation.hasClass(selectors.navigationMobileCollapsedOnSticky)){_this7.closeMobileNavigation();_this7.$mobileNavigation.addClass(selectors.navigationMobileCollapsedOnSticky);_this7.$mobileNavigation.find('.'+selectors.linksWithLevel2).each(function(i,elem){var navigationElem=$(elem);if(navigationElem.hasClass(selectors.expandedLevel2Class)){navigationElem.removeClass(selectors.expandedLevel2Class);navigationElem.find('ul').slideUp();}});}
        if(_this7.$mobileNavigation.hasClass(selectors.expandedClass)){_this7.changeLineLength(true,_this7.$mobileNavigation);}}else{_this7.$mobileNavigation.removeClass(selectors.navigationMobileCollapsedOnSticky);}});};GuidePageNavigation.prototype.markReachedLinks=function markReachedLinks(){var _this8=this;var firstLevelNavigationLinks=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.$firstLevelNaviagationLinks;var mobile=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var markedTopMargin=this.$window.height()*0.2;firstLevelNavigationLinks.each(function(i,elem){var firstLevelLink=$(elem);var linkTarget=firstLevelLink.attr('href');var listItemWrapper=firstLevelLink.parent().parent();var linkOffset=$(linkTarget).offset();var linkReachedValue=linkOffset?linkOffset.top-markedTopMargin:0;listItemWrapper.removeClass(selectors.navigationCurrentChapterClass);if(!listItemWrapper.hasClass(selectors.reachedChapters)&&linkOffset&&_this8.$window.scrollTop()>=linkReachedValue){listItemWrapper.addClass(selectors.reachedChapters);}else if(listItemWrapper.hasClass(selectors.reachedChapters)&&linkOffset&&!(_this8.$window.scrollTop()>=linkReachedValue)){listItemWrapper.removeClass(selectors.reachedChapters);}});this.markCurrentChapter();if(mobile){this.followChaptersOnMobile();this.markCurrentChapter(this.$mobileNavigation);}};GuidePageNavigation.prototype.markCurrentChapter=function markCurrentChapter(){var scope=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.$scope;var reachedChapters=this.$scope.find('.'+selectors.reachedChapters);if(reachedChapters.length>=1){reachedChapters.last().addClass(selectors.navigationCurrentChapterClass);this.adjustNavigationLineLength(scope);this.changeLineLength(true,scope);}};GuidePageNavigation.prototype.changeLineLength=function changeLineLength(ifAnimate){var $scope=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.$scope;var ifMobile=$scope.hasClass(selectors.navigationMobile);var $line=ifMobile?this.$reachedLineMobile:this.$reachedLine;var reachedLinksPath='.'+selectors.navigationListWrapper+' > ul > .'+selectors.reachedChapters;var reachedLinks=$scope.find(reachedLinksPath);var firstLevelListItems=$scope.find('.'+selectors.navigationFirstLevelItems);var lineLength=0;var holdAnimation=false;if(!$scope.hasClass('expanded')){holdAnimation=true;}
    if(!holdAnimation){if(ifAnimate){$line.addClass('line-animation');}else{$line.removeClass('line-animation');}
        firstLevelListItems.each(function(i,elem){lineLength+=$(elem).height();});if(reachedLinks.length>=1){var lastReachedChapter=reachedLinks.last();var linksBeforeLast=lastReachedChapter.last().prevAll();linksBeforeLast.each(function(i,elem){lineLength-=$(elem).height();});if(linksBeforeLast.length>=1){lineLength-=15;}}
        $line.css('bottom',lineLength);}};GuidePageNavigation.prototype.adjustNavigationLineLength=function adjustNavigationLineLength(){var $scope=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.$scope;var ifMobile=$scope.hasClass(selectors.navigationMobile);var $line=ifMobile?this.$staticLineMobile:this.$staticLine;var lastLinkPath='.'+selectors.navigationListWrapper+' > ul > li:last-of-type';var lastLinkHeight=$scope.find(lastLinkPath).height();$line.css('bottom',lastLinkHeight-20);};GuidePageNavigation.prototype.handleAccordionPanelClick=function handleAccordionPanelClick(){var _this9=this;this.$accordionPanel.on('click',function(e){_this9.toggleNavigationAccordion(e);});this.$accordionPanelMobile.on('click',function(e){_this9.toggleNavigationAccordion(e);});};GuidePageNavigation.prototype.toggleNavigationAccordion=function toggleNavigationAccordion(){var _this10=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var ifMobile=e.currentTarget.parentNode.className.indexOf(selectors.navigationMobile)>=0;var $navigation=ifMobile?this.$mobileNavigation:this.$scope;var $linksWrapper=ifMobile?this.$mobileNavContentWrapper:this.$navigationContentWrapper;var $reachedLine=ifMobile?this.$reachedLineMobile:this.$reachedLine;var isExpanded=$navigation.hasClass(selectors.expandedClass);if(!this.$mobileNavigationWrapper.hasClass(selectors.navigationMobileFixedClass)&&ifMobile){if(!this.$mobileNavigation.hasClass(selectors.navClosedByUser)){this.$mobileNavigation.addClass(selectors.navClosedByUser);}else{this.$mobileNavigation.removeClass(selectors.navClosedByUser);}}
    if(isExpanded){$reachedLine.css('height',$reachedLine.height());if(ifMobile){this.$mobileNavigationBG.css('height','');}
        $navigation.removeClass(selectors.expandedClass);}else{$navigation.addClass(selectors.expandedClass);if(this.$mobileNavigationWrapper.hasClass(selectors.navigationMobileFixedClass)){this.$mobileNavigationBG.css('height','100vh');}}
    $linksWrapper.slideToggle(300,function(){_this10.adjustNavigationLineLength($navigation);if(isExpanded){$reachedLine.css('height','');$reachedLine.css('bottom','100%');if(_this10.$mobileNavigationWrapper.hasClass(selectors.navigationMobileFixedClass)){_this10.$mobileNavigationBG.css('height','');}}else{_this10.changeLineLength(true,$navigation);_this10.adjustNavigationLineLength(_this10.$mobileNavigation);}});};GuidePageNavigation.prototype.prepareMobileNavigation=function prepareMobileNavigation(){var _this11=this;this.$mobileNavigationWrapper.find('.content').append(this.$scope.clone());var mobileNavigation=this.$guideContent.find(selectors.componentSelector);var linksWithLevel2=mobileNavigation.find('.'+selectors.linksWithLevel2);var allNavigationLinks=mobileNavigation.find('a:not(.'+selectors.navigationAccordionPanel+')');var firstLevelLinks=mobileNavigation.find(selectors.topLevelNavigationLink);mobileNavigation.removeClass('guidePageNavigation').addClass(selectors.navigationMobile+' '+selectors.expandedClass);linksWithLevel2.addClass(selectors.expandedClass);this.bindMobileElements();this.bindMobileEvents();this.adjustNavigationLineLength(this.$mobileNavigation);this.adjustMobileNavPosition();this.handleLinkClick(allNavigationLinks);this.markReachedLinks(firstLevelLinks,true);this.handleTogglingLevel2(linksWithLevel2,mobileNavigation);var backToTopWrapper=$('<div class="sticky-back-to-top-mobile-wrapper"></div>');var backToTopButton=$('<button class="sticky-back-to-top">Back to top</button>');backToTopWrapper.append(backToTopButton);this.$mobileNavContentWrapper.append(backToTopWrapper);allNavigationLinks.on('focusin',function(e){_this11.handleMobileFocus(e,true);}).on('focusout',function(e){_this11.handleMobileFocus(e,false);});};GuidePageNavigation.prototype.handleMobileFocus=function handleMobileFocus(e,focusIn){var linkListItem=$(e.target).parent();if(linkListItem.is('div')){linkListItem=linkListItem.parent();}
    if(focusIn){linkListItem.addClass('pressed');}else{linkListItem.removeClass('pressed');}};GuidePageNavigation.prototype.adjustMobileNavPosition=function adjustMobileNavPosition(){var navigationMobile=$('.'+selectors.navigationMobileWrapper);if(window.innerWidth<768){navigationMobile.css({marginLeft:-this.$guideHeadline.offset().left,width:this.$window.width()});}else{navigationMobile.css({marginLeft:'',width:''});}};GuidePageNavigation.prototype.followChaptersOnMobile=function followChaptersOnMobile(){var mobileNavigationWrapper=this.$document.find('.'+selectors.navigationMobileWrapper);var mobileNavigation=mobileNavigationWrapper.find('.'+selectors.navigationMobile);var mobileNavigationTitle=mobileNavigation.find('.'+selectors.navigationTitle);var reachedChapters=mobileNavigation.find('.'+selectors.reachedChapters);if(reachedChapters.length>=1&&mobileNavigationWrapper.hasClass(selectors.navigationMobileFixedClass)){var lastReached=reachedChapters.last().find('.'+selectors.firstLevelNavigationLinkWrapper+' a');lastReached.parent().parent().addClass(selectors.navigationCurrentChapterClass);mobileNavigationTitle.html(lastReached.html());}else{mobileNavigationTitle.html('In this guide');}};GuidePageNavigation.prototype.closeMobileNavigation=function closeMobileNavigation(){var _this12=this;var ifAnimate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var animationDuration=ifAnimate?300:0;this.$mobileNavigationBG.css('height','');this.$mobileNavContentWrapper.slideUp(animationDuration,function(){_this12.$mobileProgressLine.css('height','');_this12.$mobileProgressLine.css('bottom','100%');});this.$mobileNavigation.removeClass(selectors.expandedClass);};GuidePageNavigation.prototype.openMobileNavigation=function openMobileNavigation(){var _this13=this;this.$mobileNavContentWrapper.slideDown(0,function(){_this13.$mobileProgressLine.css('height','auto');_this13.$mobileProgressLine.css('bottom','100%');});this.$mobileNavigation.addClass(selectors.expandedClass);};return GuidePageNavigation;}();api.onRegister=function(scope){new GuidePageNavigation(scope.$scope,this.external.status);};Cog.registerComponent({name:'guidePageNavigation',selector:selectors.componentSelector,api:api,requires:[{name:'utils.status',apiId:'status'}]});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={componentSelector:'left-hand-side-sidebar-section-container',sidebarContent:'sidebar-section',sidebarHeight:'sidebar-sticky-height',sidebarSticky:'sidebar-sticky',backToTopWrapper:'sticky-back-to-top-wrapper',backToTopWrapperBorder:'sticky-back-to-top-wrapper-border',backToTopButton:'sticky-back-to-top',backToTopButtonDisabled:'lhs-disabled-back-to-top'};var animationTime=1000;var StickySidebar=function(){function StickySidebar($scope,status){_classCallCheck(this,StickySidebar);this.$scope=$scope;this.status=status;if(!this.isIE()&&!this.status.isAuthor()){this.bindElements();this.addStickyClass();this.bindAnalyticsEvent();this.onOffSticky();this.bindWatchers();}}
StickySidebar.prototype.bindElements=function bindElements(){this.$window=$(window);this.$body=$('body');this.$htmlBody=$('body,html');this.$document=$(document);this.$guideDropdowns=this.$document.find('.guide-side-column-dropdown');this.$sidebarContent=this.$scope.find('.'+selectors.sidebarContent);};StickySidebar.prototype.bindAnalyticsEvent=function bindAnalyticsEvent(){this.$scope.on('click',function(e){if($(e.target).hasClass(selectors.backToTopButton)){Cog.fireEvent('analytics','guide.backToTopClick',{$target:$(e.target)});}});};StickySidebar.prototype.bindWatchers=function bindWatchers(){this.watchScroll();this.addSimpleScrollbar();if(!this.$body.hasClass(selectors.backToTopButtonDisabled)){this.watchSidebarContentHeight();this.createBackToTop();this.handleBackToTop();}};StickySidebar.prototype.addStickyClass=function addStickyClass(){this.$scope.addClass(selectors.sidebarSticky);};StickySidebar.prototype.isIE=function isIE(){var ua=navigator.userAgent;var isIE=ua.indexOf('MSIE ')>-1||ua.indexOf('Trident/')>-1;return isIE;};StickySidebar.prototype.createBackToTop=function createBackToTop(){var wrapperClasses=selectors.backToTopWrapper+' '+selectors.backToTopWrapperBorder;var backToTopWrapper=$('<div class="'+wrapperClasses+'"></div>');var backToTopButton=$('<button class="'+selectors.backToTopButton+'">Back to top</button>');backToTopWrapper.append(backToTopButton);this.$scope.append(backToTopWrapper);};StickySidebar.prototype.handleBackToTop=function handleBackToTop(){var _this=this;$('.'+selectors.backToTopButton).on('click',function(e){_this.$htmlBody.animate({scrollTop:0},animationTime).promise().then(function(){$(e.target).blur();});});};StickySidebar.prototype.watchScroll=function watchScroll(){var _this2=this;this.$window.on('scroll',_.throttle(function(){_this2.onOffSticky();},200));};StickySidebar.prototype.addSimpleScrollbar=function addSimpleScrollbar(){window.SimpleScrollbar.initEl(this.$scope.get(0));};StickySidebar.prototype.onOffSticky=function onOffSticky(){var _this3=this;if(this.$window.scrollTop()>=this.$scope.offset().top-24){this.handleCollapsingDropdowns();this.$scope.addClass(selectors.sidebarHeight);}else{this.$scope.find('.ss-content').animate({scrollTop:0},200).promise().then(function(){_this3.$scope.removeClass(selectors.sidebarHeight);});}};StickySidebar.prototype.handleCollapsingDropdowns=function handleCollapsingDropdowns(){this.$guideDropdowns.each(function(i,elem){var dropdownContent=$(elem).find('div.accordion-content-wrapper');var dropdownPanel=dropdownContent.parent();if(dropdownContent.css('display')==='block'&&!dropdownPanel.hasClass('sticky-collapsed')){dropdownContent.stop().slideUp(300);dropdownPanel.removeClass('is-active').addClass('sticky-collapsed');}else if(!dropdownPanel.hasClass('sticky-collapsed')){dropdownPanel.addClass('sticky-collapsed');}});};StickySidebar.prototype.watchSidebarContentHeight=function watchSidebarContentHeight(){var _this4=this;var resizeObserver=new ResizeObserver(function(){var buttonWrapper=$('.'+selectors.backToTopWrapper);var sidebarHeight=_this4.$scope.height()-buttonWrapper.height();var sidebarContentHeight=_this4.$sidebarContent[0].scrollHeight;if(sidebarHeight>=sidebarContentHeight){buttonWrapper.removeClass(selectors.backToTopWrapperBorder);}else{buttonWrapper.addClass(selectors.backToTopWrapperBorder);}});resizeObserver.observe(this.$sidebarContent[0]);};return StickySidebar;}();api.onRegister=function(scope){new StickySidebar(scope.$scope,this.external.status);};Cog.registerComponent({name:'stickySidebar',selector:'.left-hand-side-sidebar-section-container',api:api,requires:[{name:'utils.status',apiId:'status'}]});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={mainContentContainer:'main-column-content-section-container',bylineComponent:'byline-short'};var scrollRatio={mainImage:0.012,mainContent:0.030};var bodyFontSize=parseInt(window.getComputedStyle(document.body).fontSize,10);var ArticleMainImageParallax=function(){function ArticleMainImageParallax($scope,status){_classCallCheck(this,ArticleMainImageParallax);this.$scope=$scope;this.status=status;this.windowScroll=0;if(!this.status.isAuthor()&&!this.isiOS()){this.bindElements();this.watchWindowEvents();}}
ArticleMainImageParallax.prototype.bindElements=function bindElements(){this.$window=$(window);this.$mainArticleImage=this.$scope;this.$mainContentContainer=$('.'+selectors.mainContentContainer);this.$bylineComponent=$('.'+selectors.bylineComponent);};ArticleMainImageParallax.prototype.calculateParallax=function calculateParallax(){var baseRatio=this.windowScroll*bodyFontSize;this.$mainArticleImage.css('margin-top','-'+Math.ceil(baseRatio*scrollRatio.mainImage)+'px');this.$mainContentContainer.css('margin-top','-'+Math.ceil(baseRatio*scrollRatio.mainContent)+'px');};ArticleMainImageParallax.prototype.isElementInViewport=function isElementInViewport($element){var rect=$element[0].getBoundingClientRect();return rect.top>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight);};ArticleMainImageParallax.prototype.isiOS=function isiOS(){return navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);};ArticleMainImageParallax.prototype.onScroll=function onScroll(){var _this=this;this.windowScroll=this.$window.scrollTop();if(this.isElementInViewport(this.$bylineComponent)){requestAnimationFrame(function(){_this.calculateParallax();});}};ArticleMainImageParallax.prototype.watchWindowEvents=function watchWindowEvents(){var _this2=this;this.$window.on('scroll resize touchmove',function(){_this2.onScroll();});};return ArticleMainImageParallax;}();api.onRegister=function(scope){new ArticleMainImageParallax(scope.$scope,this.external.status);};Cog.registerComponent({name:'articleMainImageParallax',selector:'.article-main-guide-heading-image',api:api,requires:[{name:'utils.status',apiId:'status'}]});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={topStoriesItem:'.top-stories-item',topStoriesTitle:'.item-title',topStoriesImage:'.item-image',topStoriesImageLink:'.item-image > a',lhsAccordion:'.accordion.guide-side-column-dropdown',lhsAccordionTitle:'.accordion-title-text'};var TopStories=function(){function TopStories($element){_classCallCheck(this,TopStories);this.$scope=$element;this.init();}
TopStories.prototype.init=function init(){this.bindElements();this.handleTracking();};TopStories.prototype.bindElements=function bindElements(){this.$topStoriesItem=this.$scope.find(selectors.topStoriesItem);this.$titleLink=this.$topStoriesItem.find(selectors.topStoriesTitle).parent();this.$imageLink=this.$topStoriesItem.find(selectors.topStoriesImageLink);};TopStories.prototype.handleTracking=function handleTracking(){var _this=this;this.$titleLink.add(this.$imageLink).on('click',function(event){var $target=$(event.target);var $currentTarget=$(event.currentTarget);Cog.fireEvent('analytics','promoBoxLeftHandSide.linkClick',{$target:$target,$currentTarget:$currentTarget,elementLayer1:_this.getAccordionTitle($target),elementLayer2:'Links',elementLayer3:'link',elementLayer4:_this.getTopStoriesItemIndex($target),itemIdentifier:$target.text()||_this.getTopStoriesItemTitle($target),href:$currentTarget.attr('href')});});};TopStories.prototype.getAccordionTitle=function getAccordionTitle($childElement){return $childElement.closest(selectors.lhsAccordion).find(selectors.lhsAccordionTitle).text();};TopStories.prototype.getTopStoriesItemIndex=function getTopStoriesItemIndex($childElement){return $childElement.closest(selectors.topStoriesItem).index()+1;};TopStories.prototype.getTopStoriesItemTitle=function getTopStoriesItemTitle($img){return $img.closest(selectors.topStoriesItem).find(selectors.topStoriesTitle).text();};return TopStories;}();api.onRegister=function(scope){new TopStories(scope.$scope);};Cog.registerComponent({name:'TopStories',api:api,selector:'.topStories'});})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
(function(){var api={};var selectors={component:'singleButtonShareThis',shareThisButton:'share-this-btn',shareThisButtonOpen:'share-this-btn-open',shareThisList:'shareThis-list',shareThisListItem:'shareThis-item > a',slideIn:'slide-in',bylineDataVisible:'hidden',hideSibling:'singleButtonShareThis-hide-sibling',hidePreviousComponent:'singleButtonShareThis-hide-previous',hiddenClass:'singleButtonShareThis-sibling-hidden',openToTheLeft:'singleButtonShareThis-left',openToTheRight:'singleButtonShareThis-right',byline:{component:'byline',elementToHide:'by-line__datacontainer'},dealsList:{component:'dealsFullList',expired:'expired',manuallyExpired:'manually-expired'}};var SingleButtonShareThis=function(){function SingleButtonShareThis($scope,status){_classCallCheck(this,SingleButtonShareThis);this.$scope=$scope;this.status=status;if(!this.status.isAuthor()){this.bindElements();this.bindEvents();this.watchWindowResize();}}
SingleButtonShareThis.prototype.bindElements=function bindElements(){this.$window=$(window);this.$siblingToHide=this.$scope.next();this.$shareThisButton=this.$scope.find('.'+selectors.shareThisButton);this.$shareThisList=this.$scope.find('.'+selectors.shareThisList);this.$shareThisListItem=this.$shareThisList.find('.'+selectors.shareThisListItem);if(this.$scope.parents().hasClass(selectors.byline.component)){this.$byline=this.$scope.closest('.'+selectors.byline.component);this.$siblingToHide=this.$byline.find('.'+selectors.byline.elementToHide);}};SingleButtonShareThis.prototype.bindEvents=function bindEvents(){var _this=this;if(this.ifActivateButton()){this.$shareThisButton.on('click',function(event){var button=event.currentTarget;event.preventDefault();Cog.fireEvent('analytics','singleButtonShareThis.shareThisButton',{$target:$(button),elementLayer1:'Sharing',itemIdentifier:$(button).hasClass(''+selectors.shareThisButtonOpen)?'Close':'Expand Options'});_this.toggleCloseButtonText();_this.toggleSlideInClass();});this.$shareThisListItem.on('click',function(event){Cog.fireEvent('analytics','singleButtonShareThis.shareThisItem',{$target:$(event.currentTarget),elementLayer1:'Sharing'});});}};SingleButtonShareThis.prototype.ifActivateButton=function ifActivateButton(){var $dealsFullList=this.$scope.closest('.'+selectors.dealsList.component);if($dealsFullList.length){var expiredList=$dealsFullList.find('.'+selectors.dealsList.expired).length;var ifManuallyExpired=this.$scope.closest('.'+selectors.dealsList.manuallyExpired).length;return!(expiredList||ifManuallyExpired);}
    return true;};SingleButtonShareThis.prototype.setShareThisListPosition=function setShareThisListPosition(resetPosition){var positionValue=resetPosition?0:this.calculateShareThisButtonWidth();if(this.$scope.find('.'+selectors.openToTheLeft).length){positionValue=-positionValue;}
    this.$shareThisList[0].style.transform='translate3d('+positionValue+'px, 0, 0)';this.$shareThisButton.blur();};SingleButtonShareThis.prototype.calculateShareThisButtonWidth=function calculateShareThisButtonWidth(){return Math.round(this.$shareThisButton[0].getBoundingClientRect().width);};SingleButtonShareThis.prototype.toggleCloseButtonText=function toggleCloseButtonText(){var ifHideSibling=this.$scope.hasClass(selectors.hideSibling);var ifHidePrevComponent=this.$scope.hasClass(selectors.hidePreviousComponent);if(this.$shareThisButton.hasClass(selectors.shareThisButtonOpen)){this.$shareThisButton.removeClass(selectors.shareThisButtonOpen);this.setShareThisListPosition(true);if(ifHideSibling){this.$siblingToHide.removeClass(selectors.hiddenClass);}
    if(ifHidePrevComponent){this.$scope.prev().removeClass(selectors.hiddenClass);}}else{if(ifHideSibling){this.$siblingToHide.addClass(selectors.hiddenClass);}
    if(ifHidePrevComponent){this.$scope.prev().addClass(selectors.hiddenClass);}
    this.$shareThisButton.addClass(selectors.shareThisButtonOpen);this.setShareThisListPosition(false);}};SingleButtonShareThis.prototype.toggleSlideInClass=function toggleSlideInClass(){this.$shareThisList.toggleClass(selectors.slideIn);};SingleButtonShareThis.prototype.watchWindowResize=function watchWindowResize(){var _this2=this;this.$window.on('resize',_.throttle(function(){_this2.setShareThisListPosition(false);},200));};return SingleButtonShareThis;}();api.onRegister=function(scope){new SingleButtonShareThis(scope.$scope,this.external.status);};Cog.registerComponent({name:'singleButtonShareThis',selector:'.singleButtonShareThis',api:api,requires:[{name:'utils.status',apiId:'status'}]});})();